<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Creative Director | A2I Commercial Lab | Barrios A2I</title>
    <meta name="description" content="Your AI Creative Director is ready. Build a production-ready commercial brief in minutes with guided questions.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        void: '#0a0a0f',
                        obsidian: '#0a0a1e',
                        neon: '#00F3FF',
                        primary: '#00CED1',
                        accent: '#F59E0B',
                        glass: 'rgba(255, 255, 255, 0.05)',
                        glassHover: 'rgba(255, 255, 255, 0.1)',
                        'brand-teal': '#00CED1',
                        'brand-gold': '#ffd700',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                }
            }
        }
    </script>
    <style>
        body { background-color: #0a0a0f; color: white; margin: 0; overflow-x: hidden; }
        #canvas-container { position: fixed; top: 0; left: 0; width: 100%; height: 100vh; z-index: 0; pointer-events: none; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0a0a0f; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #00F3FF; }
        .neon-text-shadow { text-shadow: 0 0 10px rgba(0, 243, 255, 0.5), 0 0 20px rgba(0, 243, 255, 0.3); }
        @keyframes fadeSlideIn { 0% { opacity: 0; transform: translateY(20px); } 100% { opacity: 1; transform: translateY(0); } }
        .chat-container::-webkit-scrollbar { width: 4px; }
        .chat-container::-webkit-scrollbar-thumb { background: rgba(0, 243, 255, 0.3); border-radius: 2px; }
        @keyframes pulse-glow { 0%, 100% { box-shadow: 0 0 5px rgba(0, 243, 255, 0.3); } 50% { box-shadow: 0 0 20px rgba(0, 243, 255, 0.6); } }
        .typing-indicator span { animation: bounce 1.4s infinite ease-in-out both; }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }

        /* Fix for responsive classes - ensure proper visibility */
        @media (min-width: 640px) {
            .hidden.sm\:block { display: block !important; }
        }
        @media (min-width: 768px) {
            .hidden.md\:flex { display: flex !important; }
            .md\:flex { display: flex !important; }
            .md\:gap-4 { gap: 1rem !important; }
            .md\:gap-5 { gap: 1.25rem !important; }
            .md\:gap-6 { gap: 1.5rem !important; }
            .md\:w-10 { width: 2.5rem !important; }
            .md\:h-10 { height: 2.5rem !important; }
            .md\:w-8 { width: 2rem !important; }
            .md\:h-8 { height: 2rem !important; }
            .md\:w-16 { width: 4rem !important; }
            .md\:h-16 { height: 4rem !important; }
            .md\:w-20 { width: 5rem !important; }
            .md\:h-20 { height: 5rem !important; }
            .md\:w-3 { width: 0.75rem !important; }
            .md\:h-3 { height: 0.75rem !important; }
            .md\:px-6 { padding-left: 1.5rem !important; padding-right: 1.5rem !important; }
            .md\:py-6 { padding-top: 1.5rem !important; padding-bottom: 1.5rem !important; }
            .md\:-top-1 { top: -0.25rem !important; }
            .md\:-right-1 { right: -0.25rem !important; }
            .md\:-top-2 { top: -0.5rem !important; }
            .md\:-right-2 { right: -0.5rem !important; }
            .md\:w-2 { width: 0.5rem !important; }
            .md\:h-2 { height: 0.5rem !important; }
        }
        @media (min-width: 1024px) {
            .hidden.lg\:flex { display: flex !important; }
            .lg\:flex { display: flex !important; }
            .lg\:hidden { display: none !important; }
        }

        /* Nav Link Styles (from landing page) */
        .nav-link { position: relative; }
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 1px;
            background: #ffd700;
            box-shadow: 0 0 8px #ffd700;
            transition: width 0.3s ease;
        }
        .nav-link:hover::after { width: 75%; }
        .nav-link:hover .bracket { color: #ffd700; }
        .nav-link.active::after { width: 75%; }
        .nav-link.active .bracket { color: #ffd700; }

        /* Scanline Effect */
        .scanline-overlay {
            background: linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,0.15) 50%),
                        linear-gradient(90deg, rgba(255,0,0,0.02), rgba(0,255,0,0.01), rgba(0,0,255,0.02));
            background-size: 100% 2px, 3px 100%;
        }

        /* Volumetric Glow */
        .volumetric-glow {
            filter: drop-shadow(0 0 8px rgba(0, 206, 209, 0.5));
        }
        .volumetric-glow:hover {
            filter: drop-shadow(0 0 15px rgba(0, 206, 209, 0.7));
        }

        /* LEGENDARY Header Animations */
        @keyframes breathingGlow {
            0%, 100% { filter: drop-shadow(0 0 15px rgba(0, 206, 209, 0.4)); }
            50% { filter: drop-shadow(0 0 30px rgba(0, 206, 209, 0.7)); }
        }
        @keyframes borderGlow {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.8; }
        }
        @keyframes pulseIndicator {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.3); opacity: 1; }
        }
        .logo-breathing { animation: breathingGlow 3s ease-in-out infinite; }

        /* Mobile-safe logo - remove complex filters that cause black silhouette */
        @media (max-width: 768px) {
            .logo-breathing { animation: none !important; filter: none !important; }
            .volumetric-glow { filter: none !important; }
        }

        .header-glow-border {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(0, 206, 209, 0.5), transparent);
            animation: borderGlow 4s ease-in-out infinite;
        }
        .status-pulse { animation: pulseIndicator 2s ease-in-out infinite; }

        /* Pipeline Phase Indicator */
        .pipeline-phases {
            display: flex;
            gap: 4px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }
        .phase-dot {
            font-size: 9px;
            padding: 3px 8px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            color: rgba(255,255,255,0.4);
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s ease;
        }
        .phase-dot.active {
            background: rgba(0, 243, 255, 0.15);
            color: #00F3FF;
            border-color: rgba(0, 243, 255, 0.3);
        }
        .phase-dot.completed {
            background: rgba(16, 185, 129, 0.15);
            color: #10b981;
            border-color: rgba(16, 185, 129, 0.3);
        }

        /* Concept Cards */
        .concept-cards {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 12px 0;
        }
        .concept-card {
            background: rgba(0, 243, 255, 0.05);
            border: 1px solid rgba(0, 243, 255, 0.2);
            border-radius: 10px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .concept-card:hover {
            border-color: #00F3FF;
            background: rgba(0, 243, 255, 0.1);
            transform: translateX(4px);
        }
        .concept-card.selected {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        .concept-title {
            font-size: 13px;
            font-weight: 600;
            color: white;
            margin-bottom: 6px;
        }
        .concept-hook {
            font-size: 11px;
            color: rgba(255,255,255,0.6);
            margin-bottom: 6px;
            line-height: 1.4;
        }
        .concept-score {
            font-size: 10px;
            color: #00F3FF;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Script Preview */
        .script-preview {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 12px;
            margin: 12px 0;
        }
        .script-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 12px;
            color: white;
        }
        .script-duration {
            font-family: 'JetBrains Mono', monospace;
            color: #00F3FF;
        }
        .script-scenes {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 8px;
        }
        .script-scenes::-webkit-scrollbar { height: 4px; }
        .script-scenes::-webkit-scrollbar-thumb { background: rgba(0, 243, 255, 0.3); border-radius: 2px; }
        .scene-card {
            min-width: 120px;
            max-width: 140px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 10px;
            font-size: 10px;
            flex-shrink: 0;
        }
        .scene-type {
            font-weight: 600;
            color: #00F3FF;
            margin-bottom: 4px;
            text-transform: uppercase;
            font-size: 9px;
            letter-spacing: 0.05em;
        }
        .scene-content {
            color: rgba(255,255,255,0.7);
            line-height: 1.3;
        }
        .script-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }
        .btn-approve {
            flex: 1;
            padding: 8px;
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            border-radius: 6px;
            color: white;
            font-weight: 600;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .btn-approve:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }
        .btn-revise {
            padding: 8px 12px;
            background: transparent;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 6px;
            color: rgba(255,255,255,0.6);
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .btn-revise:hover {
            border-color: rgba(255,255,255,0.4);
            color: white;
        }

        /* Quality Score */
        .quality-score {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 8px;
            margin-top: 8px;
        }
        .quality-score.low {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.2);
        }
        .quality-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: 600;
            color: #10b981;
        }
        .quality-score.low .quality-value {
            color: #ef4444;
        }
        .quality-label {
            font-size: 10px;
            color: rgba(255,255,255,0.6);
        }

        /* System Messages */
        .system-message {
            display: flex;
            justify-content: center;
            padding: 8px 0;
        }
        .system-message span {
            font-size: 10px;
            color: rgba(255,255,255,0.5);
            background: rgba(255,255,255,0.05);
            padding: 4px 12px;
            border-radius: 12px;
        }

        /* Pipeline Badge */
        .pipeline-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 8px;
            background: linear-gradient(135deg, rgba(0, 243, 255, 0.2), rgba(16, 185, 129, 0.2));
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 4px;
            font-size: 9px;
            color: #00F3FF;
            font-weight: 600;
            letter-spacing: 0.1em;
        }

        .hidden { display: none !important; }

        /* Neural Processing Visualization - Legendary Neural Engine */
        .nexus-neural-processing {
            padding: 12px;
            background: rgba(0, 206, 209, 0.05);
            border: 1px solid rgba(0, 206, 209, 0.2);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .nexus-neural-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .nexus-neural-mode {
            font-family: 'JetBrains Mono', 'Consolas', monospace;
            font-size: 10px;
            padding: 2px 6px;
            background: rgba(0, 206, 209, 0.2);
            color: #00CED1;
            border-radius: 4px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .nexus-neural-label {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
        }

        .nexus-neural-tokens {
            display: flex;
            gap: 4px;
            font-family: 'JetBrains Mono', 'Consolas', monospace;
            font-size: 11px;
        }

        .nexus-token {
            padding: 2px 4px;
            color: rgba(255, 255, 255, 0.3);
            transition: all 0.2s ease;
        }

        .nexus-token--active {
            color: #00CED1;
            text-shadow: 0 0 8px rgba(0, 206, 209, 0.5);
        }

        .nexus-neural-progress {
            margin-top: 8px;
        }

        .nexus-progress-bar {
            height: 2px;
            background: linear-gradient(90deg, #00CED1, #00F3FF);
            border-radius: 1px;
            animation: progress-pulse 1.5s ease-in-out infinite;
        }

        @keyframes progress-pulse {
            0%, 100% { width: 20%; opacity: 0.5; }
            50% { width: 80%; opacity: 1; }
        }

        /* Metrics badge */
        .nexus-message-metrics {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 10px;
            color: rgba(255, 255, 255, 0.4);
        }

        .nexus-metric {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .nexus-metric-icon {
            font-size: 9px;
        }

        .nexus-metric--mode {
            font-family: 'JetBrains Mono', 'Consolas', monospace;
            background: rgba(0, 206, 209, 0.1);
            padding: 1px 5px;
            border-radius: 3px;
            color: #00CED1;
            font-weight: 600;
            letter-spacing: 0.05em;
        }

        /* ============================================
           UI/UX ENHANCEMENTS - Tesla Minimalism + Cyberpunk
           ============================================ */

        /* 1. NEXUS Chat Widget - Active Glow Pulse */
        .nexus-panel--open {
            animation: nexus-glow-pulse 2.5s ease-in-out infinite;
        }

        @keyframes nexus-glow-pulse {
            0%, 100% {
                box-shadow: 0 0 20px rgba(0, 206, 209, 0.15),
                            0 0 40px rgba(0, 206, 209, 0.08),
                            inset 0 0 20px rgba(0, 206, 209, 0.02);
            }
            50% {
                box-shadow: 0 0 35px rgba(0, 206, 209, 0.25),
                            0 0 70px rgba(0, 206, 209, 0.12),
                            inset 0 0 30px rgba(0, 206, 209, 0.04);
            }
        }

        /* Floating animation for minimized launcher */
        .nexus-launcher {
            animation: nexus-float 3s ease-in-out infinite;
        }

        @keyframes nexus-float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-6px); }
        }

        /* 2. Neural Token Particle Burst */
        .nexus-token {
            position: relative;
            padding: 3px 6px;
            color: rgba(255, 255, 255, 0.25);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: transparent;
            border-radius: 4px;
        }

        .nexus-token--active {
            color: #00CED1;
            background: rgba(0, 206, 209, 0.15);
            text-shadow: 0 0 12px rgba(0, 206, 209, 0.8),
                         0 0 24px rgba(0, 206, 209, 0.4);
            animation: token-burst 0.5s ease-out;
        }

        @keyframes token-burst {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(0, 206, 209, 0.6);
            }
            50% {
                transform: scale(1.2);
                box-shadow: 0 0 0 10px rgba(0, 206, 209, 0);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(0, 206, 209, 0);
            }
        }

        /* 3. Hero Mesh Background */
        .hero-mesh-bg {
            position: absolute;
            inset: 0;
            background-image:
                linear-gradient(rgba(0, 206, 209, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 206, 209, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: mesh-drift 25s linear infinite;
            mask-image: radial-gradient(ellipse 90% 70% at 50% 40%, black 20%, transparent 70%);
            -webkit-mask-image: radial-gradient(ellipse 90% 70% at 50% 40%, black 20%, transparent 70%);
            pointer-events: none;
        }

        @keyframes mesh-drift {
            0% { background-position: 0 0; }
            100% { background-position: 50px 50px; }
        }

        /* Floating orbs */
        .hero-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            animation: orb-float 10s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }

        .hero-orb--cyan {
            width: 500px;
            height: 500px;
            background: rgba(0, 206, 209, 0.06);
            top: 5%;
            right: 5%;
        }

        .hero-orb--purple {
            width: 400px;
            height: 400px;
            background: rgba(139, 92, 246, 0.05);
            bottom: 10%;
            left: 0;
            animation-delay: -5s;
        }

        @keyframes orb-float {
            0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.6; }
            33% { transform: translate(25px, -15px) scale(1.05); opacity: 0.8; }
            66% { transform: translate(-15px, 10px) scale(0.95); opacity: 0.5; }
        }

        /* 4. CTA Button Breathing Glow */
        .cta-glow {
            position: relative;
            animation: cta-breathe 3s ease-in-out infinite;
        }

        .cta-glow::before {
            content: '';
            position: absolute;
            inset: -3px;
            background: linear-gradient(45deg, #00CED1, #8B5CF6, #00F3FF, #00CED1);
            background-size: 300% 300%;
            animation: gradient-shift 4s ease infinite;
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: -1;
            filter: blur(12px);
            border-radius: inherit;
        }

        .cta-glow:hover::before {
            opacity: 0.5;
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes cta-breathe {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(0, 206, 209, 0),
                            inset 0 0 15px rgba(0, 206, 209, 0.03);
            }
            50% {
                box-shadow: 0 0 25px rgba(0, 206, 209, 0.12),
                            inset 0 0 25px rgba(0, 206, 209, 0.06);
            }
        }

        /* 5. Metrics Badge Micro-Interactions */
        .nexus-message-metrics {
            animation: metrics-slide-in 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes metrics-slide-in {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .nexus-metric {
            padding: 4px 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.03);
            transition: all 0.25s ease;
            cursor: default;
        }

        .nexus-metric:hover {
            background: rgba(0, 206, 209, 0.12);
            transform: translateY(-2px);
        }

        .nexus-metric--mode {
            position: relative;
            overflow: hidden;
        }

        .nexus-metric--mode::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 206, 209, 0.25), transparent);
            animation: metric-shimmer 2.5s ease-in-out infinite;
        }

        @keyframes metric-shimmer {
            100% { left: 100%; }
        }

        .nexus-mode-icon {
            font-size: 10px;
            margin-right: 3px;
        }

        /* 6. Enhanced Progress Bar */
        .nexus-progress-bar {
            height: 3px;
            background: linear-gradient(90deg,
                transparent 0%,
                #00CED1 15%,
                #00F3FF 50%,
                #00CED1 85%,
                transparent 100%
            );
            background-size: 200% 100%;
            border-radius: 2px;
            animation: progress-wave 1s ease-in-out infinite;
            position: relative;
            overflow: visible;
        }

        @keyframes progress-wave {
            0% { background-position: 100% 0; }
            100% { background-position: -100% 0; }
        }

        .nexus-progress-bar::before,
        .nexus-progress-bar::after {
            content: '';
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #00F3FF;
            top: -1.5px;
            box-shadow: 0 0 8px #00F3FF;
            animation: particle-move 1s ease-in-out infinite;
        }

        .nexus-progress-bar::after {
            animation-delay: 0.5s;
        }

        @keyframes particle-move {
            0% { left: 0%; opacity: 0; transform: scale(0.5); }
            15% { opacity: 1; transform: scale(1); }
            85% { opacity: 1; transform: scale(1); }
            100% { left: 100%; opacity: 0; transform: scale(0.5); }
        }

        /* 7. Border Radius System */
        :root {
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
        }

        /* 8. Chat Widget Container Glow */
        #chat > div {
            transition: all 0.4s ease;
        }

        #chat > div:hover {
            box-shadow: 0 0 40px rgba(0, 206, 209, 0.1),
                        0 0 80px rgba(0, 206, 209, 0.05);
        }

        /* 9. Scanline overlay enhancement */
        .scanline-active::before {
            content: '';
            position: absolute;
            inset: 0;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 206, 209, 0.01) 2px,
                rgba(0, 206, 209, 0.01) 4px
            );
            pointer-events: none;
            animation: scanline-scroll 8s linear infinite;
        }

        @keyframes scanline-scroll {
            0% { background-position: 0 0; }
            100% { background-position: 0 100px; }
        }

        /* 10. Entrance animations for hero elements */
        .hero-animate-1 { animation: hero-fade-up 0.8s ease-out 0.2s both; }
        .hero-animate-2 { animation: hero-fade-up 0.8s ease-out 0.4s both; }
        .hero-animate-3 { animation: hero-fade-up 0.8s ease-out 0.6s both; }
        .hero-animate-4 { animation: hero-fade-up 0.8s ease-out 0.8s both; }

        @keyframes hero-fade-up {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ============================================
           NUCLEAR FIX: Descender Clipping (g/y/p/q/j)
           ============================================ */

        /* Force all text in these sections to have breathing room */
        .a2i-ef,
        .a2i-ef *,
        .a2i-hiw,
        .a2i-hiw * {
            text-rendering: geometricPrecision;
            -webkit-font-smoothing: antialiased;
        }

        /* Quote text specifically - this is where the clipping happens */
        .a2i-ef__quote,
        .a2i-ef__name,
        .a2i-ef__meta,
        .a2i-ef__micro,
        .a2i-ef__statNum,
        .a2i-ef__statLabel,
        .a2i-ef__statsFoot,
        .a2i-hiw__title,
        .a2i-hiw__sub,
        .a2i-hiw__cardTitle,
        .a2i-hiw__cardText,
        .a2i-hiw__phase {
            line-height: 1.4 !important;
            padding-bottom: 4px !important;
            overflow: visible !important;
            position: relative;
            z-index: 2;
        }

        /* The quote specifically needs extra room for descenders */
        .a2i-ef__quote {
            line-height: 1.5 !important;
            padding-bottom: 8px !important;
        }

        /* CRITICAL: Card content wrapper must NOT clip */
        .a2i-ef__quoteCard,
        .a2i-ef__statsCard,
        .a2i-hiw__card {
            overflow: visible !important;
        }

        /* Only clip the pseudo-element glow, not the content */
        .a2i-ef__quoteCard::before,
        .a2i-ef__statsCard::before,
        .a2i-hiw__card::before {
            overflow: hidden;
            z-index: 0;
        }

        /* Ensure text wrapper has no clipping */
        .a2i-ef__quoteWrap,
        .a2i-text-wrap {
            overflow: visible !important;
        }

        /* If using backdrop-filter, it can create clipping - ensure z-index hierarchy */
        .a2i-ef__quoteCard > *,
        .a2i-ef__statsCard > *,
        .a2i-hiw__card > * {
            position: relative;
            z-index: 1;
        }

        .a2i-text-stack {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        /* ============================================
           EARLY FEEDBACK SECTION
           ============================================ */
        .a2i-ef { position: relative; padding: 72px 16px; }
        .a2i-ef__inner { max-width: 1100px; margin: 0 auto; }
        .a2i-ef__grid {
            display: grid;
            gap: 18px;
            grid-template-columns: 1.35fr 0.85fr;
        }
        @media (max-width: 920px) {
            .a2i-ef__grid { grid-template-columns: 1fr; }
        }

        .a2i-ef__quoteCard,
        .a2i-ef__statsCard {
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.10);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            box-shadow: 0 0 0 1px rgba(0, 191, 255, 0.08), 0 40px 120px rgba(0, 0, 0, 0.55);
            position: relative;
        }

        .a2i-ef__quoteCard { padding: 28px; overflow: visible; }
        .a2i-ef__statsCard { padding: 24px; overflow: visible; }

        .a2i-ef__quoteCard::before,
        .a2i-ef__statsCard::before {
            content: "";
            position: absolute;
            inset: -2px;
            border-radius: 20px;
            background: radial-gradient(500px 200px at 20% 0%, rgba(0, 191, 255, 0.18), transparent 60%),
                        radial-gradient(500px 200px at 90% 40%, rgba(16, 185, 129, 0.10), transparent 60%);
            pointer-events: none;
            z-index: 0;
        }

        .a2i-ef__tag {
            display: inline-flex;
            font-size: 10px;
            letter-spacing: 0.14em;
            font-weight: 800;
            color: rgba(0, 191, 255, 0.92);
            border: 1px solid rgba(0, 191, 255, 0.22);
            background: rgba(0, 191, 255, 0.06);
            padding: 8px 12px;
            border-radius: 999px;
            position: relative;
            z-index: 1;
        }

        .a2i-ef__quoteWrap { margin-top: 20px; position: relative; z-index: 1; }

        .a2i-ef__bigMark {
            font-size: 64px;
            line-height: 1;
            color: rgba(0, 191, 255, 0.25);
            margin-bottom: -16px;
            font-family: Georgia, serif;
        }

        .a2i-ef__quote {
            font-size: clamp(20px, 2.2vw, 28px);
            font-weight: 700;
            color: rgba(255, 255, 255, 0.92);
            max-width: 48ch;
            line-height: 1.4;
        }

        .a2i-ef__highlight {
            color: rgba(0, 191, 255, 1);
        }

        .a2i-ef__who {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-top: 24px;
        }

        .a2i-ef__avatar {
            width: 40px;
            height: 40px;
            border-radius: 999px;
            background: linear-gradient(135deg, rgba(0, 191, 255, 0.6), rgba(10, 10, 30, 0.8));
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .a2i-ef__name {
            font-weight: 800;
            color: rgba(255, 255, 255, 0.88);
            font-size: 13px;
        }

        .a2i-ef__meta {
            color: rgba(255, 255, 255, 0.50);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .a2i-ef__underline {
            height: 1px;
            margin: 24px 0 16px;
            background: linear-gradient(90deg, rgba(0, 191, 255, 0.35), rgba(255, 255, 255, 0.08), transparent);
            position: relative;
            z-index: 1;
        }

        .a2i-ef__micro {
            color: rgba(255, 255, 255, 0.50);
            font-size: 12px;
            max-width: 70ch;
            position: relative;
            z-index: 1;
        }

        .a2i-ef__statsHead {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
            margin-bottom: 20px;
        }

        .a2i-ef__statsTitle {
            font-size: 11px;
            letter-spacing: 0.18em;
            font-weight: 900;
            color: rgba(255, 255, 255, 0.65);
        }

        .a2i-ef__liveDot {
            font-size: 10px;
            font-weight: 900;
            letter-spacing: 0.16em;
            color: rgba(16, 185, 129, 0.95);
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .a2i-ef__liveDot span {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: rgba(16, 185, 129, 0.95);
            box-shadow: 0 0 12px rgba(16, 185, 129, 0.8);
            animation: a2iPulse 1.6s infinite;
        }

        @keyframes a2iPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.4); opacity: 0.6; }
        }

        .a2i-ef__statsGrid {
            display: grid;
            gap: 12px;
            grid-template-columns: 1fr;
            position: relative;
            z-index: 1;
        }

        .a2i-ef__stat {
            padding: 16px;
            border-radius: 14px;
            background: rgba(0, 0, 0, 0.30);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .a2i-ef__statNum {
            font-size: 26px;
            font-weight: 950;
            color: rgba(0, 191, 255, 0.95);
            letter-spacing: -0.02em;
        }

        .a2i-ef__statLabel {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.55);
            margin-top: 4px;
        }

        .a2i-ef__statsFoot {
            margin-top: 16px;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.45);
            position: relative;
            z-index: 1;
            line-height: 1.5;
        }

        /* ============================================
           HOW IT WORKS SECTION
           ============================================ */
        .a2i-hiw { position: relative; padding: 80px 16px 60px; }
        .a2i-hiw__inner { max-width: 1100px; margin: 0 auto; }

        .a2i-hiw__head { margin-bottom: 32px; }

        .a2i-hiw__kicker {
            font-size: 11px;
            letter-spacing: 0.18em;
            font-weight: 900;
            color: rgba(0, 191, 255, 0.72);
        }

        .a2i-hiw__title {
            margin-top: 12px;
            font-size: clamp(36px, 4.5vw, 60px);
            font-weight: 950;
            color: rgba(255, 255, 255, 0.95);
            letter-spacing: -0.03em;
        }

        .a2i-hiw__sub {
            margin-top: 8px;
            font-size: clamp(18px, 2.2vw, 26px);
            color: rgba(255, 255, 255, 0.55);
        }

        .a2i-hiw__bar {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .a2i-hiw__pill {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.60);
            border: 1px solid rgba(255, 255, 255, 0.10);
            background: rgba(255, 255, 255, 0.04);
            padding: 8px 14px;
            border-radius: 999px;
        }

        .a2i-hiw__steps {
            display: grid;
            gap: 16px;
            grid-template-columns: repeat(3, 1fr);
        }

        @media (max-width: 980px) {
            .a2i-hiw__steps { grid-template-columns: 1fr; }
        }

        .a2i-hiw__card {
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.10);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            padding: 24px;
            position: relative;
            overflow: visible;
            box-shadow: 0 0 0 1px rgba(0, 191, 255, 0.06), 0 40px 120px rgba(0, 0, 0, 0.55);
            transition: border-color 0.3s ease;
        }

        .a2i-hiw__card:hover {
            border-color: rgba(255, 255, 255, 0.20);
        }

        .a2i-hiw__card::before {
            content: "";
            position: absolute;
            inset: -2px;
            border-radius: 20px;
            background:
                radial-gradient(500px 220px at 30% 0%, rgba(0, 191, 255, 0.12), transparent 60%),
                radial-gradient(500px 220px at 100% 30%, rgba(255, 215, 0, 0.06), transparent 60%);
            pointer-events: none;
            z-index: 0;
        }

        .a2i-hiw__top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
            margin-bottom: 16px;
        }

        .a2i-hiw__stepNum {
            font-size: 12px;
            font-weight: 950;
            letter-spacing: 0.18em;
            color: rgba(0, 191, 255, 0.85);
            border: 1px solid rgba(0, 191, 255, 0.20);
            background: rgba(0, 191, 255, 0.06);
            padding: 8px 12px;
            border-radius: 999px;
        }

        .a2i-hiw__icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.10);
        }

        .a2i-hiw__icon--cyan {
            background: radial-gradient(circle at 30% 30%, rgba(0, 191, 255, 0.55), rgba(255, 255, 255, 0.06));
        }

        .a2i-hiw__icon--green {
            background: radial-gradient(circle at 30% 30%, rgba(16, 185, 129, 0.50), rgba(255, 255, 255, 0.06));
        }

        .a2i-hiw__icon--gold {
            background: radial-gradient(circle at 30% 30%, rgba(255, 215, 0, 0.45), rgba(255, 255, 255, 0.06));
        }

        .a2i-hiw__cardTitle {
            position: relative;
            z-index: 1;
            font-size: 20px;
            font-weight: 900;
            color: rgba(255, 255, 255, 0.92);
            margin-top: 8px;
        }

        .a2i-hiw__cardText {
            position: relative;
            z-index: 1;
            margin-top: 12px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.55);
            line-height: 1.6;
            max-width: 52ch;
        }

        .a2i-hiw__phase {
            position: relative;
            z-index: 1;
            margin-top: 20px;
            font-size: 11px;
            font-weight: 900;
            letter-spacing: 0.14em;
        }

        .a2i-hiw__phase--cyan { color: rgba(0, 191, 255, 0.75); }
        .a2i-hiw__phase--green { color: rgba(16, 185, 129, 0.75); }
        .a2i-hiw__phase--gold { color: rgba(255, 215, 0, 0.75); }
    </style>

    <!-- Payment handled via Stripe Payment Link -->

    <!-- NEXUS BRIDGE SSE Client for real-time production tracking -->
    <script src="js/nexus_sse_client.js"></script>
    <!-- Agent Micro-Visualizations (React via esm.sh) -->
    <script type="module" src="js/agent-visuals-integration.js"></script>
    <!-- Neural RAG Brain v3.0 Cognitive Status Panel -->
    <script src="js/neural-brain-integration.js"></script>

    <!-- Engine HUD Styles - DEPRECATED: Now integrated in Neural Interface widget
         Keeping spin keyframe for global use -->
    <style id="engine-hud-styles">
    @keyframes spin {
        to { transform: rotate(360deg); }
    }
    </style>
</head>
<body class="antialiased font-sans selection:bg-neon selection:text-white">
    <div id="canvas-container"></div>

    <!-- ========== GLOBAL HEADER (LEGENDARY REMASTER + MOBILE NAV) ========== -->
    <header id="global-header" class="fixed top-0 left-0 right-0 z-[100] px-4 md:px-6 py-3 md:py-6 transition-all duration-300">
        <!-- Glassmorphism Background -->
        <div class="absolute inset-0 bg-transparent backdrop-blur-none transition-all duration-300" id="header-bg"></div>
        <!-- LEGENDARY Animated Border Glow -->
        <div class="header-glow-border"></div>

        <nav class="max-w-7xl mx-auto relative flex items-center justify-between">
            <!-- Brand Section with Status Indicator -->
            <a href="/" class="flex items-center gap-4 md:gap-5 group">
                <div class="relative">
                    <!-- Shard Logo with LEGENDARY Breathing Glow -->
                    <div class="relative w-16 h-16 md:w-24 md:h-24 flex items-center justify-center">
                        <div class="hidden md:block absolute inset-0 bg-brand-teal blur-xl opacity-20 group-hover:opacity-40 transition-opacity duration-300 rounded-full"></div>
                        <img
                            src="brand/barrios-a2i-shard-logo.png"
                            alt="Barrios A2I"
                            class="relative w-14 h-14 md:w-20 md:h-20 object-contain transition-all duration-300"
                            style="-webkit-filter: none !important; filter: none !important;"
                        >
                    </div>
                    <!-- Active Status Dot with Pulse -->
                    <div class="absolute -top-1 -right-1 md:-top-2 md:-right-2 w-2.5 h-2.5 md:w-3 md:h-3 bg-brand-gold rounded-full status-pulse"></div>
                </div>
                <div class="hidden md:flex flex-col">
                    <a href="/status" class="text-brand-teal font-mono text-xs tracking-[0.2em] leading-none mb-1 hover:text-green-500 transition-colors">SYSTEM_CONNECTED</a>
                    <span class="text-white font-black tracking-tighter text-2xl leading-none">
                        BARRIOS <span class="text-brand-gold">A2I</span>
                    </span>
                </div>
            </a>

            <!-- Center Navigation with Gold Trace (Desktop) - LEGENDARY REMASTER -->
            <div class="hidden lg:flex items-center gap-2">
                <a href="/#pricing" class="nav-link group flex items-center px-3 py-1.5 transition-all">
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">[</span>
                    <span class="mx-2 text-[11px] font-mono tracking-widest text-gray-400 group-hover:text-white transition-colors">PRICING</span>
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">]</span>
                </a>
                <a href="/nexus-personal" class="nav-link group flex items-center px-3 py-1.5 transition-all">
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">[</span>
                    <span class="mx-2 text-[11px] font-mono tracking-widest text-white transition-colors flex items-center gap-2">
                        NEXUS
                        <span class="w-1.5 h-1.5 bg-brand-teal rounded-full shadow-[0_0_8px_#00CED1] status-pulse"></span>
                    </span>
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">]</span>
                </a>
                <a href="/creative-director" class="nav-link group flex items-center px-3 py-1.5 transition-all">
                    <span class="bracket text-brand-gold font-mono text-sm">[</span>
                    <span class="mx-2 text-[11px] font-mono tracking-widest text-white transition-colors">COMMERCIAL_LAB</span>
                    <span class="bracket text-brand-gold font-mono text-sm">]</span>
                </a>
                <a href="/founder" class="nav-link group flex items-center px-3 py-1.5 transition-all">
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">[</span>
                    <span class="mx-2 text-[11px] font-mono tracking-widest text-gray-400 group-hover:text-white transition-colors">FOUNDER</span>
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">]</span>
                </a>
                <a href="/command-center" class="nav-link group flex items-center px-3 py-1.5 transition-all">
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">[</span>
                    <span class="mx-2 text-[11px] font-mono tracking-widest text-white transition-colors flex items-center gap-2">
                        COMMAND
                        <span class="w-1.5 h-1.5 bg-brand-gold rounded-full shadow-[0_0_8px_#FFD700] status-pulse"></span>
                    </span>
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">]</span>
                </a>
                <a href="/status" class="nav-link group flex items-center px-3 py-1.5 transition-all">
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">[</span>
                    <span class="mx-2 text-[11px] font-mono tracking-widest text-gray-400 group-hover:text-white transition-colors">STATUS</span>
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">]</span>
                </a>
            </div>

            <!-- Action Buttons -->
            <div class="flex items-center gap-3 md:gap-6">
                <a href="/login" class="hidden sm:block text-[10px] font-mono text-gray-500 hover:text-brand-gold transition-colors tracking-widest">
                    AUTH_LOGIN
                </a>

                <!-- Desktop CTA -->
                <a href="#" onclick="event.stopPropagation(); toggleNeuralInterface(); return false;" class="hidden md:flex group relative px-5 py-2 bg-white/5 border border-brand-teal/30 backdrop-blur-md overflow-hidden hover:border-brand-gold transition-all duration-300">
                    <div class="absolute inset-0 bg-brand-teal/5 group-hover:bg-brand-gold/10 transition-colors"></div>
                    <div class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-brand-teal to-transparent"></div>
                    <div class="relative flex items-center gap-3">
                        <iconify-icon icon="lucide:terminal" width="14" class="text-brand-teal group-hover:text-brand-gold transition-colors"></iconify-icon>
                        <span class="text-[11px] font-mono font-bold text-white tracking-[0.15em]">BEGIN_INTAKE</span>
                    </div>
                    <div class="absolute top-0 left-0 w-1 h-1 border-t border-l border-brand-teal/50 group-hover:border-brand-gold transition-colors"></div>
                    <div class="absolute bottom-0 right-0 w-1 h-1 border-b border-r border-brand-teal/50 group-hover:border-brand-gold transition-colors"></div>
                </a>

                <!-- Mobile Menu Toggle -->
                <button id="mobile-menu-toggle" class="lg:hidden relative w-10 h-10 flex items-center justify-center rounded-lg border border-white/10 bg-white/5 backdrop-blur-md transition-all hover:border-brand-teal/50 focus:outline-none focus-visible:ring-2 focus-visible:ring-brand-teal/50" aria-label="Toggle navigation menu" aria-expanded="false">
                    <div class="relative w-5 h-4 flex flex-col justify-between">
                        <span id="menu-line-1" class="block w-full h-0.5 bg-brand-teal transition-all duration-300 origin-center"></span>
                        <span id="menu-line-2" class="block w-full h-0.5 bg-brand-teal transition-all duration-300"></span>
                        <span id="menu-line-3" class="block w-full h-0.5 bg-brand-teal transition-all duration-300 origin-center"></span>
                    </div>
                </button>
            </div>
        </nav>

        <!-- Mobile Navigation Drawer -->
        <div id="mobile-nav-drawer" class="lg:hidden absolute left-0 right-0 top-full overflow-hidden transition-all duration-300 ease-out" style="max-height: 0; opacity: 0;">
            <div class="mx-4 mt-2 rounded-2xl border border-white/10 bg-obsidian/95 backdrop-blur-xl shadow-2xl overflow-hidden">
                <!-- Nav Links - LEGENDARY REMASTER -->
                <nav class="p-4 space-y-1">
                    <a href="/#pricing" class="mobile-nav-link group flex items-center gap-3 px-4 py-3 rounded-xl transition-all hover:bg-white/5">
                        <iconify-icon icon="lucide:rocket" width="16" class="text-brand-teal/60 group-hover:text-brand-teal transition-colors"></iconify-icon>
                        <span class="text-xs font-mono tracking-widest text-gray-400 group-hover:text-white transition-colors">PRICING</span>
                    </a>

                    <!-- Divider -->
                    <div class="my-3 h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"></div>

                    <!-- Commercial Lab - Active Page -->
                    <a href="/creative-director" class="mobile-nav-link group relative flex items-center gap-3 px-4 py-4 rounded-xl transition-all bg-brand-gold/10 border border-brand-gold/30">
                        <div class="absolute inset-0 rounded-xl bg-gradient-to-r from-brand-gold/10 to-transparent opacity-100"></div>
                        <div class="relative flex items-center gap-3">
                            <div class="relative">
                                <iconify-icon icon="lucide:sparkles" width="18" class="text-brand-gold transition-colors"></iconify-icon>
                                <div class="absolute -top-0.5 -right-0.5 w-1.5 h-1.5 bg-brand-gold rounded-full animate-pulse"></div>
                            </div>
                            <div class="flex flex-col">
                                <span class="text-xs font-mono tracking-widest text-white font-bold">COMMERCIAL_LAB</span>
                                <span class="text-[9px] font-mono text-brand-gold/70 tracking-wider">AI-POWERED AD STUDIO</span>
                            </div>
                        </div>
                    </a>
                <a href="/founder" class="nav-link group flex items-center px-3 py-1.5 transition-all">
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">[</span>
                    <span class="mx-2 text-[11px] font-mono tracking-widest text-gray-400 group-hover:text-white transition-colors">FOUNDER</span>
                    <span class="bracket text-brand-teal/40 font-mono text-sm group-hover:text-brand-gold transition-colors">]</span>
                </a>

                    <a href="/nexus-personal" class="mobile-nav-link group flex items-center gap-3 px-4 py-3 rounded-xl transition-all hover:bg-white/5">
                        <iconify-icon icon="lucide:brain" width="16" class="text-brand-teal/60 group-hover:text-brand-teal transition-colors"></iconify-icon>
                        <span class="text-xs font-mono tracking-widest text-gray-400 group-hover:text-white transition-colors flex items-center gap-2">
                            NEXUS
                            <span class="w-1.5 h-1.5 bg-brand-teal rounded-full shadow-[0_0_6px_#00CED1]"></span>
                        </span>
                    </a>

                    <!-- Command Center -->
                    <a href="/command-center" class="mobile-nav-link group relative flex items-center gap-3 px-4 py-4 rounded-xl transition-all bg-brand-gold/5 border border-brand-gold/20 hover:bg-brand-gold/10 hover:border-brand-gold/40">
                        <div class="absolute inset-0 rounded-xl bg-gradient-to-r from-brand-gold/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
                        <div class="relative flex items-center gap-3">
                            <div class="relative">
                                <iconify-icon icon="lucide:command" width="18" class="text-brand-gold transition-colors"></iconify-icon>
                                <div class="absolute -top-0.5 -right-0.5 w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></div>
                            </div>
                            <div class="flex flex-col">
                                <span class="text-xs font-mono tracking-widest text-white font-bold">COMMAND_CENTER</span>
                                <span class="text-[9px] font-mono text-brand-gold/70 tracking-wider">ADMIN DASHBOARD</span>
                            </div>
                        </div>
                        <iconify-icon icon="lucide:arrow-right" width="14" class="ml-auto text-brand-gold/50 group-hover:text-brand-gold group-hover:translate-x-1 transition-all"></iconify-icon>
                    </a>

                    <a href="/status" class="mobile-nav-link group flex items-center gap-3 px-4 py-3 rounded-xl transition-all hover:bg-white/5">
                        <iconify-icon icon="lucide:activity" width="16" class="text-green-500/60 group-hover:text-green-500 transition-colors"></iconify-icon>
                        <span class="text-xs font-mono tracking-widest text-gray-400 group-hover:text-white transition-colors flex items-center gap-2">
                            SYSTEM_STATUS
                            <span class="w-1.5 h-1.5 bg-green-500 rounded-full shadow-[0_0_6px_#22C55E]"></span>
                        </span>
                    </a>
                </nav>

                <!-- Mobile CTA -->
                <div class="p-4 pt-0">
                    <a href="#" onclick="event.stopPropagation(); toggleNeuralInterface(); closeMobileMenu(); return false;" class="group flex items-center justify-center gap-2 w-full py-3 rounded-xl bg-brand-teal/10 border border-brand-teal/30 transition-all hover:bg-brand-teal/20 hover:border-brand-teal/50">
                        <iconify-icon icon="lucide:terminal" width="14" class="text-brand-teal"></iconify-icon>
                        <span class="text-[11px] font-mono font-bold text-white tracking-[0.15em]">BEGIN_INTAKE</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Header Scroll Behavior + Mobile Menu Script -->
    <script>
    (function() {
        const header = document.getElementById('global-header');
        const headerBg = document.getElementById('header-bg');
        const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
        const mobileNavDrawer = document.getElementById('mobile-nav-drawer');
        const menuLine1 = document.getElementById('menu-line-1');
        const menuLine2 = document.getElementById('menu-line-2');
        const menuLine3 = document.getElementById('menu-line-3');
        const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');

        let isMenuOpen = false;

        // Scroll behavior
        window.addEventListener('scroll', () => {
            const currentScroll = window.scrollY;
            const isMobile = window.innerWidth < 768;

            if (currentScroll > 10) {
                header.classList.remove('py-3', 'md:py-6');
                header.classList.add(isMobile ? 'py-2' : 'py-3');
                headerBg.classList.remove('bg-transparent', 'backdrop-blur-none');
                headerBg.classList.add('bg-obsidian/90', 'backdrop-blur-xl', 'border-b', 'border-white/10');
            } else {
                header.classList.remove('py-2', 'py-3');
                header.classList.add('py-3', 'md:py-6');
                headerBg.classList.remove('bg-obsidian/90', 'backdrop-blur-xl', 'border-b', 'border-white/10');
                headerBg.classList.add('bg-transparent', 'backdrop-blur-none');
            }
        });

        // Mobile menu toggle
        function toggleMenu() {
            isMenuOpen = !isMenuOpen;
            mobileMenuToggle.setAttribute('aria-expanded', isMenuOpen);

            if (isMenuOpen) {
                mobileNavDrawer.style.maxHeight = '500px';
                mobileNavDrawer.style.opacity = '1';
                // Animate hamburger to X
                menuLine1.style.transform = 'rotate(45deg) translateY(6px)';
                menuLine2.style.opacity = '0';
                menuLine3.style.transform = 'rotate(-45deg) translateY(-6px)';
            } else {
                mobileNavDrawer.style.maxHeight = '0';
                mobileNavDrawer.style.opacity = '0';
                // Reset hamburger
                menuLine1.style.transform = 'none';
                menuLine2.style.opacity = '1';
                menuLine3.style.transform = 'none';
            }
        }

        mobileMenuToggle.addEventListener('click', toggleMenu);

        // Close menu on nav link click
        mobileNavLinks.forEach(link => {
            link.addEventListener('click', () => {
                if (isMenuOpen) {
                    toggleMenu();
                }
            });
        });

        // Close menu on resize to desktop
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 1024 && isMenuOpen) {
                toggleMenu();
            }
        });
    })();
    </script>

    <main class="relative z-10 w-full">
        <!-- HERO -->
        <section class="min-h-screen w-full flex flex-col lg:flex-row justify-center items-center px-4 lg:px-6 relative pt-24 pb-12 gap-8 lg:gap-12 overflow-hidden">
            <!-- Animated Mesh Background -->
            <div class="hero-mesh-bg"></div>
            <!-- Floating Orbs -->
            <div class="hero-orb hero-orb--cyan"></div>
            <div class="hero-orb hero-orb--purple"></div>

            <div class="max-w-xl space-y-6 text-center lg:text-left relative z-10">
                <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 border border-white/10 backdrop-blur-sm" style="animation: fadeSlideIn 0.8s ease-out 0.8s both;">
                    <span class="w-2 h-2 rounded-full bg-neon animate-pulse"></span>
                    <span class="text-neon text-xs font-medium tracking-widest uppercase">AI Creative Director &bull; No Signup Required</span>
                </div>
                <h1 class="text-4xl md:text-6xl lg:text-7xl font-semibold tracking-tighter leading-none" style="animation: fadeSlideIn 0.8s ease-out 1s both;">
                    Your Commercial Brief<span class="text-neon">.</span>
                    <br><span class="text-white/50 font-serif italic font-normal">Built in Minutes.</span>
                </h1>
                <p class="text-base text-white/60 max-w-md mx-auto lg:mx-0" style="animation: fadeSlideIn 0.8s ease-out 1.2s both;">
                    Answer guided questions. Receive a production-ready brief optimized for AI video generation. No guesswork. No blank page.
                </p>
                <div class="space-y-3 text-left max-w-md mx-auto lg:mx-0" style="animation: fadeSlideIn 0.8s ease-out 1.3s both;">
                    <div class="flex items-center gap-3">
                        <div class="w-1.5 h-1.5 bg-neon rounded-full"></div>
                        <span class="text-sm text-white/70">Structured 10-phase intake &mdash; we ask, you answer</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-1.5 h-1.5 bg-neon rounded-full"></div>
                        <span class="text-sm text-white/70">Captures offer, audience, hook, tone &amp; CTA</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-1.5 h-1.5 bg-neon rounded-full"></div>
                        <span class="text-sm text-white/70">Output ready for Veo, Runway &amp; AI production</span>
                    </div>
                </div>
                <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start pt-4" style="animation: fadeSlideIn 0.8s ease-out 1.4s both;">
                    <a href="#" onclick="event.stopPropagation(); toggleNeuralInterface(); return false;" class="cta-glow group relative px-8 py-4 bg-transparent overflow-hidden border border-neon text-white transition-all hover:border-neon cursor-pointer">
                        <div class="absolute inset-0 w-0 bg-neon transition-all duration-[250ms] ease-out group-hover:w-full opacity-80"></div>
                        <span class="relative flex items-center justify-center gap-3 text-sm font-medium uppercase tracking-widest group-hover:text-white">
                            Begin Your Brief
                            <i data-lucide="arrow-right" class="w-4 h-4" stroke-width="1.5"></i>
                        </span>
                    </a>
                    <a href="#how-it-works" class="group relative px-8 py-4 bg-transparent overflow-hidden border border-white/30 text-white transition-all hover:border-white/60">
                        <span class="relative flex items-center justify-center gap-3 text-sm font-medium uppercase tracking-widest">
                            See the Process
                        </span>
                    </a>
                </div>
            </div>

            <!-- NOTE: Old embedded chat widget removed - use Neural Interface FAB (ni-fab) instead -->
        </section>

        <!-- ========== HOW IT WORKS (REMASTERED) ========== -->
        <section class="a2i-hiw" id="how-it-works">
            <div class="a2i-hiw__inner">

                <header class="a2i-hiw__head">
                    <div class="a2i-hiw__kicker">THE PROCESS &bull; 3 STEPS</div>
                    <h2 class="a2i-hiw__title a2i-type-safe">How It Works.</h2>
                    <p class="a2i-hiw__sub a2i-type-safe">We guide. You answer. Done.</p>

                    <div class="a2i-hiw__bar">
                        <div class="a2i-hiw__pill a2i-type-safe">10 guided phases</div>
                        <div class="a2i-hiw__pill a2i-type-safe">&lt;5 min average</div>
                        <div class="a2i-hiw__pill a2i-type-safe">Production-ready brief</div>
                    </div>
                </header>

                <div class="a2i-hiw__steps">

                    <!-- Step 01: Define Business -->
                    <article class="a2i-hiw__card">
                        <div class="a2i-hiw__top">
                            <div class="a2i-hiw__stepNum">01</div>
                            <div class="a2i-hiw__icon a2i-hiw__icon--cyan"></div>
                        </div>
                        <h3 class="a2i-hiw__cardTitle a2i-type-safe">Define Your Business</h3>
                        <p class="a2i-hiw__cardText a2i-type-safe">
                            Tell us what you sell, who it's for, and what outcome you want. We lock the offer and the core message.
                        </p>
                        <div class="a2i-hiw__phase a2i-hiw__phase--cyan a2i-type-safe">PHASES 1&ndash;3</div>
                    </article>

                    <!-- Step 02: Identify Audience -->
                    <article class="a2i-hiw__card">
                        <div class="a2i-hiw__top">
                            <div class="a2i-hiw__stepNum">02</div>
                            <div class="a2i-hiw__icon a2i-hiw__icon--green"></div>
                        </div>
                        <h3 class="a2i-hiw__cardTitle a2i-type-safe">Identify Your Audience</h3>
                        <p class="a2i-hiw__cardText a2i-type-safe">
                            We extract pain points, objections, and motivations &mdash; then shape hooks that match how your buyers think.
                        </p>
                        <div class="a2i-hiw__phase a2i-hiw__phase--green a2i-type-safe">PHASES 4&ndash;6</div>
                    </article>

                    <!-- Step 03: Creative Direction -->
                    <article class="a2i-hiw__card">
                        <div class="a2i-hiw__top">
                            <div class="a2i-hiw__stepNum">03</div>
                            <div class="a2i-hiw__icon a2i-hiw__icon--gold"></div>
                        </div>
                        <h3 class="a2i-hiw__cardTitle a2i-type-safe">Set Creative Direction</h3>
                        <p class="a2i-hiw__cardText a2i-type-safe">
                            Choose tone, pacing, and CTA. You walk away with a brief that a production team can execute immediately.
                        </p>
                        <div class="a2i-hiw__phase a2i-hiw__phase--gold a2i-type-safe">PHASES 7&ndash;10</div>
                    </article>

                </div>

            </div>
        </section>

        <!-- ========== EARLY FEEDBACK (REMASTERED) ========== -->
        <section class="a2i-ef" id="early-feedback">
            <div class="a2i-ef__inner">
                <div class="a2i-ef__grid">

                    <!-- LEFT: Quote Card -->
                    <div class="a2i-ef__quoteCard">
                        <div class="a2i-ef__tag">EARLY ACCESS FEEDBACK</div>

                        <div class="a2i-ef__quoteWrap a2i-text-wrap a2i-text-stack">
                            <div class="a2i-ef__bigMark">"</div>
                            <p class="a2i-ef__quote a2i-type-safe">
                                I came in with a vague idea. The guided questions pulled out details I hadn't thought to include. Walked away with a brief I could <span class="a2i-ef__highlight">actually hand to production</span>.
                            </p>

                            <div class="a2i-ef__who">
                                <div class="a2i-ef__avatar"></div>
                                <div class="a2i-ef__whoText a2i-text-stack">
                                    <div class="a2i-ef__name a2i-type-safe">Sarah M., Founder</div>
                                    <div class="a2i-ef__meta a2i-type-safe">Professional Services</div>
                                </div>
                            </div>
                        </div>

                        <div class="a2i-ef__underline"></div>
                        <div class="a2i-ef__micro a2i-type-safe">
                            Output delivered as a production-ready brief &mdash; hooks, CTA, tone, and scene direction included.
                        </div>
                    </div>

                    <!-- RIGHT: Stats Card -->
                    <aside class="a2i-ef__statsCard">
                        <div class="a2i-ef__statsHead">
                            <div class="a2i-ef__statsTitle a2i-type-safe">INTAKE STATS</div>
                            <div class="a2i-ef__liveDot">
                                <span></span> LIVE
                            </div>
                        </div>

                        <div class="a2i-ef__statsGrid">
                            <div class="a2i-ef__stat">
                                <div class="a2i-ef__statNum a2i-type-safe">10</div>
                                <div class="a2i-ef__statLabel a2i-type-safe">Guided Phases</div>
                            </div>
                            <div class="a2i-ef__stat">
                                <div class="a2i-ef__statNum a2i-type-safe">&lt;5min</div>
                                <div class="a2i-ef__statLabel a2i-type-safe">Average Completion</div>
                            </div>
                            <div class="a2i-ef__stat">
                                <div class="a2i-ef__statNum a2i-type-safe">100%</div>
                                <div class="a2i-ef__statLabel a2i-type-safe">Production Ready</div>
                            </div>
                        </div>

                        <div class="a2i-ef__statsFoot a2i-type-safe">
                            Built to remove founder ambiguity &mdash; and hand your idea directly to video production.
                        </div>
                    </aside>

                </div>
            </div>
        </section>

        <!-- WHAT YOU GET -->
        <section id="deliverables" class="min-h-screen w-full relative z-10 py-24 px-6 flex flex-col items-center">
            <div class="max-w-7xl mx-auto w-full">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-white/10 pb-8 mb-12">
                    <div>
                        <span class="text-neon text-xs font-medium tracking-[0.2em] uppercase mb-2 block">Deliverables &bull; Your Output</span>
                        <h2 class="text-3xl md:text-5xl font-medium tracking-tight text-white max-w-2xl">
                            What You Receive<span class="text-neon">.</span>
                            <br><span class="text-white/50">Ready for production.</span>
                        </h2>
                    </div>
                    <p class="text-sm text-white/60 max-w-md text-right hidden md:block">
                        Your completed intake generates a comprehensive brief formatted for AI video tools and production teams.
                    </p>
                </div>

                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="group p-6 rounded-2xl bg-white/5 border border-white/10 hover:border-neon/50 transition-colors backdrop-blur-sm relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neon to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center">
                                <i data-lucide="briefcase" class="w-5 h-5 text-neon" stroke-width="1.5"></i>
                            </div>
                            <h3 class="text-base font-medium text-white">Brand &amp; Offer Summary</h3>
                        </div>
                        <p class="text-sm text-white/50 leading-relaxed">Clear articulation of your business identity, what you sell, and why it matters.</p>
                    </div>

                    <div class="group p-6 rounded-2xl bg-white/5 border border-white/10 hover:border-neon/50 transition-colors backdrop-blur-sm relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neon to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center">
                                <i data-lucide="target" class="w-5 h-5 text-neon" stroke-width="1.5"></i>
                            </div>
                            <h3 class="text-base font-medium text-white">Target Audience Profile</h3>
                        </div>
                        <p class="text-sm text-white/50 leading-relaxed">Detailed description of who you're reaching and the specific problems they need solved.</p>
                    </div>

                    <div class="group p-6 rounded-2xl bg-white/5 border border-white/10 hover:border-neon/50 transition-colors backdrop-blur-sm relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neon to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center">
                                <i data-lucide="zap" class="w-5 h-5 text-neon" stroke-width="1.5"></i>
                            </div>
                            <h3 class="text-base font-medium text-white">Hook &amp; Call-to-Action</h3>
                        </div>
                        <p class="text-sm text-white/50 leading-relaxed">Attention-grabbing opener and clear next step designed to drive viewer action.</p>
                    </div>

                    <div class="group p-6 rounded-2xl bg-white/5 border border-white/10 hover:border-neon/50 transition-colors backdrop-blur-sm relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neon to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center">
                                <i data-lucide="palette" class="w-5 h-5 text-neon" stroke-width="1.5"></i>
                            </div>
                            <h3 class="text-base font-medium text-white">Tone &amp; Style Direction</h3>
                        </div>
                        <p class="text-sm text-white/50 leading-relaxed">Creative guidance covering voice, pacing, and visual treatment for your commercial.</p>
                    </div>

                    <div class="group p-6 rounded-2xl bg-white/5 border border-white/10 hover:border-neon/50 transition-colors backdrop-blur-sm relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neon to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center">
                                <i data-lucide="monitor-play" class="w-5 h-5 text-neon" stroke-width="1.5"></i>
                            </div>
                            <h3 class="text-base font-medium text-white">AI Video Optimization</h3>
                        </div>
                        <p class="text-sm text-white/50 leading-relaxed">Brief structured for direct use with Veo, Runway, and other AI generation platforms.</p>
                    </div>

                    <div class="group p-6 rounded-2xl bg-white/5 border border-white/10 hover:border-neon/50 transition-colors backdrop-blur-sm relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neon to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center">
                                <i data-lucide="file-text" class="w-5 h-5 text-neon" stroke-width="1.5"></i>
                            </div>
                            <h3 class="text-base font-medium text-white">Complete Brief Document</h3>
                        </div>
                        <p class="text-sm text-white/50 leading-relaxed">Everything consolidated into one production-ready document you can use immediately.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========== PRICING SECTION ========== -->
        <section id="pricing" class="w-full py-24 px-6 relative z-10">
            <div class="max-w-7xl mx-auto">
                <!-- Section Header -->
                <div class="flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-white/10 pb-8 mb-12">
                    <div>
                        <span class="text-neon text-xs font-medium tracking-[0.2em] uppercase mb-2 block">Subscriptions &bull; Token-Based</span>
                        <h2 class="text-3xl md:text-5xl font-medium tracking-tight text-white max-w-2xl">
                            A2I Commercial Lab<span class="text-neon">.</span>
                            <br><span class="text-white/50 font-serif italic font-normal">Choose your tier.</span>
                        </h2>
                    </div>
                    <div class="flex flex-col items-end gap-3">
                        <p class="text-sm text-white/60 max-w-md text-right hidden md:block">
                            64-second commercials engineered from 8-second cinematic scenes. 1 Token = 1 Scene.
                        </p>
                        <!-- Billing Toggle -->
                        <div class="flex items-center gap-3 bg-white/5 border border-white/10 rounded-full p-1">
                            <button id="billing-monthly" onclick="toggleBilling(false)" class="px-4 py-2 text-xs font-mono tracking-widest text-white bg-neon/20 border border-neon/50 rounded-full transition-all">MONTHLY</button>
                            <button id="billing-yearly" onclick="toggleBilling(true)" class="px-4 py-2 text-xs font-mono tracking-widest text-white/50 rounded-full transition-all hover:text-white">YEARLY <span class="text-brand-gold">-17%</span></button>
                        </div>
                    </div>
                </div>

                <!-- Pricing Grid -->
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <!-- Starter Tier -->
                    <div class="group relative p-6 rounded-2xl bg-white/5 border border-white/10 hover:border-neon/50 transition-all backdrop-blur-sm overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neon to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="relative z-10">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h3 class="text-lg font-semibold text-white">Starter</h3>
                                    <p class="text-xs text-white/40 mt-1">For testing the waters</p>
                                </div>
                                <div class="w-10 h-10 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center">
                                    <span class="text-neon font-mono text-sm">8</span>
                                </div>
                            </div>
                            <div class="mb-6">
                                <div class="flex items-baseline gap-1">
                                    <span class="text-3xl font-bold text-white price-display" data-tier="starter">$449</span>
                                    <span class="text-white/40 text-sm">/mo</span>
                                </div>
                                <p class="text-xs text-white/30 mt-1 yearly-savings hidden">$374/mo billed yearly</p>
                            </div>
                            <ul class="space-y-3 mb-6">
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span><strong class="text-white">8 Tokens</strong> (1 64s commercial)</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span><strong class="text-white">1 Format</strong> (9:16 or 16:9)</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span>1 Revision round</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span>5-Day Queue</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/30">
                                    <span class="mt-0.5"></span>
                                    <span>No Voice/Avatar Clone</span>
                                </li>
                            </ul>
                            <button onclick="scrollToSection('chat')" class="w-full py-3 bg-white/5 border border-white/20 text-white text-sm font-medium rounded-lg hover:bg-white/10 hover:border-neon/50 transition-all">
                                Get Started
                            </button>
                        </div>
                    </div>

                    <!-- Creator Tier (Most Popular) -->
                    <div class="group relative p-6 rounded-2xl bg-white/5 border-2 border-neon/50 hover:border-neon transition-all backdrop-blur-sm overflow-hidden shadow-[0_0_30px_rgba(0,206,209,0.15)]">
                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neon to-transparent"></div>
                        <!-- Most Popular Badge -->
                        <div class="absolute -top-3 left-1/2 -translate-x-1/2 px-4 py-1 bg-neon text-black text-[10px] font-bold uppercase tracking-widest rounded-full">
                            Most Popular
                        </div>
                        <div class="relative z-10 pt-2">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h3 class="text-lg font-semibold text-white">Creator</h3>
                                    <p class="text-xs text-white/40 mt-1">For growing brands</p>
                                </div>
                                <div class="w-10 h-10 rounded-lg bg-neon/20 border border-neon/50 flex items-center justify-center">
                                    <span class="text-neon font-mono text-sm">16</span>
                                </div>
                            </div>
                            <div class="mb-6">
                                <div class="flex items-baseline gap-1">
                                    <span class="text-3xl font-bold text-white price-display" data-tier="creator">$899</span>
                                    <span class="text-white/40 text-sm">/mo</span>
                                </div>
                                <p class="text-xs text-white/30 mt-1 yearly-savings hidden">$749/mo billed yearly</p>
                            </div>
                            <ul class="space-y-3 mb-6">
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span><strong class="text-white">16 Tokens</strong> (2 64s commercials)</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span><strong class="text-white">All 4 Formats</strong> (9:16, 16:9, 1:1, 4:5)</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span>2 Revision rounds</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span>3-Day Queue</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-brand-gold">
                                    <span class="mt-0.5"></span>
                                    <span><strong>Voice Clone</strong> included</span>
                                </li>
                            </ul>
                            <button onclick="scrollToSection('chat')" class="w-full py-3 bg-neon text-black text-sm font-bold rounded-lg hover:bg-white transition-all">
                                Start Creating
                            </button>
                        </div>
                    </div>

                    <!-- Growth Tier -->
                    <div class="group relative p-6 rounded-2xl bg-white/5 border border-white/10 hover:border-neon/50 transition-all backdrop-blur-sm overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neon to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="relative z-10">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h3 class="text-lg font-semibold text-white">Growth</h3>
                                    <p class="text-xs text-white/40 mt-1">For scaling campaigns</p>
                                </div>
                                <div class="w-10 h-10 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center">
                                    <span class="text-neon font-mono text-sm">32</span>
                                </div>
                            </div>
                            <div class="mb-6">
                                <div class="flex items-baseline gap-1">
                                    <span class="text-3xl font-bold text-white price-display" data-tier="growth">$1,699</span>
                                    <span class="text-white/40 text-sm">/mo</span>
                                </div>
                                <p class="text-xs text-white/30 mt-1 yearly-savings hidden">$1,416/mo billed yearly</p>
                            </div>
                            <ul class="space-y-3 mb-6">
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span><strong class="text-white">32 Tokens</strong> (4 64s commercials)</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span><strong class="text-white">All 4 Formats</strong></span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span>3 Revision rounds</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-neon mt-0.5"></span>
                                    <span>48-Hour Queue</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-brand-gold">
                                    <span class="mt-0.5"></span>
                                    <span><strong>Voice + Avatar Clone</strong></span>
                                </li>
                            </ul>
                            <button onclick="scrollToSection('chat')" class="w-full py-3 bg-white/5 border border-white/20 text-white text-sm font-medium rounded-lg hover:bg-white/10 hover:border-neon/50 transition-all">
                                Scale Up
                            </button>
                        </div>
                    </div>

                    <!-- Scale Tier -->
                    <div class="group relative p-6 rounded-2xl bg-white/5 border border-brand-gold/30 hover:border-brand-gold/60 transition-all backdrop-blur-sm overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-brand-gold to-transparent opacity-50 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="relative z-10">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h3 class="text-lg font-semibold text-white">Scale</h3>
                                    <p class="text-xs text-brand-gold/70 mt-1">Enterprise volume</p>
                                </div>
                                <div class="w-10 h-10 rounded-lg bg-brand-gold/10 border border-brand-gold/30 flex items-center justify-center">
                                    <span class="text-brand-gold font-mono text-sm">64</span>
                                </div>
                            </div>
                            <div class="mb-6">
                                <div class="flex items-baseline gap-1">
                                    <span class="text-3xl font-bold text-white price-display" data-tier="scale">$3,199</span>
                                    <span class="text-white/40 text-sm">/mo</span>
                                </div>
                                <p class="text-xs text-white/30 mt-1 yearly-savings hidden">$2,666/mo billed yearly</p>
                            </div>
                            <ul class="space-y-3 mb-6">
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-brand-gold mt-0.5"></span>
                                    <span><strong class="text-white">64 Tokens</strong> (8 64s commercials)</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-brand-gold mt-0.5"></span>
                                    <span><strong class="text-white">All 4 Formats</strong></span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-brand-gold mt-0.5"></span>
                                    <span>5 Revision rounds</span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-white/60">
                                    <span class="text-brand-gold mt-0.5"></span>
                                    <span><strong class="text-white">24-Hour Priority</strong></span>
                                </li>
                                <li class="flex items-start gap-2 text-sm text-brand-gold">
                                    <span class="mt-0.5"></span>
                                    <span><strong>Premium Clone Suite</strong></span>
                                </li>
                            </ul>
                            <button onclick="scrollToSection('chat')" class="w-full py-3 bg-brand-gold/20 border border-brand-gold/50 text-brand-gold text-sm font-bold rounded-lg hover:bg-brand-gold hover:text-black transition-all">
                                Go Enterprise
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Token Explainer Note -->
                <div class="mt-8 text-center">
                    <p class="text-xs text-white/40 font-mono">
                        <span class="text-neon">1 TOKEN</span> = 1 8-second scene &nbsp;|&nbsp;
                        <span class="text-neon">8 TOKENS</span> = 1 64-second commercial &nbsp;|&nbsp;
                        Tokens reset monthly (no rollover)
                    </p>
                </div>
            </div>
        </section>

        <!-- ========== TOKEN EXPLAINER SECTION ========== -->
        <section id="token-explainer" class="w-full py-24 px-6 relative z-10">
            <div class="max-w-5xl mx-auto">
                <div class="text-center mb-12">
                    <span class="text-neon text-xs font-medium tracking-[0.2em] uppercase mb-2 block">How It Works</span>
                    <h2 class="text-3xl md:text-4xl font-medium tracking-tight text-white">
                        From Tokens to Commercial<span class="text-neon">.</span>
                    </h2>
                </div>

                <!-- Step Navigation -->
                <div class="flex justify-center gap-4 mb-8">
                    <button onclick="showExplainerStep(1)" id="step-btn-1" class="step-btn px-6 py-3 bg-neon/20 border border-neon/50 text-neon text-xs font-mono tracking-widest rounded-full transition-all">
                        STEP 01
                    </button>
                    <button onclick="showExplainerStep(2)" id="step-btn-2" class="step-btn px-6 py-3 bg-white/5 border border-white/20 text-white/50 text-xs font-mono tracking-widest rounded-full transition-all hover:text-white">
                        STEP 02
                    </button>
                    <button onclick="showExplainerStep(3)" id="step-btn-3" class="step-btn px-6 py-3 bg-white/5 border border-white/20 text-white/50 text-xs font-mono tracking-widest rounded-full transition-all hover:text-white">
                        STEP 03
                    </button>
                </div>

                <!-- Step Content Container -->
                <div class="relative min-h-[300px]">
                    <!-- Step 1: Generate Scenes -->
                    <div id="explainer-step-1" class="explainer-step transition-all duration-500">
                        <div class="text-center mb-6">
                            <h3 class="text-xl font-semibold text-white mb-2">Generate 8 Cinematic Scenes</h3>
                            <p class="text-sm text-white/50">Each token creates one 8-second AI-generated scene</p>
                        </div>
                        <div class="grid grid-cols-4 md:grid-cols-8 gap-3">
                            <div class="aspect-square bg-white/5 border border-neon/30 rounded-lg flex items-center justify-center group hover:border-neon/60 transition-all">
                                <div class="text-center">
                                    <span class="text-neon text-lg"></span>
                                    <p class="text-[10px] text-white/40 mt-1">8s</p>
                                </div>
                            </div>
                            <div class="aspect-square bg-white/5 border border-neon/30 rounded-lg flex items-center justify-center group hover:border-neon/60 transition-all">
                                <div class="text-center">
                                    <span class="text-neon text-lg"></span>
                                    <p class="text-[10px] text-white/40 mt-1">8s</p>
                                </div>
                            </div>
                            <div class="aspect-square bg-white/5 border border-neon/30 rounded-lg flex items-center justify-center group hover:border-neon/60 transition-all">
                                <div class="text-center">
                                    <span class="text-neon text-lg"></span>
                                    <p class="text-[10px] text-white/40 mt-1">8s</p>
                                </div>
                            </div>
                            <div class="aspect-square bg-white/5 border border-neon/30 rounded-lg flex items-center justify-center group hover:border-neon/60 transition-all">
                                <div class="text-center">
                                    <span class="text-neon text-lg"></span>
                                    <p class="text-[10px] text-white/40 mt-1">8s</p>
                                </div>
                            </div>
                            <div class="aspect-square bg-white/5 border border-neon/30 rounded-lg flex items-center justify-center group hover:border-neon/60 transition-all">
                                <div class="text-center">
                                    <span class="text-neon text-lg"></span>
                                    <p class="text-[10px] text-white/40 mt-1">8s</p>
                                </div>
                            </div>
                            <div class="aspect-square bg-white/5 border border-neon/30 rounded-lg flex items-center justify-center group hover:border-neon/60 transition-all">
                                <div class="text-center">
                                    <span class="text-neon text-lg"></span>
                                    <p class="text-[10px] text-white/40 mt-1">8s</p>
                                </div>
                            </div>
                            <div class="aspect-square bg-white/5 border border-neon/30 rounded-lg flex items-center justify-center group hover:border-neon/60 transition-all">
                                <div class="text-center">
                                    <span class="text-neon text-lg"></span>
                                    <p class="text-[10px] text-white/40 mt-1">8s</p>
                                </div>
                            </div>
                            <div class="aspect-square bg-white/5 border border-neon/30 rounded-lg flex items-center justify-center group hover:border-neon/60 transition-all">
                                <div class="text-center">
                                    <span class="text-neon text-lg"></span>
                                    <p class="text-[10px] text-white/40 mt-1">8s</p>
                                </div>
                            </div>
                        </div>
                        <p class="text-center text-xs text-white/30 mt-4 font-mono">8 TOKENS CONSUMED</p>
                    </div>

                    <!-- Step 2: VORTEX Assembly -->
                    <div id="explainer-step-2" class="explainer-step hidden transition-all duration-500">
                        <div class="text-center mb-6">
                            <h3 class="text-xl font-semibold text-white mb-2">VORTEX Assembly Pipeline</h3>
                            <p class="text-sm text-white/50">AI upscaling, color grading, beat-sync, transitions</p>
                        </div>
                        <div class="flex justify-center">
                            <div class="relative w-64 h-64">
                                <!-- Outer spinning ring -->
                                <div class="absolute inset-0 rounded-full border-2 border-dashed border-neon/30 animate-spin-slow"></div>
                                <!-- Middle ring -->
                                <div class="absolute inset-4 rounded-full border border-neon/50 animate-spin-slow" style="animation-direction: reverse; animation-duration: 4s;"></div>
                                <!-- Inner ring -->
                                <div class="absolute inset-8 rounded-full border border-neon animate-spin-slow" style="animation-duration: 2s;"></div>
                                <!-- Center -->
                                <div class="absolute inset-12 rounded-full bg-neon/20 flex items-center justify-center">
                                    <div class="text-center">
                                        <span class="text-3xl"></span>
                                        <p class="text-[10px] text-neon mt-1 font-mono">VORTEX</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <p class="text-center text-xs text-white/30 mt-4 font-mono">PROCESSING 8 SCENES...</p>
                    </div>

                    <!-- Step 3: Final Output -->
                    <div id="explainer-step-3" class="explainer-step hidden transition-all duration-500">
                        <div class="text-center mb-6">
                            <h3 class="text-xl font-semibold text-white mb-2">64-Second Master Commercial</h3>
                            <p class="text-sm text-white/50">Ready for broadcast across all platforms</p>
                        </div>
                        <div class="max-w-md mx-auto">
                            <div class="bg-white/5 border border-neon/50 rounded-xl p-6 text-center">
                                <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-neon/20 border border-neon flex items-center justify-center">
                                    <span class="text-2xl"></span>
                                </div>
                                <h4 class="text-lg font-semibold text-white mb-2">your_brand_commercial.mp4</h4>
                                <p class="text-sm text-white/50 mb-4">64 seconds  4K  Broadcast Ready</p>
                                <div class="w-full h-2 bg-white/10 rounded-full overflow-hidden">
                                    <div class="h-full bg-gradient-to-r from-neon to-brand-gold w-full"></div>
                                </div>
                                <p class="text-xs text-neon mt-2 font-mono">COMPLETE</p>
                            </div>
                        </div>
                        <div class="flex justify-center gap-4 mt-6">
                            <span class="px-3 py-1 bg-white/5 rounded text-xs text-white/40">9:16 Vertical</span>
                            <span class="px-3 py-1 bg-white/5 rounded text-xs text-white/40">16:9 Horizontal</span>
                            <span class="px-3 py-1 bg-white/5 rounded text-xs text-white/40">1:1 Square</span>
                            <span class="px-3 py-1 bg-white/5 rounded text-xs text-white/40">4:5 Feed</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========== TRIAL OPTION SECTION ========== -->
        <section id="trial" class="w-full py-24 px-6 relative z-10">
            <div class="max-w-2xl mx-auto">
                <div class="relative p-8 rounded-2xl bg-white/5 border border-white/10 backdrop-blur-sm overflow-hidden group hover:border-neon/50 transition-all">
                    <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neon to-transparent opacity-50"></div>
                    <div class="text-center">
                        <span class="text-neon text-xs font-medium tracking-[0.2em] uppercase mb-4 block">Not Ready for Monthly?</span>
                        <h3 class="text-2xl md:text-3xl font-semibold text-white mb-2">
                            Run a Single Lab Test<span class="text-neon">.</span>
                        </h3>
                        <div class="flex items-baseline justify-center gap-2 mb-6">
                            <span class="text-4xl font-bold text-white">$500</span>
                            <span class="text-white/40">one-time</span>
                        </div>
                        <ul class="text-left max-w-sm mx-auto space-y-3 mb-8">
                            <li class="flex items-start gap-2 text-sm text-white/60">
                                <span class="text-neon mt-0.5"></span>
                                <span>1 64-second commercial (8 scenes assembled)</span>
                            </li>
                            <li class="flex items-start gap-2 text-sm text-white/60">
                                <span class="text-neon mt-0.5"></span>
                                <span>1 export format (9:16 OR 16:9)</span>
                            </li>
                            <li class="flex items-start gap-2 text-sm text-white/60">
                                <span class="text-neon mt-0.5"></span>
                                <span>0-1 light revision</span>
                            </li>
                            <li class="flex items-start gap-2 text-sm text-white/30">
                                <span class="mt-0.5"></span>
                                <span>No clone/avatar setup</span>
                            </li>
                            <li class="flex items-start gap-2 text-sm text-white/30">
                                <span class="mt-0.5"></span>
                                <span>Standard queue (slower turnaround)</span>
                            </li>
                        </ul>
                        <button onclick="scrollToSection('chat')" class="px-8 py-4 bg-white/10 border border-neon/50 text-neon text-sm font-bold rounded-lg hover:bg-neon hover:text-black transition-all">
                            Run the $500 Test
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========== ADD-ONS SECTION ========== -->
        <section id="addons" class="w-full py-24 px-6 relative z-10">
            <div class="max-w-7xl mx-auto">
                <div class="text-center mb-12">
                    <span class="text-neon text-xs font-medium tracking-[0.2em] uppercase mb-2 block">Enhance Your Production</span>
                    <h2 class="text-3xl md:text-4xl font-medium tracking-tight text-white">
                        Add-Ons & Token Packs<span class="text-neon">.</span>
                    </h2>
                </div>

                <!-- Clones/Identity Category -->
                <div class="mb-12">
                    <h3 class="text-xs font-mono tracking-widest text-brand-gold mb-4 uppercase">Clones & Identity</h3>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="p-4 rounded-xl bg-white/5 border border-brand-gold/30 hover:border-brand-gold/60 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-white font-medium">Voice Clone Setup</span>
                                <span class="text-brand-gold font-mono">$299</span>
                            </div>
                            <p class="text-xs text-white/40">One-time setup for your custom voice</p>
                        </div>
                        <div class="p-4 rounded-xl bg-white/5 border border-brand-gold/30 hover:border-brand-gold/60 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-white font-medium">Avatar Clone Setup</span>
                                <span class="text-brand-gold font-mono">$1,499</span>
                            </div>
                            <p class="text-xs text-white/40">One-time AI avatar training</p>
                        </div>
                        <div class="p-4 rounded-xl bg-white/5 border border-brand-gold/30 hover:border-brand-gold/60 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-white font-medium">Additional Avatar</span>
                                <span class="text-brand-gold font-mono">$999</span>
                            </div>
                            <p class="text-xs text-white/40">Each additional AI avatar</p>
                        </div>
                        <div class="p-4 rounded-xl bg-white/5 border border-brand-gold/30 hover:border-brand-gold/60 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-white font-medium">Voice + Avatar Bundle</span>
                                <span class="text-brand-gold font-mono">$1,599</span>
                            </div>
                            <p class="text-xs text-white/40">Save $199 with bundle</p>
                        </div>
                    </div>
                </div>

                <!-- Rush/Priority Category -->
                <div class="mb-12">
                    <h3 class="text-xs font-mono tracking-widest text-neon mb-4 uppercase">Rush & Priority</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="p-4 rounded-xl bg-white/5 border border-neon/30 hover:border-neon/60 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-white font-medium">Rush Delivery</span>
                                <span class="text-neon font-mono">$249</span>
                            </div>
                            <p class="text-xs text-white/40">Skip to front of queue</p>
                        </div>
                        <div class="p-4 rounded-xl bg-white/5 border border-neon/30 hover:border-neon/60 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-white font-medium">48-Hour Priority Queue</span>
                                <span class="text-neon font-mono">$399</span>
                            </div>
                            <p class="text-xs text-white/40">Guaranteed 48-hour delivery</p>
                        </div>
                    </div>
                </div>

                <!-- Token Packs Category -->
                <div class="mb-12">
                    <h3 class="text-xs font-mono tracking-widest text-neon mb-4 uppercase">Token Packs</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="p-4 rounded-xl bg-white/5 border border-neon/30 hover:border-neon/60 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-white font-medium">8 Tokens Pack</span>
                                <span class="text-neon font-mono">$449</span>
                            </div>
                            <p class="text-xs text-white/40">1 additional commercial</p>
                        </div>
                        <div class="p-4 rounded-xl bg-white/5 border border-neon/30 hover:border-neon/60 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-white font-medium">16 Tokens Pack</span>
                                <span class="text-neon font-mono">$799</span>
                            </div>
                            <p class="text-xs text-white/40">2 additional commercials</p>
                        </div>
                        <div class="p-4 rounded-xl bg-white/5 border border-neon/30 hover:border-neon/60 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-white font-medium">32 Tokens Pack</span>
                                <span class="text-neon font-mono">$1,499</span>
                            </div>
                            <p class="text-xs text-white/40">4 additional commercials</p>
                        </div>
                    </div>
                </div>

                <!-- Extras Category -->
                <div>
                    <h3 class="text-xs font-mono tracking-widest text-neon mb-4 uppercase">Extras</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="p-4 rounded-xl bg-white/5 border border-neon/30 hover:border-neon/60 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-white font-medium">Extra Revision Pack</span>
                                <span class="text-neon font-mono">$149</span>
                            </div>
                            <p class="text-xs text-white/40">2 additional revision passes</p>
                        </div>
                        <div class="p-4 rounded-xl bg-white/5 border border-neon/30 hover:border-neon/60 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-white font-medium">Variant Pack</span>
                                <span class="text-neon font-mono">8 tokens + $99</span>
                            </div>
                            <p class="text-xs text-white/40">Same commercial, new hooks/variations</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========== INTAKE CHECKLIST SECTION ========== -->
        <section id="checklist" class="w-full py-24 px-6 relative z-10">
            <div class="max-w-7xl mx-auto">
                <div class="text-center mb-12">
                    <span class="text-neon text-xs font-medium tracking-[0.2em] uppercase mb-2 block">What You'll Provide</span>
                    <h2 class="text-3xl md:text-4xl font-medium tracking-tight text-white">
                        Client Intake Checklist<span class="text-neon">.</span>
                    </h2>
                </div>

                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Brand DNA -->
                    <div class="p-6 rounded-2xl bg-white/5 border border-neon/30 hover:border-neon/50 transition-all">
                        <div class="w-12 h-12 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center mb-4">
                            <span class="text-xl"></span>
                        </div>
                        <h3 class="text-lg font-semibold text-white mb-2">Brand DNA</h3>
                        <ul class="space-y-2 text-sm text-white/50">
                            <li> Business name & URL</li>
                            <li> Logo (high-res)</li>
                            <li> Style guide (if available)</li>
                            <li> Brand colors</li>
                        </ul>
                    </div>

                    <!-- The Mission -->
                    <div class="p-6 rounded-2xl bg-white/5 border border-neon/30 hover:border-neon/50 transition-all">
                        <div class="w-12 h-12 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center mb-4">
                            <span class="text-xl"></span>
                        </div>
                        <h3 class="text-lg font-semibold text-white mb-2">The Mission</h3>
                        <ul class="space-y-2 text-sm text-white/50">
                            <li> Campaign goal</li>
                            <li> Target audience</li>
                            <li> Geographic focus</li>
                            <li> Key message</li>
                        </ul>
                    </div>

                    <!-- Creative Intel -->
                    <div class="p-6 rounded-2xl bg-white/5 border border-neon/30 hover:border-neon/50 transition-all">
                        <div class="w-12 h-12 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center mb-4">
                            <span class="text-xl"></span>
                        </div>
                        <h3 class="text-lg font-semibold text-white mb-2">Creative Intel</h3>
                        <ul class="space-y-2 text-sm text-white/50">
                            <li> Product description</li>
                            <li> Must-say lines</li>
                            <li> Competitor references</li>
                            <li> Preferred tone</li>
                        </ul>
                    </div>

                    <!-- Identity Assets (Tier 2+) -->
                    <div class="p-6 rounded-2xl bg-white/5 border border-brand-gold/30 hover:border-brand-gold/50 transition-all relative">
                        <div class="absolute top-4 right-4 px-2 py-1 bg-brand-gold/20 border border-brand-gold/50 rounded text-[10px] text-brand-gold font-mono">TIER 2+</div>
                        <div class="w-12 h-12 rounded-lg bg-brand-gold/10 border border-brand-gold/30 flex items-center justify-center mb-4">
                            <span class="text-xl"></span>
                        </div>
                        <h3 class="text-lg font-semibold text-white mb-2">Identity Assets</h3>
                        <ul class="space-y-2 text-sm text-white/50">
                            <li> Voice sample (30-60s)</li>
                            <li> Avatar photos (front/side)</li>
                            <li> Video reference footage</li>
                            <li> Consent documentation</li>
                        </ul>
                    </div>

                    <!-- Technical Specs -->
                    <div class="p-6 rounded-2xl bg-white/5 border border-neon/30 hover:border-neon/50 transition-all">
                        <div class="w-12 h-12 rounded-lg bg-neon/10 border border-neon/30 flex items-center justify-center mb-4">
                            <span class="text-xl"></span>
                        </div>
                        <h3 class="text-lg font-semibold text-white mb-2">Technical Specs</h3>
                        <ul class="space-y-2 text-sm text-white/50">
                            <li> Platform priority</li>
                            <li> Format preference</li>
                            <li> B-roll (optional)</li>
                            <li> Music preference</li>
                        </ul>
                    </div>

                    <!-- CTA Card -->
                    <div class="p-6 rounded-2xl bg-neon/10 border border-neon/50 hover:border-neon transition-all flex flex-col justify-center text-center">
                        <h3 class="text-lg font-semibold text-white mb-2">Ready to Start?</h3>
                        <p class="text-sm text-white/50 mb-4">Our AI will guide you through each step</p>
                        <button onclick="scrollToSection('chat')" class="px-6 py-3 bg-neon text-black text-sm font-bold rounded-lg hover:bg-white transition-all">
                            Open Intake Portal
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========== FAQ SECTION ========== -->
        <section id="faq" class="w-full py-24 px-6 relative z-10">
            <div class="max-w-3xl mx-auto">
                <div class="text-center mb-12">
                    <span class="text-neon text-xs font-medium tracking-[0.2em] uppercase mb-2 block">Questions</span>
                    <h2 class="text-3xl md:text-4xl font-medium tracking-tight text-white">
                        Frequently Asked<span class="text-neon">.</span>
                    </h2>
                </div>

                <div class="space-y-4">
                    <!-- FAQ 1 -->
                    <div class="border border-white/10 rounded-xl overflow-hidden">
                        <button onclick="toggleFaq(1)" class="w-full px-6 py-4 flex items-center justify-between text-left hover:bg-white/5 transition-all">
                            <span class="text-white font-medium">Why 64 seconds instead of 60?</span>
                            <i data-lucide="chevron-down" id="faq-icon-1" class="w-5 h-5 text-neon transition-transform" stroke-width="1.5"></i>
                        </button>
                        <div id="faq-answer-1" class="hidden px-6 pb-4">
                            <p class="text-sm text-white/50">Our 8-beat structure uses 8 8-second scenes for optimal retention markers. This creates natural pacing that holds viewer attention longer than arbitrary 60-second cuts.</p>
                        </div>
                    </div>

                    <!-- FAQ 2 -->
                    <div class="border border-white/10 rounded-xl overflow-hidden">
                        <button onclick="toggleFaq(2)" class="w-full px-6 py-4 flex items-center justify-between text-left hover:bg-white/5 transition-all">
                            <span class="text-white font-medium">Why 8-second scenes?</span>
                            <i data-lucide="chevron-down" id="faq-icon-2" class="w-5 h-5 text-neon transition-transform" stroke-width="1.5"></i>
                        </button>
                        <div id="faq-answer-2" class="hidden px-6 pb-4">
                            <p class="text-sm text-white/50">Veo 3.1 and similar AI video models produce peak quality in 8-second bursts with zero degradation. Longer generations lose coherence; shorter ones waste compute.</p>
                        </div>
                    </div>

                    <!-- FAQ 3 -->
                    <div class="border border-white/10 rounded-xl overflow-hidden">
                        <button onclick="toggleFaq(3)" class="w-full px-6 py-4 flex items-center justify-between text-left hover:bg-white/5 transition-all">
                            <span class="text-white font-medium">What is 'VORTEX Assembly'?</span>
                            <i data-lucide="chevron-down" id="faq-icon-3" class="w-5 h-5 text-neon transition-transform" stroke-width="1.5"></i>
                        </button>
                        <div id="faq-answer-3" class="hidden px-6 pb-4">
                            <p class="text-sm text-white/50">VORTEX is our proprietary post-production pipeline: AI upscaling, professional color grading, beat-synchronized transitions, and audio mixing. It transforms raw scenes into broadcast-ready commercials.</p>
                        </div>
                    </div>

                    <!-- FAQ 4 -->
                    <div class="border border-white/10 rounded-xl overflow-hidden">
                        <button onclick="toggleFaq(4)" class="w-full px-6 py-4 flex items-center justify-between text-left hover:bg-white/5 transition-all">
                            <span class="text-white font-medium">How do tokens work and do they roll over?</span>
                            <i data-lucide="chevron-down" id="faq-icon-4" class="w-5 h-5 text-neon transition-transform" stroke-width="1.5"></i>
                        </button>
                        <div id="faq-answer-4" class="hidden px-6 pb-4">
                            <p class="text-sm text-white/50">1 Token = 1 8-second scene. 8 Tokens = 1 64-second commercial. Tokens reset at your billing cycleno rollover. Use them or lose them encourages consistent content creation.</p>
                        </div>
                    </div>

                    <!-- FAQ 5 -->
                    <div class="border border-white/10 rounded-xl overflow-hidden">
                        <button onclick="toggleFaq(5)" class="w-full px-6 py-4 flex items-center justify-between text-left hover:bg-white/5 transition-all">
                            <span class="text-white font-medium">What's included in the Clone Setup?</span>
                            <i data-lucide="chevron-down" id="faq-icon-5" class="w-5 h-5 text-neon transition-transform" stroke-width="1.5"></i>
                        </button>
                        <div id="faq-answer-5" class="hidden px-6 pb-4">
                            <p class="text-sm text-white/50">One-time voice training (from 30-60s sample) and/or avatar training (from photos/video). Once trained, your clone is available for all future commercials at no additional cost.</p>
                        </div>
                    </div>

                    <!-- FAQ 6 -->
                    <div class="border border-white/10 rounded-xl overflow-hidden">
                        <button onclick="toggleFaq(6)" class="w-full px-6 py-4 flex items-center justify-between text-left hover:bg-white/5 transition-all">
                            <span class="text-white font-medium">Can I cancel anytime?</span>
                            <i data-lucide="chevron-down" id="faq-icon-6" class="w-5 h-5 text-neon transition-transform" stroke-width="1.5"></i>
                        </button>
                        <div id="faq-answer-6" class="hidden px-6 pb-4">
                            <p class="text-sm text-white/50">Yes. No contracts, no commitments. Pause or cancel anytime via Command Center. You keep access until the end of your billing period.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========== FINAL CTA STRIP ========== -->
        <section id="final-cta" class="w-full py-24 px-6 relative z-10">
            <div class="max-w-4xl mx-auto">
                <div class="relative p-8 md:p-12 rounded-3xl bg-white/5 border border-neon/30 backdrop-blur-sm overflow-hidden">
                    <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neon to-transparent"></div>
                    <div class="absolute -top-24 -right-24 w-96 h-96 bg-neon/10 rounded-full blur-3xl pointer-events-none"></div>

                    <div class="text-center relative z-10">
                        <span class="inline-block px-4 py-1 bg-brand-gold/20 border border-brand-gold/50 text-brand-gold text-xs font-mono tracking-widest rounded-full mb-6">LIMITED MONTHLY SLOTS AVAILABLE</span>

                        <h2 class="text-3xl md:text-5xl font-semibold tracking-tight text-white mb-4">
                            Pick a tier<span class="text-neon">.</span> Get your first commercial in motion<span class="text-neon">.</span>
                        </h2>

                        <p class="text-base text-white/50 max-w-xl mx-auto mb-8">
                            VORTEX engine standing by. Elite brands are already shipping. Your move.
                        </p>

                        <div class="flex flex-col sm:flex-row gap-4 justify-center mb-8">
                            <button onclick="scrollToSection('pricing')" class="px-8 py-4 bg-neon text-black text-sm font-bold rounded-lg hover:bg-white transition-all shadow-[0_0_30px_rgba(0,206,209,0.3)]">
                                Start Monthly 
                            </button>
                            <button onclick="scrollToSection('trial')" class="px-8 py-4 bg-transparent border border-white/30 text-white text-sm font-medium rounded-lg hover:border-neon/50 hover:text-neon transition-all">
                                Run the $500 Test
                            </button>
                        </div>

                        <!-- Platform Badges -->
                        <div class="flex flex-wrap justify-center gap-4 mb-6">
                            <span class="px-3 py-1 bg-white/5 border border-white/10 rounded text-xs text-white/40">Meta</span>
                            <span class="px-3 py-1 bg-white/5 border border-white/10 rounded text-xs text-white/40">TikTok</span>
                            <span class="px-3 py-1 bg-white/5 border border-white/10 rounded text-xs text-white/40">YouTube</span>
                            <span class="px-3 py-1 bg-white/5 border border-white/10 rounded text-xs text-white/40">Snapchat</span>
                            <span class="px-3 py-1 bg-white/5 border border-white/10 rounded text-xs text-white/40">X</span>
                        </div>

                        <p class="text-xs text-white/30 font-mono">Built for performance  Scaled by Barrios A2I</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========== UNIFIED FOOTER ========== -->
        <footer class="relative w-full bg-[#050508] pt-16 md:pt-24 pb-8 md:pb-12 px-4 md:px-6 border-t border-white/5 overflow-hidden">
    <!-- Volumetric Glow Background -->
    <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-[800px] h-[200px] bg-[#00CED1]/5 blur-[100px] rounded-full pointer-events-none"></div>

    <!-- Subtle Grid Pattern -->
    <div class="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.02)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.02)_1px,transparent_1px)] bg-[size:32px_32px] opacity-30 pointer-events-none"></div>

    <div class="max-w-7xl mx-auto relative z-10">

        <!-- Top Section: Brand + Tagline + Status -->
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-12 md:mb-16 pb-8 md:pb-12 border-b border-white/5">
            <!-- Brand Block -->
            <div class="group">
                <a href="/" class="flex items-center gap-3 mb-3">
                    <img src="/brand/barrios-a2i-shard-logo.png" alt="Barrios A2I" class="w-10 h-10 md:w-12 md:h-12 object-contain opacity-90 group-hover:opacity-100 transition-opacity">
                    <h2 class="text-2xl md:text-3xl font-black tracking-tighter text-white transition-colors group-hover:text-[#00CED1]">
                        BARRIOS <span class="text-[#FFD700]">A2I</span>
                    </h2>
                </a>
                <p class="text-[#94a3b8] font-mono text-[10px] md:text-xs tracking-[0.2em] uppercase">
                    The Intelligence Architecture
                </p>
            </div>

            <!-- System Status Indicator -->
            <div class="flex items-center gap-3 px-4 py-2 bg-white/[0.03] backdrop-blur-sm border border-white/5 rounded-lg">
                <span class="relative flex h-2.5 w-2.5">
                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                    <span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-emerald-500"></span>
                </span>
                <span class="font-mono text-[10px] md:text-xs text-emerald-400 tracking-wider uppercase">All Systems Operational</span>
            </div>
        </div>

        <!-- Navigation Grid -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-8 md:gap-12 mb-12 md:mb-16">

            <!-- Products Column -->
            <div>
                <h4 class="font-mono text-[10px] md:text-xs text-[#00CED1] tracking-[0.15em] uppercase mb-4 md:mb-6 flex items-center gap-2">
                    <span class="text-[#00CED1]/40">[</span>
                    Products
                    <span class="text-[#00CED1]/40">]</span>
                </h4>
                <ul class="space-y-3">
                    <li>
                        <a href="/nexus-personal" class="text-sm text-[#94a3b8] hover:text-white transition-colors duration-200 flex items-center gap-2 group">
                            <span class="w-1 h-1 bg-[#00CED1]/50 rounded-full group-hover:bg-[#00CED1] transition-colors"></span>
                            NEXUS Personal
                        </a>
                    </li>
                    <li>
                        <a href="/creative-director" class="text-sm text-[#94a3b8] hover:text-white transition-colors duration-200 flex items-center gap-2 group">
                            <span class="w-1 h-1 bg-[#00CED1]/50 rounded-full group-hover:bg-[#00CED1] transition-colors"></span>
                            A2I Commercial Lab
                        </a>
                    </li>
                    <li>
                        <a href="/command-center" class="text-sm text-[#94a3b8] hover:text-white transition-colors duration-200 flex items-center gap-2 group">
                            <span class="w-1 h-1 bg-[#00CED1]/50 rounded-full group-hover:bg-[#00CED1] transition-colors"></span>
                            Command Center
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Company Column -->
            <div>
                <h4 class="font-mono text-[10px] md:text-xs text-[#00CED1] tracking-[0.15em] uppercase mb-4 md:mb-6 flex items-center gap-2">
                    <span class="text-[#00CED1]/40">[</span>
                    Company
                    <span class="text-[#00CED1]/40">]</span>
                </h4>
                <ul class="space-y-3">
                    <li>
                        <a href="/#about" class="text-sm text-[#94a3b8] hover:text-white transition-colors duration-200 flex items-center gap-2 group">
                            <span class="w-1 h-1 bg-[#00CED1]/50 rounded-full group-hover:bg-[#00CED1] transition-colors"></span>
                            About
                        </a>
                    </li>
                    <li>
                        <a href="/contact" class="text-sm text-[#94a3b8] hover:text-white transition-colors duration-200 flex items-center gap-2 group">
                            <span class="w-1 h-1 bg-[#00CED1]/50 rounded-full group-hover:bg-[#00CED1] transition-colors"></span>
                            Contact
                        </a>
                    </li>
                    <li>
                        <a href="/status" class="text-sm text-[#94a3b8] hover:text-white transition-colors duration-200 flex items-center gap-2 group">
                            <span class="w-1 h-1 bg-[#00CED1]/50 rounded-full group-hover:bg-[#00CED1] transition-colors"></span>
                            System Status
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Legal Column -->
            <div>
                <h4 class="font-mono text-[10px] md:text-xs text-[#00CED1] tracking-[0.15em] uppercase mb-4 md:mb-6 flex items-center gap-2">
                    <span class="text-[#00CED1]/40">[</span>
                    Legal
                    <span class="text-[#00CED1]/40">]</span>
                </h4>
                <ul class="space-y-3">
                    <li>
                        <a href="/privacy-directive" class="text-sm text-[#94a3b8] hover:text-white transition-colors duration-200 flex items-center gap-2 group">
                            <span class="w-1 h-1 bg-[#00CED1]/50 rounded-full group-hover:bg-[#00CED1] transition-colors"></span>
                            Privacy Directive
                        </a>
                    </li>
                    <li>
                        <a href="/terms-of-service" class="text-sm text-[#94a3b8] hover:text-white transition-colors duration-200 flex items-center gap-2 group">
                            <span class="w-1 h-1 bg-[#00CED1]/50 rounded-full group-hover:bg-[#00CED1] transition-colors"></span>
                            Terms of Service
                        </a>
                    </li>
                    <li>
                        <a href="/data-sovereignty" class="text-sm text-[#94a3b8] hover:text-white transition-colors duration-200 flex items-center gap-2 group">
                            <span class="w-1 h-1 bg-[#00CED1]/50 rounded-full group-hover:bg-[#00CED1] transition-colors"></span>
                            Data Sovereignty
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Connect Column -->
            <div>
                <h4 class="font-mono text-[10px] md:text-xs text-[#00CED1] tracking-[0.15em] uppercase mb-4 md:mb-6 flex items-center gap-2">
                    <span class="text-[#00CED1]/40">[</span>
                    Connect
                    <span class="text-[#00CED1]/40">]</span>
                </h4>
                <!-- Social Icons -->
                <div class="flex items-center gap-4 mb-6">
                    <a href="https://linkedin.com/company/barriosa2i" target="_blank" rel="noopener"
                       class="w-9 h-9 flex items-center justify-center rounded-lg bg-white/[0.03] border border-white/5 text-[#94a3b8] hover:text-[#00CED1] hover:border-[#00CED1]/30 hover:bg-[#00CED1]/5 transition-all duration-200">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                    </a>
                    <a href="https://twitter.com/barriosa2i" target="_blank" rel="noopener"
                       class="w-9 h-9 flex items-center justify-center rounded-lg bg-white/[0.03] border border-white/5 text-[#94a3b8] hover:text-[#00CED1] hover:border-[#00CED1]/30 hover:bg-[#00CED1]/5 transition-all duration-200">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                    </a>
                    <a href="https://instagram.com/barriosa2i" target="_blank" rel="noopener"
                       class="w-9 h-9 flex items-center justify-center rounded-lg bg-white/[0.03] border border-white/5 text-[#94a3b8] hover:text-[#00CED1] hover:border-[#00CED1]/30 hover:bg-[#00CED1]/5 transition-all duration-200">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>
                    </a>
                </div>
                <!-- Email -->
                <a href="mailto:alienation2innovation@gmail.com" class="text-sm text-[#94a3b8] hover:text-[#00CED1] transition-colors duration-200 font-mono">
                    alienation2innovation@gmail.com
                </a>
            </div>
        </div>

        <!-- Bottom Bar: Copyright -->
        <div class="flex flex-col md:flex-row justify-between items-center gap-4 pt-8 border-t border-white/5">
            <p class="font-mono text-[10px] md:text-xs text-[#64748b] tracking-wider">
                &copy; <span id="footer-year-cd">2025</span> BARRIOS A2I INC. ALL RIGHTS RESERVED.
            </p>
            <div class="flex items-center gap-6">
                <a href="/privacy-directive" class="font-mono text-[10px] md:text-xs text-[#64748b] hover:text-white transition-colors">Privacy</a>
                <a href="/terms-of-service" class="font-mono text-[10px] md:text-xs text-[#64748b] hover:text-white transition-colors">Terms</a>
                <a href="/data-sovereignty" class="font-mono text-[10px] md:text-xs text-[#64748b] hover:text-white transition-colors">Data</a>
            </div>
        </div>
    </div>
</footer>

<!-- Update year dynamically -->
<script>
    (function() {
        const yearEl = document.getElementById('footer-year-cd');
        if (yearEl) yearEl.textContent = new Date().getFullYear();
    })();
</script>
    </main>

    <!-- Three.js Background -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.4/ScrollTrigger.min.js"></script>

    <script type="module">
        import * as THREE from 'three';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

        lucide.createIcons();

        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x050505, 0.02);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 5;

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.toneMapping = THREE.ReinhardToneMapping;
        container.appendChild(renderer.domElement);

        const renderScene = new RenderPass(scene, camera);
        const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
        bloomPass.threshold = 0;
        bloomPass.strength = 2.0;
        bloomPass.radius = 0.5;

        const composer = new EffectComposer(renderer);
        composer.addPass(renderScene);
        composer.addPass(bloomPass);

        const logoGroup = new THREE.Group();
        const material = new THREE.MeshStandardMaterial({ color: 0x111111, metalness: 1.0, roughness: 0.1, emissive: 0x004444, emissiveIntensity: 0.2 });
        const edgeMaterial = new THREE.MeshBasicMaterial({ color: 0x00F3FF });
        const geometry = new THREE.SphereGeometry(1.2, 32, 32);
        const mesh = new THREE.Mesh(geometry, material);
        const wireframe = new THREE.LineSegments(new THREE.EdgesGeometry(geometry), edgeMaterial);
        mesh.add(wireframe);
        logoGroup.add(mesh);
        scene.add(logoGroup);

        const ambientLight = new THREE.AmbientLight(0x404040, 0.5);
        scene.add(ambientLight);

        const spotlight1 = new THREE.SpotLight(0x00F3FF, 50);
        spotlight1.position.set(5, 5, 5);
        spotlight1.angle = 0.3;
        spotlight1.penumbra = 0.5;
        scene.add(spotlight1);

        const spotlight2 = new THREE.SpotLight(0xffffff, 10);
        spotlight2.position.set(-5, 5, 5);
        spotlight2.angle = 0.5;
        scene.add(spotlight2);

        const particlesGeometry = new THREE.BufferGeometry();
        const particlesCount = 2000;
        const posArray = new Float32Array(particlesCount * 3);
        for(let i = 0; i < particlesCount * 3; i++) { posArray[i] = (Math.random() - 0.5) * 20; }
        particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        const particlesMaterial = new THREE.PointsMaterial({ size: 0.05, color: 0xffffff, transparent: true, opacity: 0.8 });
        const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
        particlesMesh.position.y = -5;
        scene.add(particlesMesh);

        function animate() {
            requestAnimationFrame(animate);
            const time = Date.now() * 0.002;
            const scale = 1 + Math.sin(time * 2) * 0.02;
            logoGroup.scale.set(scale, scale, scale);
            logoGroup.rotation.y += 0.002;
            const positions = particlesGeometry.attributes.position.array;
            for(let i = 0; i < particlesCount; i++) {
                const x = positions[i * 3];
                positions[i * 3 + 1] = Math.sin(Date.now() * 0.001 + x) * 0.5 - 2;
            }
            particlesGeometry.attributes.position.needsUpdate = true;
            composer.render();
        }
        animate();

        gsap.registerPlugin(ScrollTrigger);
        const tl = gsap.timeline({ scrollTrigger: { trigger: "body", start: "top top", end: "bottom bottom", scrub: 1 } });
        tl.to(logoGroup.position, { z: -10, y: 5, duration: 2 }, 0)
          .to(logoGroup.rotation, { x: 1, duration: 2 }, 0)
          .to(camera.position, { z: 8, duration: 2 }, 0)
          .to(particlesMesh.position, { y: 0, duration: 2 }, 0.5)
          .to(particlesMaterial.color, { r: 0, g: 0.95, b: 1, duration: 1 }, 2)
          .to(camera.rotation, { z: 0.2, duration: 2 }, 2)
          .to(particlesMesh.scale, { x: 2, y: 2, z: 2, duration: 2 }, 4)
          .to(scene.fog, { density: 0.05, duration: 2 }, 4)
          .to(spotlight1, { intensity: 100, angle: 0.1, duration: 2 }, 6)
          .to(bloomPass, { strength: 3, radius: 1, duration: 2 }, 6);

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            composer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>

    <!-- Chat API Integration with 6-Agent Pipeline -->
    <script>
        const API_URL = 'https://barrios-genesis-flawless.onrender.com';

        // Payment link (direct redirect, no API needed)
        const PAYMENT_LINK = 'https://buy.stripe.com/00w4gA84Ve498yF27HeME05';

        let sessionId = localStorage.getItem('barrios_creative_director_session');
        let isLoading = false;
        let lastMessage = '';
        let currentPhase = 1;

        // Pipeline state
        let PIPELINE_ENABLED = false;
        let pipelinePhase = 'intake';
        let concepts = [];
        let selectedConceptId = null;
        let currentScript = null;

        const PHASES = ['intake', 'research', 'ideation', 'script', 'review', 'production', 'delivery'];

        async function initSession() {
            try {
                // Try pipeline session first
                const pipelineRes = await fetch(`${API_URL}/api/legendary/session`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({})
                });

                if (pipelineRes.ok) {
                    const data = await pipelineRes.json();
                    sessionId = data.session_id;
                    localStorage.setItem('barrios_creative_director_session', sessionId);
                    PIPELINE_ENABLED = true;

                    // Show pipeline badge and phases
                    document.getElementById('pipeline-badge').classList.remove('hidden');
                    document.getElementById('pipeline-phases').classList.remove('hidden');
                    document.getElementById('status-text').textContent = '6-Agent Pipeline';
                    updatePhaseIndicator('intake');

                    if (data.greeting) {
                        const container = document.getElementById('chat-messages');
                        container.innerHTML = '';
                        addMessage(data.greeting, false, data.quick_actions || []);
                    }

                    console.log(' Pipeline session started:', sessionId);
                    return;
                }
            } catch (e) {
                console.log('Pipeline not available, falling back to basic session');
            }

            // Fallback to basic session
            try {
                const res = await fetch(`${API_URL}/api/session/start`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({})
                });
                if (!res.ok) throw new Error('Session start failed');
                const data = await res.json();
                sessionId = data.session_id;
                localStorage.setItem('barrios_creative_director_session', sessionId);

                if (data.greeting) {
                    const container = document.getElementById('chat-messages');
                    container.innerHTML = '';
                    addMessage(data.greeting, false, data.quick_actions || []);
                }

                if (data.phase) {
                    updateProgress(data.completion_percentage || 0, data.phase, false);
                }
            } catch (e) {
                console.error('Session init error:', e);
                showError('Unable to connect. Please refresh and try again.');
            }
        }

        function focusChatInput() {
            setTimeout(() => {
                document.getElementById('chat-input').focus();
            }, 300);
        }

        function showError(msg) {
            document.getElementById('error-container').classList.remove('hidden');
            document.getElementById('error-message').textContent = msg;
        }

        function hideError() {
            document.getElementById('error-container').classList.add('hidden');
        }

        function addMessage(content, isUser = false, quickActions = []) {
            const container = document.getElementById('chat-messages');
            const msgDiv = document.createElement('div');
            msgDiv.className = 'flex gap-3';

            if (isUser) {
                msgDiv.innerHTML = `
                    <div class="flex-1 p-3 rounded-lg bg-neon/10 border border-neon/30 ml-8">
                        <p class="text-sm text-white">${escapeHtml(content)}</p>
                    </div>
                    <div class="w-8 h-8 rounded-full bg-white/10 border border-white/20 flex items-center justify-center flex-shrink-0">
                        <i data-lucide="user" class="w-4 h-4 text-white/60" stroke-width="1.5"></i>
                    </div>
                `;
            } else {
                msgDiv.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-neon/20 border border-neon/50 flex items-center justify-center flex-shrink-0">
                        <i data-lucide="bot" class="w-4 h-4 text-neon" stroke-width="1.5"></i>
                    </div>
                    <div class="flex-1 p-3 rounded-lg bg-white/5 border border-white/10">
                        <p class="text-sm text-white/80">${escapeHtml(content)}</p>
                    </div>
                `;
            }

            container.appendChild(msgDiv);
            lucide.createIcons();
            container.scrollTop = container.scrollHeight;

            if (quickActions && quickActions.length > 0) {
                renderQuickActions(quickActions);
            } else {
                document.getElementById('quick-actions').classList.add('hidden');
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML.replace(/\n/g, '<br>');
        }

        function addTypingIndicator() {
            const container = document.getElementById('chat-messages');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.className = 'flex gap-3';
            typingDiv.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-neon/20 border border-neon/50 flex items-center justify-center flex-shrink-0">
                    <i data-lucide="bot" class="w-4 h-4 text-neon" stroke-width="1.5"></i>
                </div>
                <div class="flex-1 p-3 rounded-lg bg-white/5 border border-white/10">
                    <div class="typing-indicator flex gap-1">
                        <span class="w-2 h-2 bg-neon/60 rounded-full"></span>
                        <span class="w-2 h-2 bg-neon/60 rounded-full"></span>
                        <span class="w-2 h-2 bg-neon/60 rounded-full"></span>
                    </div>
                </div>
            `;
            container.appendChild(typingDiv);
            lucide.createIcons();
            container.scrollTop = container.scrollHeight;
        }

        function removeTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) indicator.remove();
        }

        function renderQuickActions(actions) {
            const container = document.getElementById('quick-actions');
            container.innerHTML = '';
            container.classList.remove('hidden');

            actions.forEach(action => {
                const btn = document.createElement('button');
                btn.className = 'px-3 py-1.5 text-xs bg-white/5 border border-white/20 rounded-full text-white/70 hover:bg-neon/20 hover:border-neon/50 hover:text-neon transition-all';
                btn.textContent = action;
                btn.onclick = () => {
                    document.getElementById('chat-input').value = action;
                    sendMessage();
                };
                container.appendChild(btn);
            });
        }

        function updateProgress(percentage, phase, isComplete) {
            const bar = document.getElementById('progress-bar');
            const percent = document.getElementById('progress-percent');
            const phaseTag = document.getElementById('phase-tag');
            const status = document.getElementById('completion-status');

            const pct = Math.round(percentage * 100);
            bar.style.width = pct + '%';
            percent.textContent = pct + '%';

            if (phase) {
                currentPhase = phase;
                phaseTag.textContent = 'Phase ' + phase + ' of 10';
            }

            if (isComplete) {
                status.textContent = 'Brief Complete!';
                status.classList.add('text-neon');
                phaseTag.textContent = 'Complete';
            } else {
                const remaining = 10 - (currentPhase || 1);
                status.textContent = remaining + ' phase' + (remaining !== 1 ? 's' : '') + ' remaining';
            }
        }

        async function sendMessage() {
            if (isLoading) return;

            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (!message) return;

            lastMessage = message;
            hideError();

            if (!sessionId) {
                await initSession();
                if (!sessionId) return;
            }

            addMessage(message, true);
            input.value = '';

            isLoading = true;
            document.getElementById('send-btn').disabled = true;
            addTypingIndicator();

            try {
                // Use pipeline or basic endpoint
                const endpoint = PIPELINE_ENABLED
                    ? `${API_URL}/api/legendary/message`
                    : `${API_URL}/api/chat`;

                const res = await fetch(endpoint, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ session_id: sessionId, message })
                });

                if (!res.ok) throw new Error('Chat request failed');

                const data = await res.json();
                removeTypingIndicator();

                addMessage(data.response, false, data.quick_actions || []);

                // Track lead data for FLAWLESS GENESIS qualification
                updateLeadData(data);

                if (PIPELINE_ENABLED) {
                    // Handle pipeline phase transitions
                    if (data.phase) {
                        updatePhaseIndicator(data.phase);
                        pipelinePhase = data.phase;
                    }

                    // Trigger research when intake is complete
                    if (data.is_complete && pipelinePhase === 'intake') {
                        addSystemMessage(' Brief complete! Starting market research...');
                        await runResearchPhase();
                    }
                } else {
                    updateProgress(data.completion_percentage || 0, data.phase, data.is_complete);
                }

            } catch (e) {
                console.error('Chat error:', e);
                removeTypingIndicator();
                showError('Message failed to send. Please try again.');
            } finally {
                isLoading = false;
                document.getElementById('send-btn').disabled = false;
                input.focus();
            }
        }

        function retryLastMessage() {
            if (lastMessage) {
                document.getElementById('chat-input').value = lastMessage;
                sendMessage();
            }
        }

        // ============= PIPELINE PHASE FUNCTIONS =============

        async function runResearchPhase() {
            if (!PIPELINE_ENABLED) return;

            updatePhaseIndicator('research');
            addTypingIndicator();

            try {
                const res = await fetch(`${API_URL}/api/legendary/research/${sessionId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });

                removeTypingIndicator();

                if (res.ok) {
                    const data = await res.json();
                    addSystemMessage(' Research complete! Analyzing market trends...');

                    if (data.insights) {
                        addMessage(data.insights, false);
                    }

                    // Auto-trigger ideation
                    setTimeout(() => runIdeationPhase(), 1000);
                }
            } catch (e) {
                removeTypingIndicator();
                console.error('Research phase error:', e);
            }
        }

        async function runIdeationPhase() {
            if (!PIPELINE_ENABLED) return;

            updatePhaseIndicator('ideation');
            addSystemMessage(' Generating creative concepts...');
            addTypingIndicator();

            try {
                const res = await fetch(`${API_URL}/api/legendary/ideation/${sessionId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });

                removeTypingIndicator();

                if (res.ok) {
                    const data = await res.json();
                    concepts = data.concepts || [];

                    if (concepts.length > 0) {
                        addSystemMessage(' Here are your creative concepts:');
                        renderConceptCards(concepts);
                    } else {
                        addMessage(data.response || 'Concepts generated.', false);
                    }
                }
            } catch (e) {
                removeTypingIndicator();
                console.error('Ideation phase error:', e);
            }
        }

        async function selectConcept(conceptId) {
            if (!PIPELINE_ENABLED) return;

            selectedConceptId = conceptId;
            hideConceptCards();
            addSystemMessage(` Concept ${conceptId} selected!`);

            try {
                const res = await fetch(`${API_URL}/api/legendary/select-concept`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        session_id: sessionId,
                        concept_id: conceptId
                    })
                });

                if (res.ok) {
                    setTimeout(() => runScriptPhase(), 500);
                }
            } catch (e) {
                console.error('Concept selection error:', e);
            }
        }

        async function runScriptPhase() {
            if (!PIPELINE_ENABLED) return;

            updatePhaseIndicator('script');
            addSystemMessage(' Writing your commercial script...');
            addTypingIndicator();

            try {
                const res = await fetch(`${API_URL}/api/legendary/script/${sessionId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });

                removeTypingIndicator();

                if (res.ok) {
                    const data = await res.json();
                    currentScript = data.script;

                    if (currentScript) {
                        renderScriptPreview(currentScript);
                    } else {
                        addMessage(data.response || 'Script generated.', false);
                    }
                }
            } catch (e) {
                removeTypingIndicator();
                console.error('Script phase error:', e);
            }
        }

        async function runReviewPhase() {
            if (!PIPELINE_ENABLED) return;

            updatePhaseIndicator('review');
            addSystemMessage(' Running compliance review...');
            addTypingIndicator();

            try {
                const res = await fetch(`${API_URL}/api/legendary/review/${sessionId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });

                removeTypingIndicator();

                if (res.ok) {
                    const data = await res.json();
                    addMessage(data.response || ' Review complete!', false);

                    if (data.approved) {
                        updatePhaseIndicator('production');
                        addSystemMessage(' Your commercial is ready for production!');
                        showPricingOptions();
                    }
                }
            } catch (e) {
                removeTypingIndicator();
                console.error('Review phase error:', e);
            }
        }

        async function approveScript() {
            if (!currentScript) return;

            document.getElementById('script-preview').classList.add('hidden');
            addSystemMessage(' Script approved! Starting review...');
            await runReviewPhase();
        }

        async function requestRevision() {
            document.getElementById('script-preview').classList.add('hidden');
            addMessage("I'd like to revise the script. What changes would you like?", false);
        }

        function showPricingOptions() {
            const container = document.getElementById('chat-messages');
            const pricingDiv = document.createElement('div');
            pricingDiv.className = 'pricing-options mt-4 p-4 bg-gradient-to-r from-neon/10 to-transparent border border-neon/30 rounded-lg';
            pricingDiv.innerHTML = `
                <div class="text-neon font-mono text-xs mb-3">[ READY FOR PRODUCTION ]</div>
                <div class="p-4 bg-gradient-to-r from-brand-gold/20 to-neon/10 border border-brand-gold/50 rounded-lg">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-white font-semibold text-lg">A2I Commercial Lab</span>
                        <span class="text-brand-gold font-mono text-xl">$499</span>
                    </div>
                    <p class="text-white/60 text-sm mb-4">AI-generated commercial with your approved script</p>
                    <ul class="text-white/50 text-xs space-y-1 mb-4">
                        <li> 30-second broadcast-quality commercial</li>
                        <li> Professional AI voiceover</li>
                        <li> Music & sound design</li>
                        <li> 2 revision rounds</li>
                        <li> Delivered in 48-72 hours</li>
                    </ul>
                    <button onclick="proceedToCheckout()" class="w-full py-3 bg-brand-gold text-black font-bold text-sm uppercase rounded hover:bg-white transition-colors">
                        Proceed to Checkout 
                    </button>
                </div>
                <p class="text-center text-white/40 text-xs mt-3">Secure payment powered by Stripe</p>
            `;
            container.appendChild(pricingDiv);
            container.scrollTop = container.scrollHeight;
        }

        function proceedToCheckout() {
            addSystemMessage(' Redirecting to secure checkout...');

            // Append session_id to payment link for tracking
            const checkoutUrl = sessionId
                ? `${PAYMENT_LINK}?client_reference_id=${sessionId}`
                : PAYMENT_LINK;

            // Small delay so user sees the message
            setTimeout(() => {
                window.location.href = checkoutUrl;
            }, 500);
        }

        // ============= RENDER FUNCTIONS =============

        function renderConceptCards(conceptsArray) {
            const container = document.getElementById('concept-cards');
            container.innerHTML = '';
            container.classList.remove('hidden');

            conceptsArray.forEach((concept, idx) => {
                const card = document.createElement('div');
                card.className = 'concept-card';
                card.onclick = () => selectConcept(concept.id || idx + 1);

                card.innerHTML = `
                    <div class="concept-title">${concept.title || 'Concept ' + (idx + 1)}</div>
                    <div class="concept-description">${concept.description || concept.hook || ''}</div>
                    ${concept.score ? `<div class="concept-score">Score: ${concept.score}/100</div>` : ''}
                `;

                container.appendChild(card);
            });
        }

        function hideConceptCards() {
            document.getElementById('concept-cards').classList.add('hidden');
        }

        function renderScriptPreview(script) {
            const container = document.getElementById('script-preview');
            container.classList.remove('hidden');

            const duration = document.getElementById('script-duration');
            duration.textContent = script.duration || '30s';

            const scenesContainer = document.getElementById('script-scenes');
            scenesContainer.innerHTML = '';

            if (script.scenes) {
                script.scenes.forEach((scene, idx) => {
                    const sceneDiv = document.createElement('div');
                    sceneDiv.className = 'scene';
                    sceneDiv.innerHTML = `
                        <div class="scene-number">Scene ${idx + 1}</div>
                        <div class="scene-visual">${scene.visual || ''}</div>
                        <div class="scene-audio">${scene.voiceover || scene.audio || ''}</div>
                    `;
                    scenesContainer.appendChild(sceneDiv);
                });
            } else if (script.content) {
                scenesContainer.innerHTML = `<div class="scene">${script.content}</div>`;
            }
        }

        function updatePhaseIndicator(phase) {
            const phases = document.querySelectorAll('.phase-dot');
            const phaseIndex = PHASES.indexOf(phase);

            phases.forEach((dot, idx) => {
                dot.classList.remove('active', 'completed');
                if (idx < phaseIndex) {
                    dot.classList.add('completed');
                } else if (idx === phaseIndex) {
                    dot.classList.add('active');
                }
            });
        }

        function addSystemMessage(text) {
            const container = document.getElementById('chat-messages');
            const msgDiv = document.createElement('div');
            msgDiv.className = 'system-message';
            msgDiv.innerHTML = `<span class="system-icon"></span>${text}`;
            container.appendChild(msgDiv);
            container.scrollTop = container.scrollHeight;
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();

            // Check for canceled checkout
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('canceled') === 'true') {
                // Clean up URL
                window.history.replaceState({}, '', window.location.pathname);
                // Show message after chat initializes
                setTimeout(() => {
                    addSystemMessage(' Checkout canceled. Your brief is still saved. Select a plan when ready.');
                }, 2000);
            }

            // Start fresh session for clean state
            initSession();
        });

        // =============================================================================
        // NEXUS BRIDGE INTEGRATION
        // =============================================================================

        let productionClient = null;

        /**
         * Show the Start Production button after brief approval
         * Hook this into your existing brief approval handler
         */
        function showStartProductionButton() {
            const btn = document.getElementById('start-production-btn');
            if (btn) {
                btn.style.display = 'inline-block';
                // Scroll to make button visible
                btn.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        /**
         * Start legendary production pipeline with NEXUS BRIDGE
         */
        async function startLegendaryProduction() {
            // Get session ID from your existing session management
            const sessionId = window.currentSessionId ||
                              localStorage.getItem('creative_session_id') ||
                              sessionStorage.getItem('session_id');

            if (!sessionId) {
                alert('No session found. Please complete the intake process first.');
                return;
            }

            console.log(' Starting legendary production for session:', sessionId);

            // Hide start button
            const btn = document.getElementById('start-production-btn');
            if (btn) btn.style.display = 'none';

            // Show production container
            const container = document.getElementById('production-container');
            if (container) {
                container.style.display = 'block';
                container.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            // Initialize production with the global function from nexus_sse_client.js
            // This function creates the progress bar UI and starts SSE streaming
            if (typeof initLegendaryProduction === 'function') {
                productionClient = initLegendaryProduction(sessionId);
            } else {
                console.error('initLegendaryProduction not available from nexus_sse_client.js');
            }
        }

        /**
         * Cancel production (emergency stop)
         */
        async function cancelProduction() {
            if (productionClient) {
                const confirmed = confirm('Are you sure you want to cancel? Costs incurred cannot be refunded.');
                if (confirmed) {
                    productionClient.cancel('User requested cancellation');
                }
            }
        }

        // =============================================================================
        // FLAWLESS GENESIS ORCHESTRATOR INTEGRATION
        // =============================================================================

        const GENESIS_API_URL = 'https://barrios-genesis-flawless.onrender.com';
        let genesisPipelineId = null;
        let genesisEventSource = null;
        let genesisStatus = 'idle'; // idle, loading, running, complete, error

        // Collected lead data from intake
        let collectedLeadData = {
            businessName: '',
            industry: '',
            goals: [],
            painPoints: [],
            targetAudience: '',
            score: 0
        };

        /**
         * Update lead data from chat responses
         * Call this after successful chat responses to track qualification
         */
        function updateLeadData(responseData) {
            if (responseData.extracted_data) {
                const data = responseData.extracted_data;
                if (data.business_name) collectedLeadData.businessName = data.business_name;
                if (data.industry) collectedLeadData.industry = data.industry;
                if (data.goals) collectedLeadData.goals = data.goals;
                if (data.pain_points) collectedLeadData.painPoints = data.pain_points;
                if (data.target_audience) collectedLeadData.targetAudience = data.target_audience;
            }

            // Calculate qualification score based on collected data
            let score = 0;
            if (collectedLeadData.businessName) score += 0.2;
            if (collectedLeadData.industry) score += 0.2;
            if (collectedLeadData.goals.length > 0) score += 0.2;
            if (collectedLeadData.painPoints.length > 0) score += 0.2;
            if (collectedLeadData.targetAudience) score += 0.2;
            collectedLeadData.score = score;

            // Show Genesis button if score >= 0.8
            updateGenesisButtonVisibility();
        }

        /**
         * Show/hide Genesis strategy button based on qualification
         */
        function updateGenesisButtonVisibility() {
            const container = document.getElementById('genesis-btn-container');
            const scoreDisplay = document.getElementById('genesis-score-display');
            if (!container) return;

            // Update score display
            if (scoreDisplay) {
                scoreDisplay.textContent = Math.round(collectedLeadData.score * 100) + '%';
            }

            if (collectedLeadData.score >= 0.8 && genesisStatus === 'idle') {
                container.classList.remove('hidden');
                container.scrollIntoView({ behavior: 'smooth', block: 'center' });
            } else if (genesisStatus !== 'running') {
                container.classList.add('hidden');
            }
        }

        /**
         * Trigger FLAWLESS GENESIS pipeline
         */
        async function triggerGenesisStrategy() {
            if (genesisStatus === 'loading' || genesisStatus === 'running') return;

            const btn = document.getElementById('genesis-strategy-btn');
            const container = document.getElementById('genesis-container');

            genesisStatus = 'loading';
            if (btn) {
                btn.disabled = true;
                btn.innerHTML = ' Initializing Genesis...';
            }

            try {
                const response = await fetch(`${GENESIS_API_URL}/api/genesis/trigger`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        session_id: sessionId,
                        business_name: collectedLeadData.businessName,
                        industry: collectedLeadData.industry,
                        goals: collectedLeadData.goals,
                        pain_points: collectedLeadData.painPoints,
                        target_audience: collectedLeadData.targetAudience,
                        qualification_score: collectedLeadData.score,
                        generate_video: true
                    })
                });

                if (!response.ok) {
                    throw new Error(`Genesis trigger failed: ${response.status}`);
                }

                const data = await response.json();
                genesisPipelineId = data.pipeline_id;
                genesisStatus = 'running';

                // Hide button container, show progress container
                const btnContainer = document.getElementById('genesis-btn-container');
                if (btnContainer) btnContainer.classList.add('hidden');
                if (container) {
                    container.classList.remove('hidden');
                    container.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }

                // Connect to SSE stream
                connectToGenesisStream(genesisPipelineId);

                addSystemMessage(' FLAWLESS GENESIS initiated! Our AI agents are crafting your strategy...');

            } catch (error) {
                console.error('Genesis trigger error:', error);
                genesisStatus = 'error';
                if (btn) {
                    btn.disabled = false;
                    btn.innerHTML = ' Generate AI Strategy';
                }
                addSystemMessage(' Genesis initialization failed. Please try again.');
            }
        }

        /**
         * Connect to Genesis SSE stream for real-time updates
         */
        function connectToGenesisStream(pipelineId) {
            if (genesisEventSource) {
                genesisEventSource.close();
            }

            const streamUrl = `${GENESIS_API_URL}/api/genesis/stream/${pipelineId}`;
            genesisEventSource = new EventSource(streamUrl);

            genesisEventSource.onmessage = (event) => {
                try {
                    const data = JSON.parse(event.data);
                    handleGenesisEvent(data);
                } catch (e) {
                    console.error('Genesis event parse error:', e);
                }
            };

            genesisEventSource.onerror = (error) => {
                console.error('Genesis SSE error:', error);
                genesisEventSource.close();
                if (genesisStatus === 'running') {
                    addSystemMessage(' Connection lost. Attempting to reconnect...');
                    setTimeout(() => connectToGenesisStream(pipelineId), 2000);
                }
            };
        }

        /**
         * Handle incoming Genesis pipeline events
         */
        function handleGenesisEvent(data) {
            const progressBar = document.getElementById('genesis-progress-bar');
            const phaseText = document.getElementById('genesis-phase-text');
            const statusText = document.getElementById('genesis-status-text');
            const agentPanel = document.getElementById('genesis-agent-panel');

            // Update progress bar
            if (data.progress !== undefined && progressBar) {
                progressBar.style.width = `${data.progress}%`;
            }
            // Update status text
            if (data.status && statusText) {
                statusText.textContent = data.status.toUpperCase();
            }
            // Update phase text
            if (data.stage && phaseText) {
                phaseText.textContent = `Stage: ${data.stage.replace(/_/g, ' ').toUpperCase()} ${data.message ? ' ' + data.message : ''}`;
            } else if (data.message && phaseText) {
                phaseText.textContent = data.message;
            }

            // Render agent card
            if (data.agent && agentPanel) {
                renderGenesisAgentCard(agentPanel, data);
            }

            // Handle completion
            if (data.event === 'pipeline_complete' || data.event === 'complete') {
                genesisStatus = 'complete';
                genesisEventSource.close();
                addSystemMessage(' FLAWLESS GENESIS complete! Your AI strategy is ready.');
                renderGenesisComplete(data.result);
            }

            // Handle errors
            if (data.event === 'pipeline_error' || data.event === 'error') {
                genesisStatus = 'error';
                genesisEventSource.close();
                addSystemMessage(` Genesis error: ${data.error || 'Unknown error'}`);
            }
        }

        /**
         * Render Genesis agent progress card
         */
        function renderGenesisAgentCard(container, data) {
            const agents = {
                trend_scout: { name: 'Trend Scout', icon: '', color: '#00C2FF' },
                market_analyst: { name: 'Market Analyst', icon: '', color: '#A855F7' },
                competitor_tracker: { name: 'Competitor', icon: '', color: '#FF6B6B' },
                strategy_synthesizer: { name: 'Synthesizer', icon: '', color: '#FFD700' },
                ragnarok: { name: 'RAGNAROK', icon: '', color: '#10B981' }
            };

            const agentConfig = agents[data.agent] || { name: data.agent, icon: '', color: '#00CED1' };
            const isComplete = data.status === 'complete' || data.status === 'success';
            const isRunning = data.status === 'running' || data.status === 'processing';

            // Check if card for this agent already exists
            let card = document.getElementById(`genesis-agent-${data.agent}`);
            if (!card) {
                card = document.createElement('div');
                card.id = `genesis-agent-${data.agent}`;
                card.className = 'genesis-agent-card';
                container.appendChild(card);
            }

            card.style.cssText = `
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 4px;
                padding: 8px;
                background: ${isComplete ? 'rgba(16, 185, 129, 0.1)' : isRunning ? `${agentConfig.color}15` : 'rgba(255,255,255,0.03)'};
                border: 1px solid ${isComplete ? 'rgba(16, 185, 129, 0.3)' : isRunning ? `${agentConfig.color}40` : 'rgba(255,255,255,0.1)'};
                border-radius: 8px;
                transition: all 0.3s ease;
            `;
            card.innerHTML = `
                <span style="font-size: 20px; ${isRunning ? 'animation: pulse 1s infinite;' : ''}">${agentConfig.icon}</span>
                <div style="font-size: 9px; font-weight: bold; color: ${isComplete ? '#10B981' : isRunning ? agentConfig.color : 'rgba(255,255,255,0.5)'}; text-transform: uppercase; letter-spacing: 0.3px; text-align: center;">
                    ${agentConfig.name}
                </div>
                <span style="font-size: 12px;">${isComplete ? '' : isRunning ? '' : ''}</span>
            `;
        }

        /**
         * Render Genesis completion summary
         */
        function renderGenesisComplete(result) {
            const container = document.getElementById('genesis-container');
            if (!container || !result) return;

            const summary = document.createElement('div');
            summary.style.cssText = `
                margin-top: 16px;
                padding: 20px;
                background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(0, 206, 209, 0.1));
                border: 1px solid rgba(16, 185, 129, 0.4);
                border-radius: 12px;
                text-align: center;
            `;
            summary.innerHTML = `
                <div style="font-size: 32px; margin-bottom: 12px;">  </div>
                <div style="font-size: 16px; font-weight: bold; color: #10B981; margin-bottom: 8px;">
                    FLAWLESS GENESIS COMPLETE!
                </div>
                <div style="font-size: 12px; color: rgba(255,255,255,0.7);">
                    Your AI-powered strategy and commercial are ready.
                </div>
            `;
            container.appendChild(summary);
        }
    </script>

    <!-- NEXUS Agent Visuals Mount Points -->
    <div id="nexus-explain-strip"></div>

    <!-- NEXUS BRIDGE Production Pipeline Container -->
    <div id="production-container" class="production-pipeline" style="
        display: none;
        margin-top: 24px;
        padding: 24px;
        background: linear-gradient(135deg, rgba(0, 206, 209, 0.05), rgba(139, 0, 139, 0.05));
        border: 1px solid rgba(0, 206, 209, 0.3);
        border-radius: 16px;
    ">
        <!-- Agent Panel will be inserted here by agent-visuals-integration.js -->
        <div id="nexus-agent-panel" style="margin-top: 16px;"></div>
    </div>

    <!-- Start Production Button (shown after brief approval) -->
    <button
        id="start-production-btn"
        onclick="startLegendaryProduction()"
        style="
            display: none;
            background: linear-gradient(135deg, #ffd700, #ff8c00);
            color: #000;
            border: none;
            padding: 16px 32px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 16px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        "
        onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 6px 20px rgba(255, 215, 0, 0.4)';"
        onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 15px rgba(255, 215, 0, 0.3)';"
    >
         START LEGENDARY PRODUCTION
    </button>

    <!-- ==================================================================================
         FLAWLESS GENESIS - STRATEGY RESULTS MODAL
         ================================================================================== -->
    <div id="genesis-results-modal" class="fixed inset-0 z-50 hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="fixed inset-0 bg-void/80 backdrop-blur-md transition-opacity duration-300 opacity-0" id="modal-backdrop"></div>

        <div class="fixed inset-0 z-10 overflow-y-auto">
            <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-2xl bg-[#0a0a1e]/90 border border-white/10 text-left shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-4xl opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95 duration-300" id="modal-panel">

                    <!-- Modal Header -->
                    <div class="relative bg-white/5 px-4 py-6 sm:px-6 border-b border-white/10 backdrop-blur-xl">
                        <div class="absolute top-0 right-0 pt-4 pr-4">
                            <button type="button" onclick="closeStrategyModal()" class="rounded-md bg-transparent text-white/40 hover:text-white focus:outline-none transition-colors">
                                <span class="sr-only">Close</span>
                                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </button>
                        </div>
                        <div class="flex items-center gap-4">
                            <div class="flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-purple-600/20 to-neon/20 border border-white/10 shadow-lg shadow-purple-500/10">
                                <span class="text-2xl animate-pulse"></span>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold leading-6 text-white tracking-tight" id="modal-title">Genesis Strategy Report</h3>
                                <p class="mt-1 text-sm text-white/60">AI-generated growth roadmap for <span id="modal-business-name" class="text-neon font-semibold">Your Business</span></p>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Body -->
                    <div class="px-4 py-6 sm:p-8 space-y-8 bg-gradient-to-b from-[#0a0a1e] to-black max-h-[60vh] overflow-y-auto">

                        <!-- Market Insights Section -->
                        <div class="space-y-4">
                            <h4 class="text-xs font-bold text-neon uppercase tracking-widest flex items-center gap-2">
                                <span></span> Market Insights
                            </h4>
                            <div id="modal-market-insights" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <!-- Populated by JS -->
                            </div>
                        </div>

                        <!-- Competitive Position Section -->
                        <div class="space-y-4">
                            <h4 class="text-xs font-bold text-purple-400 uppercase tracking-widest flex items-center gap-2">
                                <span></span> Competitive Position
                            </h4>
                            <div class="relative pt-2 px-4 py-4 rounded-xl bg-white/5 border border-white/5">
                                <div class="flex mb-2 items-center justify-between">
                                    <span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-purple-200 bg-purple-500/20 border border-purple-500/30">
                                        Market Gap
                                    </span>
                                    <span id="modal-competitor-gap" class="text-xs font-bold inline-block text-purple-300">
                                        Calculating...
                                    </span>
                                </div>
                                <div class="overflow-hidden h-2 mb-3 text-xs flex rounded-full bg-white/10">
                                    <div id="modal-competitor-bar" style="width: 0%" class="shadow-lg shadow-purple-500/50 flex flex-col text-center whitespace-nowrap text-white justify-center bg-gradient-to-r from-purple-600 to-purple-400 transition-all duration-1000 ease-out"></div>
                                </div>
                                <p id="modal-competitor-text" class="text-sm text-white/70 italic leading-relaxed">Analyzing competitor saturation...</p>
                            </div>
                        </div>

                        <!-- Strategic Recommendations Section -->
                        <div class="space-y-4">
                            <h4 class="text-xs font-bold text-amber-400 uppercase tracking-widest flex items-center gap-2">
                                <span></span> Strategic Recommendations
                            </h4>
                            <ul id="modal-recommendations" class="space-y-3">
                                <!-- Populated by JS -->
                            </ul>
                        </div>

                        <!-- Action Items Section -->
                        <div class="space-y-4">
                            <h4 class="text-xs font-bold text-emerald-400 uppercase tracking-widest flex items-center gap-2">
                                <span></span> Next Steps
                            </h4>
                            <div id="modal-action-items" class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                                <!-- Populated by JS -->
                            </div>
                        </div>

                    </div>

                    <!-- Modal Footer CTAs -->
                    <div class="bg-[#050510] px-4 py-5 sm:px-6 sm:flex sm:flex-row-reverse gap-3 border-t border-white/10">
                        <button type="button" onclick="bookStrategyCall()" class="w-full inline-flex justify-center items-center rounded-xl border border-transparent bg-gradient-to-r from-purple-600 to-neon px-4 py-3 text-sm font-bold text-white shadow-lg shadow-purple-500/20 hover:shadow-purple-500/40 hover:from-purple-500 hover:to-neon/90 focus:outline-none sm:ml-3 sm:w-auto transition-all duration-300 transform hover:-translate-y-0.5">
                            <span class="mr-2"></span> Book Strategy Call
                        </button>
                        <button type="button" onclick="downloadStrategyPDF()" class="mt-3 w-full inline-flex justify-center items-center rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-white shadow-sm hover:bg-white/10 hover:border-white/20 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto transition-all duration-200">
                            <span class="mr-2"></span> Download PDF
                        </button>
                        <button type="button" onclick="shareStrategy()" class="mt-3 w-full inline-flex justify-center items-center rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-white shadow-sm hover:bg-white/10 hover:border-white/20 focus:outline-none sm:mt-0 sm:w-auto transition-all duration-200">
                            <span class="mr-2"></span> Share
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================================================================================
        // STRATEGY MODAL LOGIC (FLAWLESS GENESIS)
        // ==================================================================================

        function showStrategyModal(data) {
            const modal = document.getElementById('genesis-results-modal');
            const backdrop = document.getElementById('modal-backdrop');
            const panel = document.getElementById('modal-panel');

            if (!modal || !backdrop || !panel) {
                console.error('Strategy modal elements not found');
                return;
            }

            // Populate Business Name
            if (data && data.lead && data.lead.business_name) {
                document.getElementById('modal-business-name').textContent = data.lead.business_name;
            } else if (typeof collectedLeadData !== 'undefined' && collectedLeadData.businessName) {
                document.getElementById('modal-business-name').textContent = collectedLeadData.businessName;
            }

            // 1. Market Insights
            const insightsContainer = document.getElementById('modal-market-insights');
            insightsContainer.innerHTML = '';
            const insights = (data && data.strategy && data.strategy.market_insights)
                ? data.strategy.market_insights
                : (data && data.result && data.result.market_insights)
                    ? data.result.market_insights
                    : [
                        "Market demand is growing in your sector by 12% YoY based on recent search volume.",
                        "Competitors are currently under-utilizing short-form video marketing channels.",
                        "AI-generated content is showing 3x higher engagement rates in your vertical.",
                        "Mobile-first video consumption has increased 47% in your target demographic."
                    ];
            insights.forEach(text => {
                const div = document.createElement('div');
                div.className = 'p-4 rounded-xl bg-white/5 border border-white/10 hover:border-neon/30 transition-all duration-300 hover:bg-white/10';
                div.innerHTML = '<p class="text-sm text-white/80 leading-relaxed">"' + text + '"</p>';
                insightsContainer.appendChild(div);
            });

            // 2. Competitor Analysis
            const compScore = (data && data.strategy && data.strategy.competitor_score)
                ? data.strategy.competitor_score
                : (data && data.result && data.result.competitor_score)
                    ? data.result.competitor_score
                    : 75;
            setTimeout(() => {
                document.getElementById('modal-competitor-bar').style.width = compScore + '%';
            }, 500);
            document.getElementById('modal-competitor-gap').textContent = (100 - compScore) + '% Opportunity';

            const compText = (data && data.strategy && data.strategy.competitor_analysis)
                ? data.strategy.competitor_analysis
                : (data && data.result && data.result.competitor_analysis)
                    ? data.result.competitor_analysis
                    : 'Your competitors have significant gaps in video content strategy, creating a prime opportunity for market differentiation.';
            document.getElementById('modal-competitor-text').textContent = compText;

            // 3. Strategic Recommendations
            const recList = document.getElementById('modal-recommendations');
            recList.innerHTML = '';
            const recs = (data && data.strategy && data.strategy.recommendations)
                ? data.strategy.recommendations
                : (data && data.result && data.result.recommendations)
                    ? data.result.recommendations
                    : [
                        "Launch a 30s hook-based video on Instagram Reels to target the 25-34 demographic.",
                        "Target lookalike audiences of your top 2 competitors using 'Speed' as the core hook.",
                        "Focus messaging on convenience to differentiate from legacy providers.",
                        "Implement retargeting funnel with sequential video content."
                    ];
            recs.forEach(rec => {
                const li = document.createElement('li');
                li.className = 'flex items-start gap-3 p-3 rounded-lg bg-amber-500/5 border border-amber-500/10 hover:bg-amber-500/10 transition-colors';
                li.innerHTML = '<div class="mt-0.5 min-w-[20px] text-amber-400"></div><span class="text-sm text-white/90">' + rec + '</span>';
                recList.appendChild(li);
            });

            // 4. Action Items
            const actionContainer = document.getElementById('modal-action-items');
            actionContainer.innerHTML = '';
            const actions = (data && data.strategy && data.strategy.action_items)
                ? data.strategy.action_items
                : (data && data.result && data.result.action_items)
                    ? data.result.action_items
                    : ["Approve Script", "Select Voiceover", "Launch Campaign"];
            actions.forEach((action, idx) => {
                const actionText = typeof action === 'string' ? action : action.text;
                const div = document.createElement('div');
                div.className = 'p-4 rounded-lg bg-emerald-500/5 border border-emerald-500/10 text-center hover:bg-emerald-500/10 transition-colors cursor-default';
                div.innerHTML = '<span class="text-[10px] text-emerald-400 font-bold block mb-1 tracking-wider">STEP ' + (idx + 1) + '</span><span class="text-sm text-white font-medium">' + actionText + '</span>';
                actionContainer.appendChild(div);
            });

            // Show Modal with Animation
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';

            // Trigger reflow for animation
            void modal.offsetWidth;

            backdrop.classList.remove('opacity-0');
            backdrop.classList.add('opacity-100');
            panel.classList.remove('opacity-0', 'translate-y-4', 'sm:scale-95');
            panel.classList.add('opacity-100', 'translate-y-0', 'sm:scale-100');
        }

        function closeStrategyModal() {
            const modal = document.getElementById('genesis-results-modal');
            const backdrop = document.getElementById('modal-backdrop');
            const panel = document.getElementById('modal-panel');

            if (!modal || !backdrop || !panel) return;

            // Animate out
            backdrop.classList.remove('opacity-100');
            backdrop.classList.add('opacity-0');
            panel.classList.remove('opacity-100', 'translate-y-0', 'sm:scale-100');
            panel.classList.add('opacity-0', 'translate-y-4', 'sm:scale-95');

            setTimeout(() => {
                modal.classList.add('hidden');
                document.body.style.overflow = '';
            }, 300);
        }

        function downloadStrategyPDF() {
            const btn = event.currentTarget;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span class="mr-2 animate-spin"></span> Generating...';

            setTimeout(() => {
                btn.innerHTML = '<span class="mr-2"></span> Downloaded';
                btn.classList.add('text-emerald-400', 'border-emerald-500/50');

                // Show toast notification
                const toast = document.createElement('div');
                toast.className = 'fixed bottom-4 right-4 bg-emerald-500/20 border border-emerald-500/30 text-emerald-300 px-6 py-3 rounded-xl z-[9999] animate-pulse';
                toast.textContent = ' Strategy PDF will be emailed to you shortly!';
                document.body.appendChild(toast);

                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.remove('text-emerald-400', 'border-emerald-500/50');
                    toast.remove();
                }, 3000);
            }, 1500);
        }

        function shareStrategy() {
            if (navigator.share) {
                navigator.share({
                    title: 'My Genesis Strategy',
                    text: 'Check out this AI-generated video strategy from Barrios A2I!',
                    url: window.location.href
                });
            } else {
                const btn = event.currentTarget;
                const originalText = btn.innerHTML;
                navigator.clipboard.writeText(window.location.href);
                btn.innerHTML = '<span class="mr-2"></span> Copied!';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                }, 2000);
            }
        }

        function bookStrategyCall() {
            window.open('https://calendly.com/gary-barrios/strategy', '_blank');
        }

        // Close modal on backdrop click
        document.addEventListener('click', function(e) {
            if (e.target && e.target.id === 'modal-backdrop') {
                closeStrategyModal();
            }
        });

        // Close modal on Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modal = document.getElementById('genesis-results-modal');
                if (modal && !modal.classList.contains('hidden')) {
                    closeStrategyModal();
                }
            }
        });

        // ==================================================================================
        // PIPELINE HOOK - Override renderGenesisComplete to auto-open modal
        // ==================================================================================
        (function() {
            const _prevRenderComplete = window.renderGenesisComplete;
            window.renderGenesisComplete = function(data) {
                // Call original (shows in-page banner)
                if (_prevRenderComplete) {
                    _prevRenderComplete(data);
                }

                // Auto-open modal after 1.5s delay for smooth UX
                setTimeout(function() {
                    showStrategyModal(data || {});
                }, 1500);
            };
        })();
    </script>

    <!-- ========================================================================
         FLAWLESS GENESIS - ASSET UPLOAD SYSTEM
         All agents collaborate to analyze uploads and create commercials
         ======================================================================== -->
    <div id="file-upload-modal" class="fixed inset-0 z-[60] hidden" role="dialog" aria-modal="true">
        <div class="fixed inset-0 bg-black/80 backdrop-blur-md transition-opacity duration-300 opacity-0" id="upload-modal-backdrop"></div>
        
        <div class="fixed inset-0 z-10 overflow-y-auto">
            <div class="flex min-h-full items-center justify-center p-4">
                <div class="relative w-full max-w-2xl transform overflow-hidden rounded-2xl bg-[#0a0a1e]/95 border border-white/10 shadow-[0_0_50px_rgba(0,206,209,0.1)] transition-all opacity-0 scale-95 duration-300" id="upload-modal-panel">
                    
                    <!-- Modal Header -->
                    <div class="relative px-6 py-4 border-b border-white/10 bg-white/5 flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-neon/20 to-purple-500/20 border border-neon/30 flex items-center justify-center shadow-[0_0_15px_rgba(0,243,255,0.2)]">
                                <span class="text-xl"></span>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-white tracking-tight">Upload Brand Assets</h3>
                                <p class="text-xs text-white/50 font-mono">LOGOS  PRODUCT SHOTS  BRAND GUIDES</p>
                            </div>
                        </div>
                        <button type="button" onclick="closeUploadModal()" class="text-white/40 hover:text-white hover:rotate-90 transition-all duration-300">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                        </button>
                    </div>
                    
                    <!-- Agent Integration Notice -->
                    <div class="px-6 py-3 bg-gradient-to-r from-neon/5 to-purple-500/5 border-b border-white/5">
                        <div class="flex items-center gap-2 text-xs text-white/60">
                            <span class="text-neon"></span>
                            <span>Our <strong class="text-white">7 AI agents</strong> will collaborate to analyze your assets and create a personalized commercial gameplan.</span>
                        </div>
                    </div>
                    
                    <!-- Modal Body -->
                    <div class="p-6">
                        <!-- Drop Zone -->
                        <div id="drop-zone" class="relative border-2 border-dashed border-white/10 rounded-xl p-8 text-center transition-all duration-300 hover:border-neon/50 hover:bg-neon/5 cursor-pointer group" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)" ondrop="handleDrop(event)" onclick="document.getElementById('file-input-hidden').click()">
                            <input type="file" id="file-input-hidden" class="hidden" multiple accept="image/*,.pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.txt,.ai,.psd,.svg" onchange="handleFileSelect(event)">
                            
                            <div class="space-y-4">
                                <div class="w-20 h-20 mx-auto rounded-full bg-gradient-to-br from-neon/5 to-purple-500/5 border border-white/5 flex items-center justify-center group-hover:scale-110 group-hover:border-neon/30 group-hover:shadow-[0_0_30px_rgba(0,243,255,0.15)] transition-all duration-500">
                                    <svg class="w-10 h-10 text-white/30 group-hover:text-neon transition-colors duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-white font-medium">Drop files to attach</p>
                                    <p class="text-xs text-white/40 mt-2"><span class="text-neon">Browse</span> or drag & drop</p>
                                </div>
                                <div class="flex flex-wrap justify-center gap-2 mt-4">
                                    <span class="px-2 py-1 text-[10px] font-mono bg-white/5 rounded text-white/40">PNG</span>
                                    <span class="px-2 py-1 text-[10px] font-mono bg-white/5 rounded text-white/40">JPG</span>
                                    <span class="px-2 py-1 text-[10px] font-mono bg-white/5 rounded text-white/40">PDF</span>
                                    <span class="px-2 py-1 text-[10px] font-mono bg-white/5 rounded text-white/40">SVG</span>
                                    <span class="px-2 py-1 text-[10px] font-mono bg-white/5 rounded text-white/40">AI</span>
                                </div>
                            </div>
                            
                            <!-- Drag Overlay -->
                            <div id="drag-overlay" class="absolute inset-0 bg-[#0a0a1e]/90 border-2 border-neon rounded-xl items-center justify-center z-20 backdrop-blur-sm" style="display: none;">
                                <div class="text-center">
                                    <div class="text-4xl mb-2 animate-bounce"></div>
                                    <span class="text-neon font-bold text-lg tracking-widest">RELEASE TO UPLOAD</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- File Counter -->
                        <div class="flex items-center justify-between mt-6 px-1 border-b border-white/5 pb-2">
                            <span id="file-counter" class="text-[10px] font-mono text-white/40 uppercase tracking-wider">0 / 10 FILES ATTACHED</span>
                            <button onclick="clearAllFiles()" id="clear-all-btn" class="text-[10px] font-mono text-red-400/50 hover:text-red-400 transition-colors hidden uppercase tracking-wider">Clear all</button>
                        </div>
                        
                        <!-- File Preview Grid -->
                        <div id="file-preview-grid" class="mt-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 max-h-[240px] overflow-y-auto custom-scrollbar min-h-[100px]">
                            <div id="empty-state" class="col-span-full flex flex-col items-center justify-center py-8 text-white/10">
                                <span class="text-4xl mb-2 grayscale opacity-20"></span>
                                <span class="text-xs">No files yet</span>
                            </div>
                        </div>
                        
                        <!-- Asset Type Detection -->
                        <div id="asset-hints" class="mt-4 hidden">
                            <div class="text-[10px] font-mono text-white/40 uppercase tracking-wider mb-2">Detected Asset Types:</div>
                            <div id="asset-type-badges" class="flex flex-wrap gap-2"></div>
                        </div>
                    </div>
                    
                    <!-- Modal Footer -->
                    <div class="px-6 py-4 border-t border-white/10 bg-black/40 flex justify-between items-center">
                        <div class="text-[10px] text-white/30 font-mono hidden sm:block">
                            <span class="text-neon"></span> Brand Analyst + <span class="text-purple-400"></span> Visual Strategist will process your assets
                        </div>
                        <div class="flex gap-3">
                            <button onclick="closeUploadModal()" class="px-4 py-2 text-xs font-mono text-white/50 hover:text-white transition-colors uppercase tracking-wider">Cancel</button>
                            <button onclick="confirmUpload()" id="confirm-upload-btn" class="px-6 py-2 bg-gradient-to-r from-neon to-purple-600 rounded-lg text-xs font-bold text-black uppercase tracking-widest hover:shadow-[0_0_20px_rgba(0,243,255,0.4)] hover:scale-105 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:hover:shadow-none" disabled>
                                Attach Files <span id="attach-count" class="hidden ml-1 opacity-70">(0)</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========================================================================
         FILE UPLOAD STYLES
         ======================================================================== -->
    <style>
        .file-preview-card {
            position: relative;
            aspect-ratio: 1;
            border-radius: 12px;
            overflow: hidden;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .file-preview-card:hover {
            border-color: #00F3FF;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.1);
            transform: translateY(-2px);
        }
        .file-preview-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        .file-preview-card:hover img {
            transform: scale(1.1);
        }
        .file-preview-card .file-icon {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .file-preview-card .remove-btn {
            position: absolute;
            top: 6px;
            right: 6px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.2s ease;
            z-index: 10;
        }
        .file-preview-card:hover .remove-btn {
            opacity: 1;
            transform: scale(1);
        }
        .file-preview-card .remove-btn:hover {
            background: #ef4444;
            border-color: #ef4444;
        }
        .file-preview-card .file-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 8px;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }
        .file-preview-card:hover .file-info {
            transform: translateY(0);
        }
        .file-preview-card .asset-badge {
            position: absolute;
            top: 6px;
            left: 6px;
            padding: 2px 6px;
            font-size: 8px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-radius: 4px;
            backdrop-filter: blur(4px);
        }
        .file-preview-card .asset-badge.logo { background: rgba(168, 85, 247, 0.8); color: white; }
        .file-preview-card .asset-badge.product { background: rgba(0, 206, 209, 0.8); color: black; }
        .file-preview-card .asset-badge.brand { background: rgba(245, 158, 11, 0.8); color: black; }
        .file-preview-card .asset-badge.image { background: rgba(16, 185, 129, 0.8); color: white; }
        
        /* Inline Chat Chips */
        #attached-files-bar {
            display: none;
            padding: 12px;
            background: rgba(0, 206, 209, 0.03);
            border: 1px solid rgba(0, 206, 209, 0.15);
            border-radius: 12px;
            margin-bottom: 12px;
            animation: slideDown 0.3s ease-out;
        }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        
        #attached-files-bar.has-files { display: block; }
        
        .attached-file-chip {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 8px 4px 4px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            margin-right: 8px;
            margin-bottom: 8px;
            transition: all 0.2s;
        }
        .attached-file-chip:hover {
            background: rgba(0, 243, 255, 0.1);
            border-color: rgba(0, 243, 255, 0.3);
        }
        .attached-file-chip img {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            object-fit: cover;
        }
        .attached-file-chip .icon-box {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            background: rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        .attached-file-chip .remove-chip {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255,255,255,0.4);
            cursor: pointer;
            margin-left: 4px;
        }
        .attached-file-chip .remove-chip:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(0, 243, 255, 0.2); border-radius: 2px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(0, 243, 255, 0.5); }
        
        /* Upload Button Glow */
        #upload-btn.has-files {
            color: #00F3FF !important;
            border-color: rgba(0, 243, 255, 0.5) !important;
            background: rgba(0, 243, 255, 0.1) !important;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
        }
        
        /* Asset Analysis Animation */
        @keyframes analyzeAsset {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 243, 255, 0.4); }
            50% { transform: scale(1.02); box-shadow: 0 0 20px 5px rgba(0, 243, 255, 0.2); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 243, 255, 0); }
        }
        .file-preview-card.analyzing {
            animation: analyzeAsset 1.5s ease-in-out infinite;
        }
    </style>

    <!-- ========================================================================
         FILE UPLOAD JAVASCRIPT + AGENT PIPELINE INTEGRATION
         ======================================================================== -->
    <script>
        // ==================================================================================
        // FLAWLESS GENESIS - ASSET-AWARE FILE SYSTEM
        // ==================================================================================
        
        window.uploadedFiles = [];
        const MAX_FILES = 10;
        const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB
        
        const FILE_ICONS = { 
            'pdf': '', 'doc': '', 'docx': '', 
            'ppt': '', 'pptx': '', 'xls': '', 'xlsx': '', 
            'txt': '', 'ai': '', 'psd': '', 'svg': '',
            'default': '' 
        };
        
        // Asset type detection patterns
        const ASSET_PATTERNS = {
            logo: /logo|brand.*mark|icon|favicon|emblem|symbol/i,
            product: /product|item|merchandise|goods|hero.*shot|packshot|catalog/i,
            brand: /brand.*guide|style.*guide|guideline|standards|identity|manual/i,
            image: /photo|image|picture|shot|banner|background|lifestyle/i
        };
        
        function detectAssetType(filename) {
            for (const [type, pattern] of Object.entries(ASSET_PATTERNS)) {
                if (pattern.test(filename)) return type;
            }
            // Default based on file type
            const ext = filename.split('.').pop().toLowerCase();
            if (['pdf', 'doc', 'docx', 'ppt', 'pptx'].includes(ext)) return 'brand';
            return 'image';
        }
        
        function openUploadModal() {
            const modal = document.getElementById('file-upload-modal');
            const backdrop = document.getElementById('upload-modal-backdrop');
            const panel = document.getElementById('upload-modal-panel');
            if (!modal) return;
            modal.classList.remove('hidden');
            void modal.offsetWidth;
            backdrop.classList.remove('opacity-0'); backdrop.classList.add('opacity-100');
            panel.classList.remove('opacity-0', 'scale-95'); panel.classList.add('opacity-100', 'scale-100');
            renderFilePreviewGrid();
        }
        
        function closeUploadModal() {
            const modal = document.getElementById('file-upload-modal');
            const backdrop = document.getElementById('upload-modal-backdrop');
            const panel = document.getElementById('upload-modal-panel');
            if (!modal) return;
            backdrop.classList.remove('opacity-100'); backdrop.classList.add('opacity-0');
            panel.classList.remove('opacity-100', 'scale-100'); panel.classList.add('opacity-0', 'scale-95');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }
        
        function handleFileSelect(e) {
            processFiles(Array.from(e.target.files));
            e.target.value = '';
        }
        
        function handleDrop(e) {
            e.preventDefault(); e.stopPropagation();
            document.getElementById('drop-zone').classList.remove('border-neon', 'bg-neon/10');
            document.getElementById('drag-overlay').style.display = 'none';
            processFiles(Array.from(e.dataTransfer.files));
        }

        function handleDragOver(e) {
            e.preventDefault(); e.stopPropagation();
            document.getElementById('drop-zone').classList.add('border-neon', 'bg-neon/10');
            document.getElementById('drag-overlay').style.display = 'flex';
        }

        function handleDragLeave(e) {
            e.preventDefault(); e.stopPropagation();
            document.getElementById('drop-zone').classList.remove('border-neon', 'bg-neon/10');
            document.getElementById('drag-overlay').style.display = 'none';
        }
        
        function processFiles(files) {
            const remaining = MAX_FILES - window.uploadedFiles.length;
            if (remaining <= 0) {
                showUploadToast('Max 10 files allowed', 'warning');
                return;
            }
            
            let addedCount = 0;
            files.slice(0, remaining).forEach(file => {
                if (file.size > MAX_FILE_SIZE) {
                    showUploadToast(file.name + ' is too large (Max 10MB)', 'error');
                    return;
                }
                
                const isImage = file.type.startsWith('image/');
                const extension = file.name.split('.').pop().toLowerCase();
                const assetType = detectAssetType(file.name);
                
                window.uploadedFiles.push({
                    id: Date.now() + '-' + Math.random().toString(36).substr(2, 9),
                    file: file,
                    name: file.name,
                    size: file.size,
                    type: file.type,
                    isImage: isImage,
                    preview: isImage ? URL.createObjectURL(file) : null,
                    extension: extension,
                    assetType: assetType,
                    lastModified: file.lastModified
                });
                addedCount++;
            });
            
            if (addedCount > 0) {
                showUploadToast(addedCount + ' file(s) added', 'success');
            }
            
            renderFilePreviewGrid();
            updateAttachedFilesBar();
            updateAssetHints();
        }
        
        function showUploadToast(message, type) {
            const toast = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-emerald-500/20 border-emerald-500/30 text-emerald-300' :
                           type === 'error' ? 'bg-red-500/20 border-red-500/30 text-red-300' :
                           'bg-amber-500/20 border-amber-500/30 text-amber-300';
            toast.className = 'fixed bottom-4 right-4 ' + bgColor + ' border px-6 py-3 rounded-xl z-[9999] font-mono text-sm shadow-lg';
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => { toast.style.opacity = '0'; setTimeout(() => toast.remove(), 300); }, 3000);
        }
        
        function renderFilePreviewGrid() {
            const grid = document.getElementById('file-preview-grid');
            const empty = document.getElementById('empty-state');
            
            if (window.uploadedFiles.length === 0) {
                empty.classList.remove('hidden');
                grid.innerHTML = '';
                grid.appendChild(empty);
            } else {
                empty.classList.add('hidden');
                Array.from(grid.children).forEach(c => c.id !== 'empty-state' && c.remove());
                
                window.uploadedFiles.forEach(f => {
                    const div = document.createElement('div');
                    div.className = 'file-preview-card';
                    
                    const assetBadgeClass = 'asset-badge ' + f.assetType;
                    const assetBadgeText = f.assetType.charAt(0).toUpperCase() + f.assetType.slice(1);
                    
                    div.innerHTML = 
                        (f.isImage ? '<img src="' + f.preview + '" alt="' + f.name + '">' : '<div class="file-icon"><span class="text-3xl">' + (FILE_ICONS[f.extension] || FILE_ICONS.default) + '</span></div>') +
                        '<span class="' + assetBadgeClass + '">' + assetBadgeText + '</span>' +
                        '<button class="remove-btn" onclick="removeFile(\'' + f.id + '\')"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>' +
                        '<div class="file-info"><div class="text-[10px] text-white truncate font-mono">' + f.name + '</div></div>';
                    
                    grid.appendChild(div);
                });
            }
            
            const count = window.uploadedFiles.length;
            document.getElementById('file-counter').textContent = count + ' / 10 FILES ATTACHED';
            document.getElementById('attach-count').textContent = '(' + count + ')';
            document.getElementById('attach-count').classList.toggle('hidden', count === 0);
            document.getElementById('clear-all-btn').classList.toggle('hidden', count === 0);
            document.getElementById('confirm-upload-btn').disabled = count === 0;
        }
        
        function updateAssetHints() {
            const hints = document.getElementById('asset-hints');
            const badges = document.getElementById('asset-type-badges');
            
            if (window.uploadedFiles.length === 0) {
                hints.classList.add('hidden');
                return;
            }
            
            hints.classList.remove('hidden');
            
            const typeCounts = {};
            window.uploadedFiles.forEach(f => {
                typeCounts[f.assetType] = (typeCounts[f.assetType] || 0) + 1;
            });
            
            const colors = {
                logo: 'bg-purple-500/20 text-purple-300 border-purple-500/30',
                product: 'bg-neon/20 text-neon border-neon/30',
                brand: 'bg-amber-500/20 text-amber-300 border-amber-500/30',
                image: 'bg-emerald-500/20 text-emerald-300 border-emerald-500/30'
            };
            
            badges.innerHTML = Object.entries(typeCounts).map(function(entry) {
                const type = entry[0];
                const count = entry[1];
                return '<span class="px-2 py-1 text-[10px] font-mono border rounded ' + colors[type] + '">' + count + ' ' + type + (count > 1 ? 's' : '') + '</span>';
            }).join('');
        }
        
        function removeFile(id) {
            const file = window.uploadedFiles.find(f => f.id === id);
            if (file && file.preview) {
                URL.revokeObjectURL(file.preview);
            }
            window.uploadedFiles = window.uploadedFiles.filter(f => f.id !== id);
            renderFilePreviewGrid();
            updateAttachedFilesBar();
            updateAssetHints();
        }
        
        function clearAllFiles() {
            window.uploadedFiles.forEach(f => f.preview && URL.revokeObjectURL(f.preview));
            window.uploadedFiles = [];
            renderFilePreviewGrid();
            updateAttachedFilesBar();
            updateAssetHints();
        }
        
        function confirmUpload() {
            closeUploadModal();
            updateAttachedFilesBar();
            
            if (window.uploadedFiles.length > 0) {
                const logos = window.uploadedFiles.filter(f => f.assetType === 'logo').length;
                const products = window.uploadedFiles.filter(f => f.assetType === 'product').length;
                const brands = window.uploadedFiles.filter(f => f.assetType === 'brand').length;
                
                let summary = window.uploadedFiles.length + ' asset(s) attached';
                const parts = [];
                if (logos > 0) parts.push(logos + ' logo(s)');
                if (products > 0) parts.push(products + ' product shot(s)');
                if (brands > 0) parts.push(brands + ' brand doc(s)');
                if (parts.length > 0) summary += ' - ' + parts.join(', ');
                
                showUploadToast(summary, 'success');
            }
        }
        
        function updateAttachedFilesBar() {
            const bar = document.getElementById('attached-files-bar');
            const btn = document.getElementById('upload-btn');
            
            if (!bar) return;
            
            if (window.uploadedFiles.length > 0) {
                bar.classList.add('has-files');
                if (btn) btn.classList.add('has-files');
                
                bar.innerHTML = 
                    '<div class="flex items-center justify-between mb-2">' +
                        '<span class="text-[10px] font-mono text-neon tracking-widest uppercase"> Brand Assets (' + window.uploadedFiles.length + ') - Ready for Agent Analysis</span>' +
                        '<button onclick="openUploadModal()" class="text-[10px] text-white/50 hover:text-white transition-colors uppercase tracking-wider">+ Manage</button>' +
                    '</div>' +
                    '<div class="flex flex-wrap">' +
                        window.uploadedFiles.map(function(f) {
                            return '<div class="attached-file-chip">' +
                                (f.isImage ? '<img src="' + f.preview + '" alt="' + f.name + '">' : '<div class="icon-box">' + (FILE_ICONS[f.extension] || FILE_ICONS.default) + '</div>') +
                                '<span class="text-[10px] text-white/80 font-mono truncate max-w-[100px]">' + f.name + '</span>' +
                                '<div class="remove-chip" onclick="removeFile(\'' + f.id + '\')"></div>' +
                            '</div>';
                        }).join('') +
                    '</div>';
            } else {
                bar.classList.remove('has-files');
                bar.innerHTML = '';
                if (btn) btn.classList.remove('has-files');
            }
        }

        // ==================================================================================
        // GENESIS PIPELINE INTEGRATION - ALL AGENTS COLLABORATE ON ASSETS
        // ==================================================================================
        (function() {
            // 1. Extend collectedLeadData to include assets
            if (typeof collectedLeadData !== 'undefined') {
                collectedLeadData.uploadedAssets = [];
            }
            
            // 2. Hook into triggerGenesisStrategy to include assets in API payload
            const _originalTrigger = window.triggerGenesisStrategy;
            if (_originalTrigger) {
                window.triggerGenesisStrategy = async function() {
                    console.log(' GENESIS: Preparing assets for collaborative agent analysis...');
                    
                    // Prepare asset metadata for ALL agents
                    if (typeof collectedLeadData !== 'undefined') {
                        collectedLeadData.uploadedAssets = window.uploadedFiles.map(f => ({
                            id: f.id,
                            name: f.name,
                            type: f.type,
                            size: f.size,
                            extension: f.extension,
                            assetType: f.assetType,
                            isImage: f.isImage,
                            lastModified: f.lastModified,
                            // Base64 preview for Brand Analyst vision analysis
                            preview: f.preview
                        }));
                        
                        // Log asset summary for debugging
                        const logos = window.uploadedFiles.filter(f => f.assetType === 'logo');
                        const products = window.uploadedFiles.filter(f => f.assetType === 'product');
                        const brands = window.uploadedFiles.filter(f => f.assetType === 'brand');
                        const images = window.uploadedFiles.filter(f => f.assetType === 'image');
                        
                        console.log(' ASSET SUMMARY FOR AGENT COLLABORATION:');
                        console.log('    Brand Analyst will process:', logos.length, 'logos,', brands.length, 'brand docs');
                        console.log('    Visual Strategist will plan:', products.length, 'product shots,', images.length, 'images');
                        console.log('    Trend Scout +  Market +  Competitor will use brand context');
                        console.log('    Synthesizer will create commercial gameplan');
                    }
                    
                    // Call original trigger with enhanced payload
                    return _originalTrigger.apply(this, arguments);
                };
            }
            
            // 3. Enhance strategy modal with asset analysis results
            const _originalShowModal = window.showStrategyModal;
            if (_originalShowModal) {
                window.showStrategyModal = function(data) {
                    // Add asset analysis section to modal data
                    if (window.uploadedFiles.length > 0 && data) {
                        data.assetsAnalyzed = {
                            total: window.uploadedFiles.length,
                            logos: window.uploadedFiles.filter(f => f.assetType === 'logo').length,
                            products: window.uploadedFiles.filter(f => f.assetType === 'product').length,
                            brandDocs: window.uploadedFiles.filter(f => f.assetType === 'brand').length,
                            images: window.uploadedFiles.filter(f => f.assetType === 'image').length
                        };
                        
                        // Add visual plan context if available
                        if (data.strategy && data.strategy.visual_plan) {
                            data.scenesPlanned = data.strategy.visual_plan.scenes ? data.strategy.visual_plan.scenes.length : 0;
                            data.assetsUsedInScenes = Object.keys(data.strategy.visual_plan.asset_usage_map || {}).length;
                        }
                    }
                    return _originalShowModal.apply(this, arguments);
                };
            }
            
            // 4. Add asset context to SSE progress messages
            const _originalRenderAgent = window.renderAgentProgress;
            if (_originalRenderAgent) {
                window.renderAgentProgress = function(agentName, message, progress) {
                    // Enhance messages with asset context
                    if (window.uploadedFiles.length > 0) {
                        if (agentName.includes('Brand')) {
                            const logos = window.uploadedFiles.filter(f => f.assetType === 'logo').length;
                            if (logos > 0 && message.includes('complete')) {
                                message = message.replace('complete', 'complete - extracted brand DNA from ' + logos + ' logo(s)');
                            }
                        }
                        if (agentName.includes('Visual')) {
                            const assets = window.uploadedFiles.length;
                            if (message.includes('planning')) {
                                message = message + ' using ' + assets + ' uploaded assets';
                            }
                        }
                    }
                    return _originalRenderAgent.apply(this, arguments);
                };
            }
        })();
        
        // Close modal on Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modal = document.getElementById('file-upload-modal');
                if (modal && !modal.classList.contains('hidden')) {
                    closeUploadModal();
                }
            }
        });
        
        // Close on backdrop click
        document.addEventListener('click', function(e) {
            if (e.target && e.target.id === 'upload-modal-backdrop') {
                closeUploadModal();
            }
        });
    </script>

    <!-- Legendary Reasoning Engine v3.0 - Now integrated in Neural Interface widget -->
    <script src="js/genesis-legendary-v3.js"></script>

    <!-- ========================================================================
         A2I COMMERCIAL LAB - INTERACTIVITY SCRIPT
         Billing toggle, Token explainer, FAQ accordion, Smooth scroll
         ======================================================================== -->
    <script>
        // ==================================================================================
        // PRICING SECTION - Monthly/Yearly Toggle
        // ==================================================================================
        const pricingData = {
            starter: { monthly: 449, yearly: 374 },
            creator: { monthly: 899, yearly: 749 },
            growth: { monthly: 1699, yearly: 1416 },
            scale: { monthly: 3199, yearly: 2666 }
        };

        let isYearlyBilling = false;

        function toggleBilling(yearly) {
            isYearlyBilling = yearly;

            // Update toggle button styles
            const monthlyBtn = document.getElementById('billing-monthly');
            const yearlyBtn = document.getElementById('billing-yearly');

            if (yearly) {
                monthlyBtn.classList.remove('bg-neon/20', 'border-neon/50');
                monthlyBtn.classList.add('text-white/50');
                yearlyBtn.classList.add('bg-neon/20', 'border', 'border-neon/50');
                yearlyBtn.classList.remove('text-white/50');
            } else {
                monthlyBtn.classList.add('bg-neon/20', 'border-neon/50');
                monthlyBtn.classList.remove('text-white/50');
                yearlyBtn.classList.remove('bg-neon/20', 'border', 'border-neon/50');
                yearlyBtn.classList.add('text-white/50');
            }

            // Update price displays
            document.querySelectorAll('.price-display').forEach(el => {
                const tier = el.dataset.tier;
                if (tier && pricingData[tier]) {
                    const price = yearly ? pricingData[tier].yearly : pricingData[tier].monthly;
                    el.textContent = '$' + price;
                }
            });

            // Show/hide yearly savings text
            document.querySelectorAll('.yearly-savings').forEach(el => {
                if (yearly) {
                    el.classList.remove('hidden');
                } else {
                    el.classList.add('hidden');
                }
            });
        }

        // ==================================================================================
        // TOKEN EXPLAINER - Step Navigation & Auto-Cycle
        // ==================================================================================
        let currentExplainerStep = 1;
        let explainerInterval = null;

        function showExplainerStep(step) {
            currentExplainerStep = step;

            // Hide all steps
            document.querySelectorAll('.explainer-step').forEach(el => {
                el.classList.add('hidden');
                el.classList.remove('opacity-100');
                el.classList.add('opacity-0');
            });

            // Show selected step
            const activeStep = document.getElementById('explainer-step-' + step);
            if (activeStep) {
                activeStep.classList.remove('hidden');
                // Trigger reflow for animation
                void activeStep.offsetWidth;
                activeStep.classList.remove('opacity-0');
                activeStep.classList.add('opacity-100');
            }

            // Update step button styles
            document.querySelectorAll('.step-btn').forEach((btn, idx) => {
                if (idx + 1 === step) {
                    btn.classList.add('bg-neon/20', 'border-neon/50', 'text-neon');
                    btn.classList.remove('bg-white/5', 'border-white/20', 'text-white/50');
                } else {
                    btn.classList.remove('bg-neon/20', 'border-neon/50', 'text-neon');
                    btn.classList.add('bg-white/5', 'border-white/20', 'text-white/50');
                }
            });

            // Reset auto-cycle timer when user clicks
            if (explainerInterval) {
                clearInterval(explainerInterval);
                startExplainerAutoCycle();
            }
        }

        function startExplainerAutoCycle() {
            explainerInterval = setInterval(() => {
                currentExplainerStep = (currentExplainerStep % 3) + 1;
                showExplainerStep(currentExplainerStep);
            }, 4500);
        }

        // Start auto-cycle when page loads
        document.addEventListener('DOMContentLoaded', () => {
            startExplainerAutoCycle();
        });

        // ==================================================================================
        // FAQ ACCORDION - Expand/Collapse
        // ==================================================================================
        function toggleFaq(index) {
            const answer = document.getElementById('faq-answer-' + index);
            const icon = document.getElementById('faq-icon-' + index);

            if (!answer) return;

            // Toggle answer visibility
            if (answer.classList.contains('hidden')) {
                answer.classList.remove('hidden');
                if (icon) icon.classList.add('rotate-180');
            } else {
                answer.classList.add('hidden');
                if (icon) icon.classList.remove('rotate-180');
            }
        }

        // ==================================================================================
        // SMOOTH SCROLL - Navigate to sections
        // ==================================================================================
        function scrollToSection(id) {
            const el = document.getElementById(id);
            if (el) {
                el.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
    </script>

    <!-- ========================================================================
         CSS ANIMATIONS - VORTEX Spinner & Glow Effects
         ======================================================================== -->
    <style>
        @keyframes spin-slow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 243, 255, 0.3); }
            50% { box-shadow: 0 0 40px rgba(0, 243, 255, 0.6); }
        }

        .animate-spin-slow {
            animation: spin-slow 6s linear infinite;
        }

        .animate-pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite;
        }

        /* FAQ icon rotation transition */
        #faq-icon-1, #faq-icon-2, #faq-icon-3, #faq-icon-4, #faq-icon-5, #faq-icon-6 {
            transition: transform 0.3s ease;
        }

        /* Explainer step fade transitions */
        .explainer-step {
            transition: opacity 0.5s ease;
        }

        /* ============================================
           NEURAL INTERFACE - Floating Chat Widget
           ============================================ */

        :root {
            --ni-bg: rgba(10, 10, 15, 0.95);
            --ni-glass: rgba(255, 255, 255, 0.03);
            --ni-border: rgba(255, 255, 255, 0.08);
            --ni-cyan: #00bfff;
            --ni-gold: #ffd700;
            --ni-emerald: #10b981;
            --ni-text: #e5e5e5;
            --ni-text-muted: #737373;
        }

        /* FAB Button - z-index 10001 to stay above Neural Hive (9999) */
        .ni-fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 64px;
            height: 64px;
            z-index: 10001;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ni-fab-bg {
            position: absolute;
            inset: 0;
            background: var(--ni-bg);
            border-radius: 50%;
            border: 1px solid var(--ni-border);
            backdrop-filter: blur(12px);
            transition: all 0.3s ease;
        }

        .ni-fab:hover .ni-fab-bg {
            border-color: rgba(0, 191, 255, 0.3);
            box-shadow: 0 0 30px rgba(0, 191, 255, 0.15);
        }

        .ni-ring {
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            border: 2px solid transparent;
            border-top-color: var(--ni-cyan);
            border-right-color: rgba(0, 191, 255, 0.3);
            animation: ni-spin 8s linear infinite;
        }

        .ni-fab-icon {
            position: relative;
            z-index: 1;
            width: 28px;
            height: 28px;
            color: var(--ni-cyan);
        }

        .ni-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: var(--ni-gold);
            color: #0a0a0f;
            font-size: 9px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            padding: 2px 6px;
            border-radius: 10px;
            z-index: 2;
            animation: ni-pulse 2s ease-in-out infinite;
        }

        .ni-badge-ping {
            position: absolute;
            top: -4px;
            right: -4px;
            width: 24px;
            height: 16px;
            background: var(--ni-gold);
            border-radius: 10px;
            animation: ni-ping 1.5s cubic-bezier(0, 0, 0.2, 1) infinite;
        }

        /* Chat Window - z-index 10000 to stay above Neural Hive (9998) */
        .ni-window {
            position: fixed;
            bottom: 104px;
            right: 24px;
            width: 380px;
            height: 560px;
            z-index: 10000;
            background: var(--ni-bg);
            border: 1px solid var(--ni-border);
            border-radius: 16px;
            backdrop-filter: blur(24px);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            animation: ni-fade-in 0.3s ease-out;
        }

        .ni-window.hidden {
            display: none;
        }

        .ni-window.closing {
            animation: ni-fade-out 0.2s ease-in forwards;
        }

        /* Scanline overlay */
        .ni-scanline {
            position: absolute;
            inset: 0;
            pointer-events: none;
            background: linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,0.08) 50%),
                        linear-gradient(90deg, rgba(255,0,0,0.01), rgba(0,255,0,0.005), rgba(0,0,255,0.01));
            background-size: 100% 2px, 3px 100%;
            z-index: 100;
            border-radius: 16px;
        }

        /* Header */
        .ni-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            border-bottom: 1px solid var(--ni-border);
            background: linear-gradient(to bottom, rgba(0, 191, 255, 0.05), transparent);
        }

        .ni-header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .ni-header-icon {
            width: 20px;
            height: 20px;
            color: var(--ni-cyan);
        }

        .ni-header-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            font-weight: 500;
            letter-spacing: 0.1em;
            color: var(--ni-cyan);
        }

        .ni-status-dot {
            width: 8px;
            height: 8px;
            background: var(--ni-emerald);
            border-radius: 50%;
            box-shadow: 0 0 8px var(--ni-emerald);
        }

        .ni-close-btn {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            background: transparent;
            border: none;
            color: var(--ni-text-muted);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .ni-close-btn:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--ni-text);
        }

        /* Phase Stepper */
        .ni-phases {
            display: flex;
            padding: 12px 20px;
            gap: 8px;
            border-bottom: 1px solid var(--ni-border);
            overflow-x: auto;
        }

        .ni-phases::-webkit-scrollbar {
            display: none;
        }

        .ni-phase {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 10px;
            font-family: 'JetBrains Mono', monospace;
            color: var(--ni-text-muted);
            white-space: nowrap;
            transition: color 0.3s ease;
        }

        .ni-phase-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--ni-text-muted);
            transition: all 0.3s ease;
        }

        .ni-phase.active {
            color: var(--ni-cyan);
        }

        .ni-phase.active .ni-phase-dot {
            background: var(--ni-cyan);
            box-shadow: 0 0 8px var(--ni-cyan);
        }

        .ni-phase.completed {
            color: var(--ni-emerald);
        }

        .ni-phase.completed .ni-phase-dot {
            background: var(--ni-emerald);
        }

        .ni-phase-connector {
            width: 12px;
            height: 1px;
            background: var(--ni-border);
        }

        /* Messages Container */
        .ni-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .ni-messages::-webkit-scrollbar {
            width: 4px;
        }

        .ni-messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .ni-messages::-webkit-scrollbar-thumb {
            background: rgba(0, 191, 255, 0.3);
            border-radius: 2px;
        }

        /* Message Bubbles */
        .ni-msg {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .ni-msg-label {
            font-size: 9px;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            letter-spacing: 0.1em;
        }

        .ni-msg-content {
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 13px;
            line-height: 1.6;
        }

        .ni-msg-ai .ni-msg-label {
            color: var(--ni-cyan);
        }

        .ni-msg-ai .ni-msg-content {
            background: var(--ni-glass);
            border-left: 2px solid var(--ni-cyan);
            color: var(--ni-text);
        }

        .ni-msg-user .ni-msg-label {
            color: var(--ni-gold);
            text-align: right;
        }

        .ni-msg-user .ni-msg-content {
            background: rgba(255, 215, 0, 0.05);
            border-left: 2px solid var(--ni-gold);
            color: var(--ni-text);
        }

        /* Typing Indicator */
        .ni-typing {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 12px 16px;
            background: var(--ni-glass);
            border-left: 2px solid var(--ni-cyan);
            border-radius: 8px;
        }

        .ni-typing-dot {
            width: 6px;
            height: 6px;
            background: var(--ni-cyan);
            border-radius: 50%;
            animation: ni-bounce 1.4s infinite ease-in-out both;
        }

        .ni-typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .ni-typing-dot:nth-child(2) { animation-delay: -0.16s; }
        .ni-typing-dot:nth-child(3) { animation-delay: 0s; }

        /* Input Bar */
        .ni-input-bar {
            display: flex;
            gap: 12px;
            padding: 16px 20px;
            border-top: 1px solid var(--ni-border);
            background: rgba(0, 0, 0, 0.3);
        }

        .ni-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--ni-border);
            border-radius: 8px;
            padding: 12px 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: var(--ni-text);
            transition: all 0.3s ease;
        }

        .ni-input::placeholder {
            color: var(--ni-text-muted);
        }

        .ni-input:focus {
            outline: none;
            border-color: rgba(0, 191, 255, 0.5);
            box-shadow: 0 0 20px rgba(0, 191, 255, 0.1);
        }

        .ni-send-btn {
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 191, 255, 0.1);
            border: 1px solid rgba(0, 191, 255, 0.3);
            border-radius: 8px;
            color: var(--ni-cyan);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ni-send-btn:hover {
            background: rgba(0, 191, 255, 0.2);
            border-color: var(--ni-cyan);
            box-shadow: 0 0 20px rgba(0, 191, 255, 0.2);
        }

        .ni-send-btn:hover svg {
            transform: rotate(45deg);
        }

        .ni-send-btn svg {
            width: 18px;
            height: 18px;
            transition: transform 0.3s ease;
        }

        /* Keyframes */
        @keyframes ni-spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes ni-pulse {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        @keyframes ni-ping {
            75%, 100% { transform: scale(2); opacity: 0; }
        }

        @keyframes ni-fade-in {
            from { opacity: 0; transform: scale(0.95) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        @keyframes ni-fade-out {
            from { opacity: 1; transform: scale(1) translateY(0); }
            to { opacity: 0; transform: scale(0.95) translateY(10px); }
        }

        @keyframes ni-bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        /* Mobile Responsive */
        @media (max-width: 640px) {
            .ni-fab {
                bottom: 16px;
                right: 16px;
                width: 56px;
                height: 56px;
            }

            .ni-window {
                bottom: 0;
                right: 0;
                left: 0;
                width: 100%;
                height: 90vh;
                border-radius: 16px 16px 0 0;
            }
        }

        @media (min-width: 641px) and (max-width: 1024px) {
            .ni-fab {
                bottom: 20px;
                right: 20px;
            }

            .ni-window {
                width: 360px;
                height: 500px;
                bottom: 96px;
                right: 20px;
            }
        }

        /* ============================================
           REASONING ENGINE (Inside Chat Widget)
           ============================================ */

        /* Engine selector container - sits above input */
        .ni-engine {
            padding: 12px 16px;
            background: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }

        .ni-engine__header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .ni-engine__label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 10px;
            font-family: 'JetBrains Mono', monospace;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        .ni-engine__label-icon {
            width: 14px;
            height: 14px;
            color: #ff6b6b;
        }

        .ni-engine__toggle {
            font-size: 9px;
            color: var(--ni-cyan);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: background 0.2s ease;
            font-family: 'JetBrains Mono', monospace;
        }

        .ni-engine__toggle:hover {
            background: rgba(0, 191, 255, 0.1);
        }

        /* Model cards container */
        .ni-engine__models {
            display: flex;
            flex-direction: column;
            gap: 6px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .ni-engine__models--expanded {
            max-height: 200px;
        }

        /* Individual model card */
        .ni-engine__model {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .ni-engine__model:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .ni-engine__model--selected {
            background: rgba(0, 191, 255, 0.08);
            border-color: rgba(0, 191, 255, 0.3);
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.1);
        }

        .ni-engine__model--locked {
            opacity: 0.5;
            cursor: not-allowed;
            position: relative;
        }

        .ni-engine__model--locked::after {
            content: 'TIER 2+';
            position: absolute;
            right: 12px;
            font-size: 8px;
            color: var(--ni-gold);
            letter-spacing: 0.1em;
            font-family: 'JetBrains Mono', monospace;
            background: rgba(255, 215, 0, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }

        /* Model icon */
        .ni-engine__model-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .ni-engine__model-icon--claude {
            background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
        }

        .ni-engine__model-icon--chatgpt {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .ni-engine__model-icon--gemini {
            background: linear-gradient(135deg, #00d4ff, #0099cc);
        }

        /* Model info */
        .ni-engine__model-info {
            flex: 1;
        }

        .ni-engine__model-name {
            font-size: 12px;
            font-weight: 600;
            color: white;
            margin: 0 0 2px 0;
        }

        .ni-engine__model-desc {
            font-size: 9px;
            color: rgba(255, 255, 255, 0.4);
            margin: 0;
        }

        /* Model price */
        .ni-engine__model-price {
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 0.05em;
            font-family: 'JetBrains Mono', monospace;
        }

        .ni-engine__model-price--low { color: #10b981; }
        .ni-engine__model-price--mid { color: var(--ni-gold); }
        .ni-engine__model-price--high { color: #ff6b6b; }

        /* Selected model display (collapsed state) */
        .ni-engine__selected {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: rgba(0, 191, 255, 0.05);
            border: 1px solid rgba(0, 191, 255, 0.15);
            border-radius: 8px;
        }

        .ni-engine__selected-icon {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .ni-engine__selected-name {
            font-size: 11px;
            font-weight: 600;
            color: white;
            flex: 1;
        }

        .ni-engine__selected-stats {
            display: flex;
            gap: 12px;
        }

        .ni-engine__stat {
            text-align: center;
        }

        .ni-engine__stat-label {
            font-size: 8px;
            color: rgba(255, 255, 255, 0.4);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            display: block;
        }

        .ni-engine__stat-value {
            font-size: 10px;
            font-family: 'JetBrains Mono', monospace;
            color: var(--ni-cyan);
            font-weight: 600;
        }

        /* ============================================
           UPLOAD BUTTON
           ============================================ */

        .ni-upload-btn {
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: rgba(255, 255, 255, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .ni-upload-btn:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .ni-upload-btn input[type="file"] {
            position: absolute;
            inset: 0;
            opacity: 0;
            cursor: pointer;
        }

        .ni-upload-btn svg {
            width: 18px;
            height: 18px;
        }

        /* File preview badge */
        .ni-file-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            width: 16px;
            height: 16px;
            background: var(--ni-cyan);
            border-radius: 50%;
            font-size: 9px;
            font-weight: 700;
            color: #0a0a0f;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .ni-upload-btn.has-file .ni-file-badge {
            display: flex;
        }

        /* ============================================
           CHAT FOOTER STATS
           ============================================ */

        .ni-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 16px;
            background: rgba(0, 0, 0, 0.4);
            border-top: 1px solid rgba(255, 255, 255, 0.03);
        }

        .ni-footer__stats {
            display: flex;
            gap: 16px;
        }

        .ni-footer__stat {
            text-align: center;
        }

        .ni-footer__stat-label {
            font-size: 8px;
            color: rgba(255, 255, 255, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            display: block;
            margin-bottom: 2px;
        }

        .ni-footer__stat-value {
            font-size: 11px;
            font-family: 'JetBrains Mono', monospace;
            color: var(--ni-cyan);
            font-weight: 600;
        }

        .ni-footer__brand {
            font-size: 8px;
            font-family: 'JetBrains Mono', monospace;
            color: rgba(255, 255, 255, 0.2);
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        /* ============================================
           UPGRADE MODAL
           ============================================ */

        .ni-upgrade-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .ni-upgrade-modal.visible {
            display: flex;
        }

        .ni-upgrade-modal__content {
            background: rgba(10, 10, 15, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            max-width: 360px;
            text-align: center;
            position: relative;
        }

        .ni-upgrade-modal__close {
            position: absolute;
            top: 12px;
            right: 12px;
            background: none;
            border: none;
            color: rgba(255,255,255,0.5);
            font-size: 24px;
            cursor: pointer;
        }

        .ni-upgrade-modal__content h3 {
            color: white;
            margin: 0 0 12px;
            font-size: 18px;
        }

        .ni-upgrade-modal__content p {
            color: rgba(255,255,255,0.7);
            font-size: 14px;
            margin-bottom: 16px;
        }

        .ni-upgrade-modal__list {
            text-align: left;
            padding-left: 0;
            margin: 16px 0;
            list-style: none;
        }

        .ni-upgrade-modal__list li {
            color: rgba(255,255,255,0.8);
            font-size: 13px;
            margin-bottom: 8px;
            padding-left: 24px;
            position: relative;
        }

        .ni-upgrade-modal__list li::before {
            content: '';
            position: absolute;
            left: 0;
            color: var(--ni-cyan);
        }

        .ni-upgrade-modal__cta {
            display: inline-block;
            background: var(--ni-cyan);
            color: #0a0a0f;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 700;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .ni-upgrade-modal__cta:hover {
            box-shadow: 0 0 20px var(--ni-cyan);
        }

        /* Mobile responsive for engine */
        @media (max-width: 640px) {
            .ni-engine__selected-stats {
                display: none;
            }

            .ni-footer__brand {
                display: none;
            }
        }

        /* ===========================================
           PRODUCTION STATUS UI - RAGNAROK Pipeline
           =========================================== */

        .production-status {
            display: none;
            background: linear-gradient(135deg, rgba(0, 206, 209, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
            border: 1px solid rgba(0, 206, 209, 0.2);
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
        }

        .production-status.active {
            display: block;
            animation: fadeSlideIn 0.4s ease-out;
        }

        .production-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .production-header h3 {
            font-size: 14px;
            font-weight: 600;
            color: #00CED1;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .production-timer {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: #a1a1aa;
            background: rgba(255, 255, 255, 0.05);
            padding: 4px 10px;
            border-radius: 6px;
        }

        /* 8-Phase Progress Indicators */
        .production-phases {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-bottom: 16px;
            overflow-x: auto;
            padding-bottom: 4px;
        }

        .prod-phase {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            min-width: 60px;
            opacity: 0.4;
            transition: all 0.3s ease;
        }

        .prod-phase.completed {
            opacity: 1;
        }

        .prod-phase.completed .prod-phase-icon {
            background: rgba(0, 206, 209, 0.2);
            border-color: #00CED1;
            color: #00CED1;
        }

        .prod-phase.active {
            opacity: 1;
        }

        .prod-phase.active .prod-phase-icon {
            background: rgba(139, 92, 246, 0.2);
            border-color: #8B5CF6;
            color: #8B5CF6;
            animation: pulse-glow 2s infinite;
        }

        .prod-phase-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .prod-phase-name {
            font-size: 9px;
            font-weight: 500;
            color: #a1a1aa;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .prod-phase-connector {
            flex: 0 0 12px;
            height: 2px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 1px;
        }

        .prod-phase-connector.completed {
            background: linear-gradient(90deg, #00CED1 0%, rgba(0, 206, 209, 0.3) 100%);
        }

        /* Progress Bar */
        .production-progress-container {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .production-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00CED1 0%, #8B5CF6 100%);
            border-radius: 2px;
            transition: width 0.5s ease-out;
            width: 0%;
        }

        /* Status Message */
        .production-message {
            font-size: 12px;
            color: #a1a1aa;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .production-message::before {
            content: '';
            width: 6px;
            height: 6px;
            background: #00CED1;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.8); }
        }

        /* Delivery Modal */
        .delivery-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .delivery-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .delivery-content {
            background: #141414;
            border: 1px solid rgba(0, 206, 209, 0.3);
            border-radius: 16px;
            padding: 32px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .delivery-header {
            text-align: center;
            margin-bottom: 24px;
        }

        .delivery-header h2 {
            font-size: 24px;
            font-weight: 600;
            color: #fafafa;
            margin: 0 0 8px 0;
        }

        .delivery-header p {
            color: #a1a1aa;
            font-size: 14px;
            margin: 0;
        }

        .delivery-preview {
            aspect-ratio: 16/9;
            background: #0a0a0a;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delivery-preview video {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .delivery-formats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .format-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #fafafa;
        }

        .format-btn:hover {
            background: rgba(0, 206, 209, 0.1);
            border-color: rgba(0, 206, 209, 0.3);
        }

        .format-btn.active {
            background: rgba(0, 206, 209, 0.2);
            border-color: #00CED1;
        }

        .format-btn-icon {
            font-size: 24px;
        }

        .format-btn-label {
            font-size: 11px;
            color: #a1a1aa;
        }

        .delivery-actions {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }

        .delivery-btn-primary {
            flex: 1;
            background: linear-gradient(135deg, #00CED1 0%, #8B5CF6 100%);
            border: none;
            border-radius: 8px;
            padding: 14px 24px;
            color: #0a0a0a;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .delivery-btn-primary:hover {
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(0, 206, 209, 0.3);
        }

        .delivery-btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 14px 24px;
            color: #fafafa;
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .delivery-btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .delivery-cost {
            text-align: center;
            font-size: 13px;
            color: #a1a1aa;
        }

        .delivery-cost span {
            color: #00CED1;
            font-weight: 600;
        }

        .delivery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .delivery-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #fafafa;
            font-size: 18px;
            transition: all 0.2s ease;
        }

        .delivery-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .delivery-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 24px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
        }

        .delivery-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .delivery-stat-label {
            font-size: 11px;
            color: #71717a;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .delivery-stat-value {
            font-size: 14px;
            font-weight: 600;
            color: #fafafa;
        }

        .delivery-formats h4 {
            font-size: 13px;
            color: #a1a1aa;
            margin: 0 0 12px 0;
            font-weight: 500;
        }

        .format-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .format-icon {
            font-size: 24px;
        }

        .format-name {
            font-size: 13px;
            font-weight: 600;
            color: #fafafa;
        }

        .format-desc {
            font-size: 10px;
            color: #71717a;
        }

        .delivery-action-btn {
            flex: 1;
            border: none;
            border-radius: 8px;
            padding: 14px 24px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .delivery-action-primary {
            background: linear-gradient(135deg, #00CED1 0%, #8B5CF6 100%);
            color: #0a0a0a;
        }

        .delivery-action-primary:hover {
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(0, 206, 209, 0.3);
        }

        .delivery-action-secondary {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fafafa;
        }

        .delivery-action-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Responsive for delivery modal */
        @media (max-width: 480px) {
            .delivery-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .format-buttons {
                grid-template-columns: 1fr;
            }

            .delivery-actions {
                flex-direction: column;
            }
        }

        /* Mobile responsive for production */
        @media (max-width: 640px) {
            .production-phases {
                gap: 2px;
            }

            .prod-phase {
                min-width: 45px;
            }

            .prod-phase-icon {
                width: 26px;
                height: 26px;
                font-size: 12px;
            }

            .prod-phase-name {
                font-size: 7px;
            }

            .delivery-formats {
                grid-template-columns: 1fr;
            }

            .delivery-actions {
                flex-direction: column;
            }
        }
    </style>

    <!-- ============================================
         NEURAL INTERFACE - Floating Chat Widget
         ============================================ -->

    <!-- FAB Button -->
    <div id="ni-fab" class="ni-fab" data-testid="chat-widget" onclick="event.stopPropagation(); toggleNeuralInterface();">
        <div class="ni-ring"></div>
        <div class="ni-fab-bg"></div>
        <div class="ni-badge-ping"></div>
        <div class="ni-badge">AI</div>
        <svg class="ni-fab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"/>
            <circle cx="8" cy="14" r="1.5"/>
            <circle cx="16" cy="14" r="1.5"/>
        </svg>
    </div>

    <!-- Chat Window -->
    <div id="ni-window" class="ni-window hidden">
        <div class="ni-scanline"></div>

        <!-- Header -->
        <div class="ni-header">
            <div class="ni-header-left">
                <svg class="ni-header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                    <path d="M7 8h10M7 12h6M7 16h8"/>
                </svg>
                <span class="ni-header-title">NEURAL INTERFACE</span>
                <div class="ni-status-dot"></div>
            </div>
            <button class="ni-close-btn" onclick="closeNeuralInterface()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>
        </div>

        <!-- Phase Stepper -->
        <div class="ni-phases">
            <div class="ni-phase active" data-phase="intake">
                <div class="ni-phase-dot"></div>
                <span>INTAKE</span>
            </div>
            <div class="ni-phase-connector"></div>
            <div class="ni-phase" data-phase="research">
                <div class="ni-phase-dot"></div>
                <span>RESEARCH</span>
            </div>
            <div class="ni-phase-connector"></div>
            <div class="ni-phase" data-phase="concepts">
                <div class="ni-phase-dot"></div>
                <span>CONCEPTS</span>
            </div>
            <div class="ni-phase-connector"></div>
            <div class="ni-phase" data-phase="script">
                <div class="ni-phase-dot"></div>
                <span>SCRIPT</span>
            </div>
            <div class="ni-phase-connector"></div>
            <div class="ni-phase" data-phase="review">
                <div class="ni-phase-dot"></div>
                <span>REVIEW</span>
            </div>
        </div>

        <!-- Messages Container -->
        <div id="ni-messages" class="ni-messages">
            <!-- Initial AI Message -->
            <div class="ni-msg ni-msg-ai">
                <div class="ni-msg-label">SYS_OVERRIDE</div>
                <div class="ni-msg-content">
                    Welcome to the A2I Commercial Lab! I'm your AI Creative Director. Whether you need a TikTok ad, Instagram Reel, or YouTube commercial - let's create something amazing together.
                </div>
            </div>
        </div>

        <!-- Production Status (hidden until production starts) -->
        <div id="production-status" class="production-status">
            <div class="production-header">
                <div class="production-header-left">
                    <span class="production-icon"></span>
                    <h3>Commercial_Lab Production</h3>
                </div>
                <div class="production-header-right">
                    <span class="production-timer" id="production-timer">00:00</span>
                    <button class="production-cancel" id="production-cancel" onclick="ProductionManager.cancel()"></button>
                </div>
            </div>

            <div class="production-phases" id="production-phases">
                <div class="prod-phase" data-phase="intake">
                    <div class="prod-phase-icon"></div>
                    <span class="prod-phase-name">INTAKE</span>
                </div>
                <div class="prod-phase-connector"></div>
                <div class="prod-phase" data-phase="intelligence">
                    <div class="prod-phase-icon"></div>
                    <span class="prod-phase-name">INTEL</span>
                </div>
                <div class="prod-phase-connector"></div>
                <div class="prod-phase" data-phase="story">
                    <div class="prod-phase-icon"></div>
                    <span class="prod-phase-name">STORY</span>
                </div>
                <div class="prod-phase-connector"></div>
                <div class="prod-phase" data-phase="prompts">
                    <div class="prod-phase-icon"></div>
                    <span class="prod-phase-name">PROMPTS</span>
                </div>
                <div class="prod-phase-connector"></div>
                <div class="prod-phase" data-phase="video">
                    <div class="prod-phase-icon"></div>
                    <span class="prod-phase-name">VIDEO</span>
                </div>
                <div class="prod-phase-connector"></div>
                <div class="prod-phase" data-phase="voice">
                    <div class="prod-phase-icon"></div>
                    <span class="prod-phase-name">VOICE</span>
                </div>
                <div class="prod-phase-connector"></div>
                <div class="prod-phase" data-phase="assembly">
                    <div class="prod-phase-icon"></div>
                    <span class="prod-phase-name">ASSEMBLY</span>
                </div>
                <div class="prod-phase-connector"></div>
                <div class="prod-phase" data-phase="qa">
                    <div class="prod-phase-icon"></div>
                    <span class="prod-phase-name">QA</span>
                </div>
            </div>

            <div class="production-progress-container">
                <div class="production-progress-bar" id="production-progress"></div>
            </div>

            <div class="production-message" id="production-message">Initializing RAGNAROK pipeline...</div>
        </div>

        <!-- Reasoning Engine Selector -->
        <div class="ni-engine" id="niEngine">
            <div class="ni-engine__header">
                <span class="ni-engine__label">
                    <svg class="ni-engine__label-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    Reasoning Engine
                </span>
                <button class="ni-engine__toggle" onclick="niToggleEngines()">
                    <span id="niEngineToggleText">Change</span>
                </button>
            </div>

            <!-- Selected Model Display (Collapsed) -->
            <div class="ni-engine__selected" id="niSelectedModel">
                <div class="ni-engine__selected-icon ni-engine__model-icon--claude"></div>
                <span class="ni-engine__selected-name" id="niSelectedName">Claude 4.5 Sonnet</span>
                <div class="ni-engine__selected-stats">
                    <div class="ni-engine__stat">
                        <span class="ni-engine__stat-label">Context</span>
                        <span class="ni-engine__stat-value" id="niStatContext">200K</span>
                    </div>
                    <div class="ni-engine__stat">
                        <span class="ni-engine__stat-label">Latency</span>
                        <span class="ni-engine__stat-value" id="niStatLatency">800ms</span>
                    </div>
                    <div class="ni-engine__stat">
                        <span class="ni-engine__stat-label">Cost</span>
                        <span class="ni-engine__stat-value" id="niStatCost">$</span>
                    </div>
                </div>
            </div>

            <!-- Model Selection (Expanded) -->
            <div class="ni-engine__models" id="niEngineModels">
                <!-- Claude 4.5 Sonnet - Available to ALL tiers -->
                <div class="ni-engine__model ni-engine__model--selected" data-model="claude" onclick="niSelectModel('claude')">
                    <div class="ni-engine__model-icon ni-engine__model-icon--claude"></div>
                    <div class="ni-engine__model-info">
                        <p class="ni-engine__model-name">Claude 4.5 Sonnet</p>
                        <p class="ni-engine__model-desc">Agentic workflows & coding</p>
                    </div>
                    <span class="ni-engine__model-price ni-engine__model-price--mid">$</span>
                </div>

                <!-- ChatGPT 5.2 - Tier 2+ only -->
                <div class="ni-engine__model ni-engine__model--locked" data-model="chatgpt" data-tier="2" onclick="niSelectModel('chatgpt')">
                    <div class="ni-engine__model-icon ni-engine__model-icon--chatgpt"></div>
                    <div class="ni-engine__model-info">
                        <p class="ni-engine__model-name">ChatGPT 5.2</p>
                        <p class="ni-engine__model-desc">SOTA knowledge work & logic</p>
                    </div>
                    <span class="ni-engine__model-price ni-engine__model-price--high">$$</span>
                </div>

                <!-- Gemini 3.0 Flash - Tier 2+ only -->
                <div class="ni-engine__model ni-engine__model--locked" data-model="gemini" data-tier="2" onclick="niSelectModel('gemini')">
                    <div class="ni-engine__model-icon ni-engine__model-icon--gemini"></div>
                    <div class="ni-engine__model-info">
                        <p class="ni-engine__model-name">Gemini 3.0 Flash</p>
                        <p class="ni-engine__model-desc">Ultra-low latency & multimodal</p>
                    </div>
                    <span class="ni-engine__model-price ni-engine__model-price--low">$</span>
                </div>
            </div>
        </div>

        <!-- Input Bar -->
        <div class="ni-input-bar">
            <input
                type="text"
                id="ni-input"
                class="ni-input"
                data-testid="chat-input"
                placeholder="Enter command..."
                onkeypress="if(event.key==='Enter')sendNIMessage()"
            >
            <!-- Upload Button -->
            <div class="ni-upload-btn" id="niUploadBtn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/>
                </svg>
                <span class="ni-file-badge" id="niFileBadge">1</span>
                <input type="file" id="niFileInput" onchange="niHandleFile(event)" accept="image/*,.pdf,.doc,.docx,.txt">
            </div>
            <!-- Send Button -->
            <button id="ni-send" class="ni-send-btn" data-testid="send-button" onclick="event.stopPropagation(); sendNIMessage()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                </svg>
            </button>
        </div>

        <!-- Footer Stats -->
        <div class="ni-footer">
            <div class="ni-footer__stats">
                <div class="ni-footer__stat">
                    <span class="ni-footer__stat-label">Context</span>
                    <span class="ni-footer__stat-value" id="niFooterContext">200K</span>
                </div>
                <div class="ni-footer__stat">
                    <span class="ni-footer__stat-label">Latency</span>
                    <span class="ni-footer__stat-value" id="niFooterLatency">800ms</span>
                </div>
                <div class="ni-footer__stat">
                    <span class="ni-footer__stat-label">Cost</span>
                    <span class="ni-footer__stat-value" id="niFooterCost">$</span>
                </div>
            </div>
            <span class="ni-footer__brand">Barrios A2I Neural Engine</span>
        </div>
    </div>

    <!-- Upgrade Modal -->
    <div class="ni-upgrade-modal" id="niUpgradeModal">
        <div class="ni-upgrade-modal__content">
            <button class="ni-upgrade-modal__close" onclick="niCloseUpgrade()"></button>
            <h3> Unlock All Engines</h3>
            <p>Upgrade to <strong>Creator</strong> ($899/mo) or higher to access:</p>
            <ul class="ni-upgrade-modal__list">
                <li>ChatGPT 5.2  SOTA reasoning</li>
                <li>Gemini 3.0 Flash  Ultra-fast multimodal</li>
                <li>Claude 4.5 Sonnet  Agentic workflows</li>
            </ul>
            <a href="#pricing" class="ni-upgrade-modal__cta" onclick="niCloseUpgrade()">View Pricing</a>
        </div>
    </div>

    <!-- Neural Interface JavaScript -->
    <script>
        // Neural Interface State
        let niIsOpen = false;

        // ============================================
        // REASONING ENGINE STATE & DATA
        // ============================================

        const MODELS = {
            claude: {
                name: 'Claude 4.5 Sonnet',
                icon: '',
                iconClass: 'ni-engine__model-icon--claude',
                desc: 'Agentic workflows & coding',
                context: '200K',
                latency: '800ms',
                cost: '$',
                tier: 1
            },
            chatgpt: {
                name: 'ChatGPT 5.2',
                icon: '',
                iconClass: 'ni-engine__model-icon--chatgpt',
                desc: 'SOTA knowledge work & logic',
                context: '128K',
                latency: '600ms',
                cost: '$$',
                tier: 2
            },
            gemini: {
                name: 'Gemini 3.0 Flash',
                icon: '',
                iconClass: 'ni-engine__model-icon--gemini',
                desc: 'Ultra-low latency & multimodal',
                context: '1M',
                latency: '300ms',
                cost: '$',
                tier: 2
            }
        };

        // User's tier (default to 1 - update based on auth/subscription)
        let userTier = 1;
        let selectedModel = 'claude';
        let engineExpanded = false;
        let uploadedFile = null;

        // Toggle engine selector expansion
        function niToggleEngines() {
            engineExpanded = !engineExpanded;
            const models = document.getElementById('niEngineModels');
            const selected = document.getElementById('niSelectedModel');
            const toggleText = document.getElementById('niEngineToggleText');

            if (engineExpanded) {
                models.classList.add('ni-engine__models--expanded');
                selected.style.display = 'none';
                toggleText.textContent = 'Collapse';
            } else {
                models.classList.remove('ni-engine__models--expanded');
                selected.style.display = 'flex';
                toggleText.textContent = 'Change';
            }
        }

        // Select a model
        function niSelectModel(modelKey) {
            const model = MODELS[modelKey];

            // Check tier access
            if (model.tier > userTier) {
                // Show upgrade modal
                niShowUpgrade();
                return;
            }

            // Update selection
            selectedModel = modelKey;

            // Update UI - remove selected class from all
            document.querySelectorAll('.ni-engine__model').forEach(el => {
                el.classList.remove('ni-engine__model--selected');
            });

            // Add selected class to chosen
            document.querySelector(`[data-model="${modelKey}"]`).classList.add('ni-engine__model--selected');

            // Update selected display
            document.getElementById('niSelectedName').textContent = model.name;
            const iconEl = document.querySelector('.ni-engine__selected-icon');
            iconEl.textContent = model.icon;
            iconEl.className = 'ni-engine__selected-icon ' + model.iconClass;

            // Update stats in header
            document.getElementById('niStatContext').textContent = model.context;
            document.getElementById('niStatLatency').textContent = model.latency;
            document.getElementById('niStatCost').textContent = model.cost;

            // Update footer stats
            document.getElementById('niFooterContext').textContent = model.context;
            document.getElementById('niFooterLatency').textContent = model.latency;
            document.getElementById('niFooterCost').textContent = model.cost;

            // Collapse selector
            if (engineExpanded) {
                niToggleEngines();
            }
        }

        // Show upgrade modal
        function niShowUpgrade() {
            document.getElementById('niUpgradeModal').classList.add('visible');
        }

        // Close upgrade modal
        function niCloseUpgrade() {
            document.getElementById('niUpgradeModal').classList.remove('visible');
        }

        // Handle file upload
        function niHandleFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            uploadedFile = file;

            // Show badge
            const uploadBtn = document.getElementById('niUploadBtn');
            uploadBtn.classList.add('has-file');

            // Add system message about attachment
            const container = document.getElementById('ni-messages');
            const msgDiv = document.createElement('div');
            msgDiv.className = 'ni-msg ni-msg-ai';
            msgDiv.innerHTML = `
                <div class="ni-msg-label" style="color: var(--ni-gold);">SYS_ATTACH</div>
                <div class="ni-msg-content" style="border-left-color: var(--ni-gold); font-size: 12px; color: rgba(255,255,255,0.6);">
                     File attached: ${file.name}
                </div>
            `;
            container.appendChild(msgDiv);
            container.scrollTop = container.scrollHeight;
        }

        // Clear uploaded file after sending
        function clearUploadedFile() {
            uploadedFile = null;
            document.getElementById('niFileInput').value = '';
            document.getElementById('niUploadBtn').classList.remove('has-file');
        }

        // Initialize tier-based locking
        function initTierGating() {
            document.querySelectorAll('.ni-engine__model').forEach(el => {
                const modelKey = el.dataset.model;
                const model = MODELS[modelKey];

                if (model && model.tier > userTier) {
                    el.classList.add('ni-engine__model--locked');
                } else {
                    el.classList.remove('ni-engine__model--locked');
                }
            });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initTierGating);

        // ============================================
        // NEURAL INTERFACE CORE FUNCTIONS
        // ============================================

        // Toggle Neural Interface
        function toggleNeuralInterface() {
            console.log('=== toggleNeuralInterface called ===');
            console.log('niIsOpen before:', niIsOpen);

            const window = document.getElementById('ni-window');
            const fab = document.getElementById('ni-fab');

            if (niIsOpen) {
                console.log('>>> CLOSING (was already open)');
                closeNeuralInterface();
            } else {
                console.log('>>> OPENING');
                window.classList.remove('hidden');
                niIsOpen = true;
                // Focus input when opened
                setTimeout(() => {
                    document.getElementById('ni-input').focus();
                }, 100);
            }

            console.log('niIsOpen after:', niIsOpen);
        }

        // Close Neural Interface
        function closeNeuralInterface() {
            console.log('=== closeNeuralInterface called ===');
            console.trace('Call stack:');

            const window = document.getElementById('ni-window');
            niIsOpen = false;  // Set immediately, not after animation
            window.classList.add('closing');

            setTimeout(() => {
                window.classList.add('hidden');
                window.classList.remove('closing');
            }, 200);
        }

        // Send Message from Neural Interface
        function sendNIMessage() {
            const input = document.getElementById('ni-input');
            const message = input.value.trim();

            if (!message && !uploadedFile) return;

            // Include model in message metadata (for backend)
            const messageData = {
                text: message,
                model: selectedModel,
                file: uploadedFile ? uploadedFile.name : null
            };
            console.log('Sending with model:', selectedModel, messageData);

            // Append user message
            if (message) {
                appendNIMessage('user', message);
            }
            input.value = '';

            // Clear file after send
            if (uploadedFile) {
                clearUploadedFile();
            }

            // Show typing indicator
            showNITyping();

            // Check for production triggers - start 23-agent RAGNAROK pipeline
            // Use explicit multi-word phrases to avoid false positives during brief collection
            const productionTriggers = [
                'start production', 'begin production', 'launch production',
                'generate the video', 'generate my video', 'create the video', 'create my video',
                'make the video', 'make my video', 'produce the video', 'produce my video',
                'ready to produce', "let's produce", "let's generate", "let's create it",
                'go ahead and', 'proceed with production'
            ];
            const lowerMessage = message.toLowerCase();
            const isProductionRequest = productionTriggers.some(trigger => lowerMessage.includes(trigger));

            if (isProductionRequest && window.ProductionManager) {
                // Trigger GENESIS 23-agent pipeline via ProductionManager
                hideNITyping();
                appendNIMessage('ai', ' Initializing RAGNAROK 23-Agent Pipeline...');

                // Generate session ID if not exists
                const sessionId = window.creativeDirectorSessionId || generateSessionId();
                window.creativeDirectorSessionId = sessionId;

                // Extract brief from message
                const brief = {
                    description: message,
                    target_audience: 'Marketing directors at mid-size companies',
                    tone: 'professional',
                    duration: 30,
                    platforms: ['youtube', 'tiktok', 'instagram'],
                    session_id: sessionId
                };

                // Close Neural Interface to show production panel
                closeNeuralInterface();

                // Start production pipeline with SSE streaming
                ProductionManager.start(sessionId, brief);
            } else {
                // Regular chat - use existing Claude API
                sendToCreativeDirector(message, selectedModel);
            }
        }

        // Append message to Neural Interface
        function appendNIMessage(role, content) {
            const container = document.getElementById('ni-messages');
            const msgDiv = document.createElement('div');
            msgDiv.className = `ni-msg ni-msg-${role}`;

            const label = role === 'ai' ? 'SYS_OVERRIDE' : 'COMMAND';

            msgDiv.innerHTML = `
                <div class="ni-msg-label">${label}</div>
                <div class="ni-msg-content">${content}</div>
            `;

            container.appendChild(msgDiv);
            container.scrollTop = container.scrollHeight;
        }

        // Show typing indicator
        function showNITyping() {
            const container = document.getElementById('ni-messages');

            // Remove existing typing indicator
            const existingTyping = container.querySelector('.ni-typing');
            if (existingTyping) existingTyping.remove();

            const typingDiv = document.createElement('div');
            typingDiv.className = 'ni-typing';
            typingDiv.id = 'ni-typing-indicator';
            typingDiv.innerHTML = `
                <div class="ni-typing-dot"></div>
                <div class="ni-typing-dot"></div>
                <div class="ni-typing-dot"></div>
            `;

            container.appendChild(typingDiv);
            container.scrollTop = container.scrollHeight;
        }

        // Hide typing indicator
        function hideNITyping() {
            const typing = document.getElementById('ni-typing-indicator');
            if (typing) typing.remove();
        }

        // Update phase in Neural Interface
        function updateNIPhase(phase) {
            const phases = ['intake', 'research', 'concepts', 'script', 'review'];
            const phaseElements = document.querySelectorAll('.ni-phase');
            const currentIndex = phases.indexOf(phase.toLowerCase());

            phaseElements.forEach((el, index) => {
                el.classList.remove('active', 'completed');
                if (index < currentIndex) {
                    el.classList.add('completed');
                } else if (index === currentIndex) {
                    el.classList.add('active');
                }
            });
        }

        // Send to Creative Director backend (bridge to existing functionality)
        async function sendToCreativeDirector(message, model = 'claude') {
            try {
                // Use existing session ID if available
                const sessionId = window.creativeDirectorSessionId || generateSessionId();
                window.creativeDirectorSessionId = sessionId;

                // Get model info for telemetry
                const modelInfo = MODELS[model] || MODELS.claude;

                const response = await fetch('https://barrios-api-gateway.onrender.com/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: message,
                        session_id: sessionId,
                        model: model,
                        model_name: modelInfo.name
                    })
                });

                if (!response.ok) throw new Error('API Error');

                const data = await response.json();
                hideNITyping();

                // Append AI response
                appendNIMessage('ai', data.response || data.message || 'Processing your request...');

                // Update phase if provided
                if (data.phase) {
                    updateNIPhase(data.phase);
                }

            } catch (error) {
                console.error('Creative Director Error:', error);
                hideNITyping();
                appendNIMessage('ai', 'I apologize, but I encountered an error. Please try again.');
            }
        }

        // Generate session ID
        function generateSessionId() {
            return 'cd-' + Math.random().toString(36).substr(2, 9) + '-' + Date.now();
        }

        // Click outside to close - FIXED: robust click-outside detection
        document.addEventListener('click', (e) => {
            if (!niIsOpen) return;

            const niWindow = document.getElementById('ni-window');
            const fab = document.getElementById('ni-fab');

            // Don't close if clicking inside the panel or FAB
            if (!niWindow || !fab) return;
            if (niWindow.contains(e.target)) return;
            if (fab.contains(e.target)) return;

            // Don't close if clicking ANY element that toggles the interface
            // This includes "BEGIN YOUR BRIEF" and other toggle buttons
            if (e.target.closest('[onclick*="toggleNeuralInterface"]')) return;

            // Only close if click is truly outside
            closeNeuralInterface();
        });

        // ESC key to close
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && niIsOpen) {
                closeNeuralInterface();
            }
        });

        // Prevent click propagation inside window - CRITICAL for stability
        (function() {
            const niWindow = document.getElementById('ni-window');
            if (niWindow) {
                niWindow.addEventListener('click', (e) => {
                    e.stopPropagation();
                });
            }
        })();
    </script>

    <!-- VORTEX v2.1 Video Assembly SSE Client -->
    <script src="js/vortex_sse_client.js"></script>

    <!-- NEURAL HIVE v1.0 - 23-Agent Real-Time Monitoring -->
    <script src="js/neural-hive.js"></script>

    <!-- PRODUCTION MANAGER v1.0 - RAGNAROK 8-Phase Pipeline Controller -->
    <script src="js/production-manager.js"></script>

    <!-- COMMERCIAL INTAKE FLOW v1.0 - 40-Question Brief System -->
    <script src="js/commercial-intake.js"></script>

    <!-- Delivery Modal -->
    <div id="delivery-modal" class="delivery-modal">
        <div class="delivery-content">
            <div class="delivery-header">
                <h2> Production Complete!</h2>
                <button class="delivery-close" onclick="ProductionManager.closeDelivery()"></button>
            </div>

            <div class="delivery-preview">
                <video id="delivery-video" controls poster="">
                    <source src="" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>

            <div class="delivery-stats">
                <div class="delivery-stat">
                    <span class="delivery-stat-label">Duration</span>
                    <span class="delivery-stat-value" id="delivery-duration">--</span>
                </div>
                <div class="delivery-stat">
                    <span class="delivery-stat-label">Resolution</span>
                    <span class="delivery-stat-value" id="delivery-resolution">--</span>
                </div>
                <div class="delivery-stat">
                    <span class="delivery-stat-label">Format</span>
                    <span class="delivery-stat-value" id="delivery-format">--</span>
                </div>
                <div class="delivery-stat">
                    <span class="delivery-stat-label">Size</span>
                    <span class="delivery-stat-value" id="delivery-size">--</span>
                </div>
            </div>

            <div class="delivery-formats">
                <h4>Download Formats</h4>
                <div class="format-buttons">
                    <button class="format-btn" data-format="mp4" onclick="ProductionManager.download('mp4')">
                        <span class="format-icon"></span>
                        <span class="format-name">MP4</span>
                        <span class="format-desc">Universal</span>
                    </button>
                    <button class="format-btn" data-format="webm" onclick="ProductionManager.download('webm')">
                        <span class="format-icon"></span>
                        <span class="format-name">WebM</span>
                        <span class="format-desc">Web optimized</span>
                    </button>
                    <button class="format-btn" data-format="gif" onclick="ProductionManager.download('gif')">
                        <span class="format-icon"></span>
                        <span class="format-name">GIF</span>
                        <span class="format-desc">Social preview</span>
                    </button>
                </div>
            </div>

            <div class="delivery-actions">
                <button class="delivery-action-btn delivery-action-primary" onclick="ProductionManager.download('mp4')">
                     Download Commercial
                </button>
                <button class="delivery-action-btn delivery-action-secondary" onclick="ProductionManager.newProduction()">
                     Create Another
                </button>
            </div>
        </div>
    </div>

</body>

